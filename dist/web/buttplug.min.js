!function webpackUniversalModuleDefinition(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["buttplug-commonjs"]=t():e.Buttplug=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function __webpack_require__(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,__webpack_require__),a.l=!0,a.exports}return __webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,r){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=28)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(12);r(36);class ButtplugMessage{constructor(e){this.Id=e}DowngradeMessage(){return new Error("Message version downgrade required, but not defined for this message type.",s.ERROR_MSG,this.Id)}get Type(){return this.constructor.name}getType(){return this.Type}toJSON(){return JSON.stringify(this.toProtocolFormat())}toProtocolFormat(){const e={};return e[this.Type]=a.classToPlain(this),e}}t.ButtplugMessage=ButtplugMessage;class ButtplugDeviceMessage extends ButtplugMessage{constructor(e,t){super(t),this.DeviceIndex=e,this.Id=t}}t.ButtplugDeviceMessage=ButtplugDeviceMessage;class ButtplugSystemMessage extends ButtplugMessage{constructor(e=0){super(e),this.Id=e}}t.ButtplugSystemMessage=ButtplugSystemMessage;t.Ok=class Ok extends ButtplugSystemMessage{constructor(e){super(e),this.Id=e}get SchemaVersion(){return 0}};t.Ping=class Ping extends ButtplugMessage{constructor(e){super(e),this.Id=e}get SchemaVersion(){return 0}};var s,n;t.Test=class Test extends ButtplugMessage{constructor(e,t=1){super(t),this.TestString=e,this.Id=t}get SchemaVersion(){return 0}},(n=s=t.ErrorClass||(t.ErrorClass={}))[n.ERROR_UNKNOWN=0]="ERROR_UNKNOWN",n[n.ERROR_INIT=1]="ERROR_INIT",n[n.ERROR_PING=2]="ERROR_PING",n[n.ERROR_MSG=3]="ERROR_MSG",n[n.ERROR_DEVICE=4]="ERROR_DEVICE";class Error extends ButtplugSystemMessage{constructor(e,t=s.ERROR_UNKNOWN,r=1){super(r),this.ErrorMessage=e,this.ErrorCode=t,this.Id=r}get SchemaVersion(){return 0}}t.Error=Error;class DeviceInfo{constructor(e,t,r){this.DeviceIndex=e,this.DeviceName=t,this.DeviceMessages=r}}t.DeviceInfo=DeviceInfo;class DeviceListVersion0 extends ButtplugSystemMessage{constructor(e,t){super(),this.Devices=e,this.Id=t}get Type(){return"DeviceList"}get SchemaVersion(){return 0}}t.DeviceListVersion0=DeviceListVersion0;t.DeviceInfoWithSpecifications=class DeviceInfoWithSpecifications{constructor(e,t,r){this.DeviceIndex=e,this.DeviceName=t,this.DeviceMessages=r}};class DeviceListVersion1 extends ButtplugSystemMessage{constructor(e,t){super(),this.Devices=e,this.Id=t}get Type(){return"DeviceList"}DowngradeMessage(){const e=[];for(const t of this.Devices)e.push(new DeviceInfo(t.DeviceIndex,t.DeviceName,Object.keys(t.DeviceMessages)));return new DeviceListVersion0(e,this.Id)}get SchemaVersion(){return 1}}t.DeviceListVersion1=DeviceListVersion1,t.DeviceList=DeviceListVersion1;class DeviceAddedVersion0 extends ButtplugSystemMessage{constructor(e,t,r){super(),this.DeviceIndex=e,this.DeviceName=t,this.DeviceMessages=r}get Type(){return"DeviceAdded"}get SchemaVersion(){return 0}}t.DeviceAddedVersion0=DeviceAddedVersion0;class DeviceAddedVersion1 extends ButtplugSystemMessage{constructor(e,t,r){super(),this.DeviceIndex=e,this.DeviceName=t,this.DeviceMessages=r}get Type(){return"DeviceAdded"}get SchemaVersion(){return 1}DowngradeMessage(){return new DeviceAddedVersion0(this.DeviceIndex,this.DeviceName,Object.keys(this.DeviceMessages))}}t.DeviceAddedVersion1=DeviceAddedVersion1,t.DeviceAdded=DeviceAddedVersion1;t.DeviceRemoved=class DeviceRemoved extends ButtplugSystemMessage{constructor(e){super(),this.DeviceIndex=e}get SchemaVersion(){return 0}};t.RequestDeviceList=class RequestDeviceList extends ButtplugMessage{constructor(e=1){super(e),this.Id=e}get SchemaVersion(){return 0}};t.StartScanning=class StartScanning extends ButtplugMessage{constructor(e=1){super(e),this.Id=e}get SchemaVersion(){return 0}};t.StopScanning=class StopScanning extends ButtplugMessage{constructor(e=1){super(e),this.Id=e}get SchemaVersion(){return 0}};t.ScanningFinished=class ScanningFinished extends ButtplugSystemMessage{constructor(){super()}get SchemaVersion(){return 0}};t.RequestLog=class RequestLog extends ButtplugMessage{constructor(e,t=1){super(t),this.LogLevel=e,this.Id=t}get SchemaVersion(){return 0}};t.Log=class Log extends ButtplugSystemMessage{constructor(e,t){super(),this.LogLevel=e,this.LogMessage=t}get SchemaVersion(){return 0}};t.RequestServerInfo=class RequestServerInfo extends ButtplugMessage{constructor(e,t=0,r=1){super(r),this.ClientName=e,this.MessageVersion=t,this.Id=r}get SchemaVersion(){return 1}};t.ServerInfo=class ServerInfo extends ButtplugSystemMessage{constructor(e,t,r,a,s,n,i=1){super(),this.MajorVersion=e,this.MinorVersion=t,this.BuildVersion=r,this.MessageVersion=a,this.MaxPingTime=s,this.ServerName=n,this.Id=i}get SchemaVersion(){return 0}};t.FleshlightLaunchFW12Cmd=class FleshlightLaunchFW12Cmd extends ButtplugDeviceMessage{constructor(e,t,r=-1,a=1){super(r,a),this.Speed=e,this.Position=t,this.DeviceIndex=r,this.Id=a}get SchemaVersion(){return 0}};t.KiirooCmd=class KiirooCmd extends ButtplugDeviceMessage{constructor(e="0",t=-1,r=1){super(t,r),this.Command=e,this.DeviceIndex=t,this.Id=r}SetPosition(e){this.Command=e>=0&&e<=4?String(Math.round(e)):"0"}GetPosition(){const e=Number(this.Command)?Number(this.Command):0;return e<0||e>4?0:Math.round(e)}get SchemaVersion(){return 0}};t.SingleMotorVibrateCmd=class SingleMotorVibrateCmd extends ButtplugDeviceMessage{constructor(e,t=-1,r=1){super(t,r),this.Speed=e,this.DeviceIndex=t,this.Id=r}get SchemaVersion(){return 0}};t.StopDeviceCmd=class StopDeviceCmd extends ButtplugDeviceMessage{constructor(e=-1,t=1){super(e,t),this.DeviceIndex=e,this.Id=t}get SchemaVersion(){return 0}};t.StopAllDevices=class StopAllDevices extends ButtplugMessage{constructor(e=1){super(e),this.Id=e}get SchemaVersion(){return 0}};t.LovenseCmd=class LovenseCmd extends ButtplugDeviceMessage{constructor(e,t=-1,r=1){super(t,r),this.Command=e,this.DeviceIndex=t,this.Id=r}get SchemaVersion(){return 0}};t.VorzeA10CycloneCmd=class VorzeA10CycloneCmd extends ButtplugDeviceMessage{constructor(e,t,r=-1,a=1){super(r,a),this.Speed=e,this.Clockwise=t,this.DeviceIndex=r,this.Id=a}get SchemaVersion(){return 0}};t.SpeedSubcommand=class SpeedSubcommand{constructor(e,t){this.Index=e,this.Speed=t}};t.VibrateCmd=class VibrateCmd extends ButtplugDeviceMessage{constructor(e,t=-1,r=1){super(t,r),this.Speeds=e,this.DeviceIndex=t,this.Id=r}get SchemaVersion(){return 1}};t.RotateSubcommand=class RotateSubcommand{constructor(e,t,r){this.Index=e,this.Speed=t,this.Clockwise=r}};t.RotateCmd=class RotateCmd extends ButtplugDeviceMessage{constructor(e,t=-1,r=1){super(t,r),this.Rotations=e,this.DeviceIndex=t,this.Id=r}get SchemaVersion(){return 1}};t.VectorSubcommand=class VectorSubcommand{constructor(e,t,r){this.Index=e,this.Position=t,this.Duration=r}};t.LinearCmd=class LinearCmd extends ButtplugDeviceMessage{constructor(e,t=-1,r=1){super(t,r),this.Vectors=e,this.DeviceIndex=t,this.Id=r}get SchemaVersion(){return 1}}},function(e,t){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(e){return"function"==typeof e}function isObject(e){return"object"==typeof e&&null!==e}function isUndefined(e){return void 0===e}e.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(e){if(!function isNumber(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},EventEmitter.prototype.emit=function(e){var t,r,a,s,n,i;if(this._events||(this._events={}),"error"===e&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var o=new Error('Uncaught, unspecified "error" event. ('+t+")");throw o.context=t,o}if(isUndefined(r=this._events[e]))return!1;if(isFunction(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(isObject(r))for(s=Array.prototype.slice.call(arguments,1),a=(i=r.slice()).length,n=0;n<a;n++)i[n].apply(this,s);return!0},EventEmitter.prototype.addListener=function(e,t){var r;if(!isFunction(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,isFunction(t.listener)?t.listener:t),this._events[e]?isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,isObject(this._events[e])&&!this._events[e].warned&&(r=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(e,t){if(!isFunction(t))throw TypeError("listener must be a function");var r=!1;function g(){this.removeListener(e,g),r||(r=!0,t.apply(this,arguments))}return g.listener=t,this.on(e,g),this},EventEmitter.prototype.removeListener=function(e,t){var r,a,s,n;if(!isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(r=this._events[e]).length,a=-1,r===t||isFunction(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(isObject(r)){for(n=s;n-- >0;)if(r[n]===t||r[n].listener&&r[n].listener===t){a=n;break}if(a<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(a,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},EventEmitter.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(isFunction(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},EventEmitter.prototype.listeners=function(e){return this._events&&this._events[e]?isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},EventEmitter.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(isFunction(t))return 1;if(t)return t.length}return 0},EventEmitter.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,r){"use strict";function checkDataType(e,t,r){var a=r?" !== ":" === ",s=r?" || ":" && ",n=r?"!":"",i=r?"":"!";switch(e){case"null":return t+a+"null";case"array":return n+"Array.isArray("+t+")";case"object":return"("+n+t+s+"typeof "+t+a+'"object"'+s+i+"Array.isArray("+t+"))";case"integer":return"(typeof "+t+a+'"number"'+s+i+"("+t+" % 1)"+s+t+a+t+")";default:return"typeof "+t+a+'"'+e+'"'}}e.exports={copy:function copy(e,t){t=t||{};for(var r in e)t[r]=e[r];return t},checkDataType:checkDataType,checkDataTypes:function checkDataTypes(e,t){switch(e.length){case 1:return checkDataType(e[0],t,!0);default:var r="",a=toHash(e);a.array&&a.object&&(r=a.null?"(":"(!"+t+" || ",r+="typeof "+t+' !== "object")',delete a.null,delete a.array,delete a.object),a.number&&delete a.integer;for(var s in a)r+=(r?" && ":"")+checkDataType(s,t,!0);return r}},coerceToTypes:function coerceToTypes(e,t){if(Array.isArray(t)){for(var r=[],s=0;s<t.length;s++){var n=t[s];a[n]?r[r.length]=n:"array"===e&&"array"===n&&(r[r.length]=n)}if(r.length)return r}else{if(a[t])return[t];if("array"===e&&"array"===t)return["array"]}},toHash:toHash,getProperty:getProperty,escapeQuotes:escapeQuotes,equal:r(10),ucs2length:r(48),varOccurences:function varOccurences(e,t){t+="[^0-9]";var r=e.match(new RegExp(t,"g"));return r?r.length:0},varReplace:function varReplace(e,t,r){return t+="([^0-9])",r=r.replace(/\$/g,"$$$$"),e.replace(new RegExp(t,"g"),r+"$1")},cleanUpCode:function cleanUpCode(e){return e.replace(i,"").replace(o,"").replace(c,"if (!($1))")},finalCleanUpCode:function finalCleanUpCode(e,t){var r=e.match(u);r&&2==r.length&&(e=t?e.replace(h,"").replace(p,m):e.replace(l,"").replace(d,f));return(r=e.match(v))&&3===r.length?e.replace(g,""):e},schemaHasRules:function schemaHasRules(e,t){if("boolean"==typeof e)return!e;for(var r in e)if(t[r])return!0},schemaHasRulesExcept:function schemaHasRulesExcept(e,t,r){if("boolean"==typeof e)return!e&&"not"!=r;for(var a in e)if(a!=r&&t[a])return!0},toQuotedString:toQuotedString,getPathExpr:function getPathExpr(e,t,r,a){return joinPaths(e,r?"'/' + "+t+(a?"":".replace(/~/g, '~0').replace(/\\//g, '~1')"):a?"'[' + "+t+" + ']'":"'[\\'' + "+t+" + '\\']'")},getPath:function getPath(e,t,r){var a=toQuotedString(r?"/"+escapeJsonPointer(t):getProperty(t));return joinPaths(e,a)},getData:function getData(e,t,r){var a,s,n,i;if(""===e)return"rootData";if("/"==e[0]){if(!y.test(e))throw new Error("Invalid JSON-pointer: "+e);s=e,n="rootData"}else{if(!(i=e.match(_)))throw new Error("Invalid JSON-pointer: "+e);if(a=+i[1],"#"==(s=i[2])){if(a>=t)throw new Error("Cannot access property/index "+a+" levels up, current level is "+t);return r[t-a]}if(a>t)throw new Error("Cannot access data "+a+" levels up, current level is "+t);if(n="data"+(t-a||""),!s)return n}for(var o=n,c=s.split("/"),u=0;u<c.length;u++){var l=c[u];l&&(n+=getProperty(unescapeJsonPointer(l)),o+=" && "+n)}return o},unescapeFragment:function unescapeFragment(e){return unescapeJsonPointer(decodeURIComponent(e))},unescapeJsonPointer:unescapeJsonPointer,escapeFragment:function escapeFragment(e){return encodeURIComponent(escapeJsonPointer(e))},escapeJsonPointer:escapeJsonPointer};var a=toHash(["string","number","integer","boolean","null"]);function toHash(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}var s=/^[a-z$_][a-z$_0-9]*$/i,n=/'|\\/g;function getProperty(e){return"number"==typeof e?"["+e+"]":s.test(e)?"."+e:"['"+escapeQuotes(e)+"']"}function escapeQuotes(e){return e.replace(n,"\\$&").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\f/g,"\\f").replace(/\t/g,"\\t")}var i=/else\s*{\s*}/g,o=/if\s*\([^)]+\)\s*\{\s*\}(?!\s*else)/g,c=/if\s*\(([^)]+)\)\s*\{\s*\}\s*else(?!\s*if)/g;var u=/[^v.]errors/g,l=/var errors = 0;|var vErrors = null;|validate.errors = vErrors;/g,h=/var errors = 0;|var vErrors = null;/g,d="return errors === 0;",f="validate.errors = null; return true;",p=/if \(errors === 0\) return data;\s*else throw new ValidationError\(vErrors\);/,m="return data;",v=/[^A-Za-z_$]rootData[^A-Za-z0-9_$]/g,g=/if \(rootData === undefined\) rootData = data;/;function toQuotedString(e){return"'"+escapeQuotes(e)+"'"}var y=/^\/(?:[^~]|~0|~1)*$/,_=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function joinPaths(e,t){return'""'==e?t:(e+" + "+t).replace(/' \+ '/g,"")}function escapeJsonPointer(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}function unescapeJsonPointer(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1),s=r(0);var n,i;(i=n=t.ButtplugLogLevel||(t.ButtplugLogLevel={}))[i.Off=0]="Off",i[i.Fatal=1]="Fatal",i[i.Error=2]="Error",i[i.Warn=3]="Warn",i[i.Info=4]="Info",i[i.Debug=5]="Debug",i[i.Trace=6]="Trace";class LogMessage{constructor(e,t){const r=new Date,a=r.getHours(),s=r.getMinutes(),n=r.getSeconds();this.timestamp=`${a}:${s}:${n}`,this.logMessage=e,this.logLevel=t}get Message(){return this.logMessage}get LogLevel(){return this.logLevel}get Timestamp(){return this.timestamp}get FormattedMessage(){return`${n[this.logLevel]} : ${this.timestamp} : ${this.logMessage}`}}t.LogMessage=LogMessage;class ButtplugLogger extends a.EventEmitter{constructor(){super(),this.maximumConsoleLogLevel=n.Off,this.maximumEventLogLevel=n.Off}static get Logger(){return void 0===ButtplugLogger.sLogger&&(ButtplugLogger.sLogger=new ButtplugLogger),this.sLogger}get MaximumConsoleLogLevel(){return this.maximumConsoleLogLevel}set MaximumConsoleLogLevel(e){this.maximumConsoleLogLevel=e}get MaximumEventLogLevel(){return this.maximumEventLogLevel}set MaximumEventLogLevel(e){this.maximumEventLogLevel=e}LogAndError(e,t,r){return this.Error(e),new s.Error(e,t,r)}Fatal(e){this.AddLogMessage(e,n.Fatal)}Error(e){this.AddLogMessage(e,n.Error)}Warn(e){this.AddLogMessage(e,n.Warn)}Info(e){this.AddLogMessage(e,n.Info)}Debug(e){this.AddLogMessage(e,n.Debug)}Trace(e){this.AddLogMessage(e,n.Trace)}AddLogMessage(e,t){if(t>this.maximumEventLogLevel&&t>this.maximumConsoleLogLevel)return;const r=new LogMessage(e,t);t<=this.maximumConsoleLogLevel&&console.log(r.FormattedMessage),t<=this.maximumEventLogLevel&&this.emit("log",r)}}ButtplugLogger.sLogger=void 0,t.ButtplugLogger=ButtplugLogger},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BluetoothDeviceInfo=class BluetoothDeviceInfo{constructor(e,t,r,a){this._names=e,this._services=t,this._characteristics=r,this._createFunc=a}get Names(){return this._names}get Services(){return this._services}get Characteristics(){return this._characteristics}get Create(){return this._createFunc}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(26);t.ButtplugBluetoothDevice=class ButtplugBluetoothDevice extends a.ButtplugDevice{constructor(e,t){super(e),this._deviceImpl=t}OnDisconnect(){this.emit("deviceremoved",this)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(12),s=r(39),n=r(0),i=r(79),o=new s;o.addMetaSchema(r(80));const c=o.compile(i);t.CheckMessage=function CheckMessage(e){if(c([e.toProtocolFormat()]))return;const t=c.errors.map(e=>e.message).join("; ");throw new Error(t)},t.FromJSON=function FromJSON(e){const t=JSON.parse(e);if(!c(t)){const e=c.errors.map(e=>e.message).join("; ");return[new n.Error(e,n.ErrorClass.ERROR_MSG,0)]}const r=[];for(const e of Array.from(t)){const t=a.plainToClass(n[Object.getOwnPropertyNames(e)[0]],e[Object.getOwnPropertyNames(e)[0]]);r.push(t)}return r},t.GetSchemaVersion=function GetSchemaVersion(){return parseInt(i.version,10)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(13),s=function(){function ClassTransformer(){}return ClassTransformer.prototype.classToPlain=function(e,t){return new a.TransformOperationExecutor(a.TransformationType.CLASS_TO_PLAIN,t||{}).transform(void 0,e,void 0,void 0,void 0,void 0)},ClassTransformer.prototype.classToPlainFromExist=function(e,t,r){return new a.TransformOperationExecutor(a.TransformationType.CLASS_TO_PLAIN,r||{}).transform(t,e,void 0,void 0,void 0,void 0)},ClassTransformer.prototype.plainToClass=function(e,t,r){return new a.TransformOperationExecutor(a.TransformationType.PLAIN_TO_CLASS,r||{}).transform(void 0,t,e,void 0,void 0,void 0)},ClassTransformer.prototype.plainToClassFromExist=function(e,t,r){return new a.TransformOperationExecutor(a.TransformationType.PLAIN_TO_CLASS,r||{}).transform(e,t,void 0,void 0,void 0,void 0)},ClassTransformer.prototype.classToClass=function(e,t){return new a.TransformOperationExecutor(a.TransformationType.CLASS_TO_CLASS,t||{}).transform(void 0,e,void 0,void 0,void 0,void 0)},ClassTransformer.prototype.classToClassFromExist=function(e,t,r){return new a.TransformOperationExecutor(a.TransformationType.CLASS_TO_CLASS,r||{}).transform(t,e,void 0,void 0,void 0,void 0)},ClassTransformer.prototype.serialize=function(e,t){return JSON.stringify(this.classToPlain(e,t))},ClassTransformer.prototype.deserialize=function(e,t,r){var a=JSON.parse(t);return this.plainToClass(e,a,r)},ClassTransformer.prototype.deserializeArray=function(e,t,r){var a=JSON.parse(t);return this.plainToClass(e,a,r)},ClassTransformer}();t.ClassTransformer=s},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";var a=r(41),s=r(10),n=r(2),i=r(16),o=r(49);function resolve(e,t,r){var a=this._refs[r];if("string"==typeof a){if(!this._refs[a])return resolve.call(this,e,t,a);a=this._refs[a]}if((a=a||this._schemas[r])instanceof i)return inlineRef(a.schema,this._opts.inlineRefs)?a.schema:a.validate||this._compile(a);var s,n,o,c=resolveSchema.call(this,t,r);return c&&(s=c.schema,t=c.root,o=c.baseId),s instanceof i?n=s.validate||e.call(this,s.schema,t,void 0,o):void 0!==s&&(n=inlineRef(s,this._opts.inlineRefs)?s:e.call(this,s,t,void 0,o)),n}function resolveSchema(e,t){var r=a.parse(t,!1,!0),s=_getFullPath(r),n=getFullPath(this._getId(e.schema));if(s!==n){var o=normalizeId(s),c=this._refs[o];if("string"==typeof c)return function resolveRecursive(e,t,r){var a=resolveSchema.call(this,e,t);if(a){var s=a.schema,n=a.baseId;e=a.root;var i=this._getId(s);return i&&(n=resolveUrl(n,i)),getJsonPointer.call(this,r,n,s,e)}}.call(this,e,c,r);if(c instanceof i)c.validate||this._compile(c),e=c;else{if(!((c=this._schemas[o])instanceof i))return;if(c.validate||this._compile(c),o==normalizeId(t))return{schema:c,root:e,baseId:n};e=c}if(!e.schema)return;n=getFullPath(this._getId(e.schema))}return getJsonPointer.call(this,r,n,e.schema,e)}e.exports=resolve,resolve.normalizeId=normalizeId,resolve.fullPath=getFullPath,resolve.url=resolveUrl,resolve.ids=function resolveIds(e){var t=normalizeId(this._getId(e)),r={"":t},i={"":getFullPath(t,!1)},c={},u=this;return o(e,{allKeys:!0},function(e,t,o,l,h,d,f){if(""!==t){var p=u._getId(e),m=r[l],v=i[l]+"/"+h;if(void 0!==f&&(v+="/"+("number"==typeof f?f:n.escapeFragment(f))),"string"==typeof p){p=m=normalizeId(m?a.resolve(m,p):p);var g=u._refs[p];if("string"==typeof g&&(g=u._refs[g]),g&&g.schema){if(!s(e,g.schema))throw new Error('id "'+p+'" resolves to more than one schema')}else if(p!=normalizeId(v))if("#"==p[0]){if(c[p]&&!s(e,c[p]))throw new Error('id "'+p+'" resolves to more than one schema');c[p]=e}else u._refs[p]=v}r[t]=m,i[t]=v}}),c},resolve.inlineRef=inlineRef,resolve.schema=resolveSchema;var c=n.toHash(["properties","patternProperties","enum","dependencies","definitions"]);function getJsonPointer(e,t,r,a){if(e.hash=e.hash||"","#/"==e.hash.slice(0,2)){for(var s=e.hash.split("/"),i=1;i<s.length;i++){var o=s[i];if(o){if(void 0===(r=r[o=n.unescapeFragment(o)]))break;var u;if(!c[o]&&((u=this._getId(r))&&(t=resolveUrl(t,u)),r.$ref)){var l=resolveUrl(t,r.$ref),h=resolveSchema.call(this,a,l);h&&(r=h.schema,a=h.root,t=h.baseId)}}}return void 0!==r&&r!==a.schema?{schema:r,root:a,baseId:t}:void 0}}var u=n.toHash(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum"]);function inlineRef(e,t){return!1!==t&&(void 0===t||!0===t?function checkNoRef(e){var t;if(Array.isArray(e)){for(var r=0;r<e.length;r++)if("object"==typeof(t=e[r])&&!checkNoRef(t))return!1}else for(var a in e){if("$ref"==a)return!1;if("object"==typeof(t=e[a])&&!checkNoRef(t))return!1}return!0}(e):t?function countKeys(e){var t,r=0;if(Array.isArray(e)){for(var a=0;a<e.length;a++)if("object"==typeof(t=e[a])&&(r+=countKeys(t)),r==1/0)return 1/0}else for(var s in e){if("$ref"==s)return 1/0;if(u[s])r++;else if("object"==typeof(t=e[s])&&(r+=countKeys(t)+1),r==1/0)return 1/0}return r}(e)<=t:void 0)}function getFullPath(e,t){return!1!==t&&(e=normalizeId(e)),_getFullPath(a.parse(e,!1,!0))}function _getFullPath(e){var t=e.protocol||"//"==e.href.slice(0,2)?"//":"";return(e.protocol||"")+t+(e.host||"")+(e.path||"")+"#"}var l=/#\/?$/;function normalizeId(e){return e?e.replace(l,""):""}function resolveUrl(e,t){return t=normalizeId(t),a.resolve(e,t)}},function(e,t,r){"use strict";e.exports=function equal(e,t){if(e===t)return!0;var r,a=Array.isArray(e),s=Array.isArray(t);if(a&&s){if(e.length!=t.length)return!1;for(r=0;r<e.length;r++)if(!equal(e[r],t[r]))return!1;return!0}if(a!=s)return!1;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;var i=e instanceof Date,o=t instanceof Date;if(i&&o)return e.getTime()==t.getTime();if(i!=o)return!1;var c=e instanceof RegExp,u=t instanceof RegExp;if(c&&u)return e.toString()==t.toString();if(c!=u)return!1;for(r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r]))return!1;for(r=0;r<n.length;r++)if(!equal(e[n[r]],t[n[r]]))return!1;return!0}return!1}},function(e,t,r){"use strict";var a=r(9);function MissingRefError(e,t,r){this.message=r||MissingRefError.message(e,t),this.missingRef=a.url(e,t),this.missingSchema=a.normalizeId(a.fullPath(this.missingRef))}function errorSubclass(e){return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}e.exports={Validation:errorSubclass(function ValidationError(e){this.message="validation failed",this.errors=e,this.ajv=this.validation=!0}),MissingRef:errorSubclass(MissingRefError)},MissingRefError.message=function(e,t){return"can't resolve reference "+t+" from id "+e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(7),s=r(7);t.ClassTransformer=s.ClassTransformer,function __export(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}(r(31));var n,i=new a.ClassTransformer;t.classToPlain=function classToPlain(e,t){return i.classToPlain(e,t)},t.classToPlainFromExist=function classToPlainFromExist(e,t,r){return i.classToPlainFromExist(e,t,r)},t.plainToClass=function plainToClass(e,t,r){return i.plainToClass(e,t,r)},t.plainToClassFromExist=function plainToClassFromExist(e,t,r){return i.plainToClassFromExist(e,t,r)},t.classToClass=function classToClass(e,t){return i.classToClass(e,t)},t.classToClassFromExist=function classToClassFromExist(e,t,r){return i.classToClassFromExist(e,t,r)},t.serialize=function serialize(e,t){return i.serialize(e,t)},t.deserialize=function deserialize(e,t,r){return i.deserialize(e,t,r)},t.deserializeArray=function deserializeArray(e,t,r){return i.deserializeArray(e,t,r)},(n=t.TransformationType||(t.TransformationType={}))[n.PLAIN_TO_CLASS=0]="PLAIN_TO_CLASS",n[n.CLASS_TO_PLAIN=1]="CLASS_TO_PLAIN",n[n.CLASS_TO_CLASS=2]="CLASS_TO_CLASS"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,s,n=r(14);(s=a=t.TransformationType||(t.TransformationType={}))[s.PLAIN_TO_CLASS=0]="PLAIN_TO_CLASS",s[s.CLASS_TO_PLAIN=1]="CLASS_TO_PLAIN",s[s.CLASS_TO_CLASS=2]="CLASS_TO_CLASS";var i=function(){function TransformOperationExecutor(e,t){this.transformationType=e,this.options=t,this.transformedTypesMap=new Map}return TransformOperationExecutor.prototype.transform=function(e,t,r,s,i,o){var c=this;if(void 0===o&&(o=0),t instanceof Array||t instanceof Set){var u=s&&this.transformationType===a.PLAIN_TO_CLASS?new s:[];return t.forEach(function(t,s){var n=e?e[s]:void 0;if(c.options.enableCircularCheck&&c.isCircular(t,o))c.transformationType===a.CLASS_TO_CLASS&&(u instanceof Set?u.add(t):u.push(t));else{var i=c.transform(n,t,r,void 0,t instanceof Map,o+1);u instanceof Set?u.add(i):u.push(i)}}),u}if(r!==String||i){if(r!==Number||i){if(r!==Boolean||i){if((r===Date||t instanceof Date)&&!i)return t instanceof Date?new Date(t.valueOf()):null===t||void 0===t?t:new Date(t);if(t instanceof Object){r||t.constructor===Object||(r=t.constructor),!r&&e&&(r=e.constructor),this.options.enableCircularCheck&&this.transformedTypesMap.set(t,{level:o,object:t});var l=this.getKeys(r,t),h=e||{};e||this.transformationType!==a.PLAIN_TO_CLASS&&this.transformationType!==a.CLASS_TO_CLASS||(h=i?new Map:r?new r:{});for(var d=function(s){var c=s,u=s,l=s;if(!f.options.ignoreDecorators&&r)if(f.transformationType===a.PLAIN_TO_CLASS)(d=n.defaultMetadataStorage.findExposeMetadataByCustomName(r,s))&&(l=d.propertyName,u=d.propertyName);else if(f.transformationType===a.CLASS_TO_PLAIN||f.transformationType===a.CLASS_TO_CLASS){var d;(d=n.defaultMetadataStorage.findExposeMetadata(r,s))&&d.options&&d.options.name&&(u=d.options.name)}var p=void 0,m=void 0,v=(p=t instanceof Map?t.get(c):t[c]instanceof Function?t[c]():t[c])instanceof Map;if(r&&i)m=r;else if(r){var g=n.defaultMetadataStorage.findTypeMetadata(r,l);if(g){var y={newObject:h,object:t,property:l};m=g.typeFunction(y),v=v||g.reflectedType===Map}else f.options.targetMaps&&f.options.targetMaps.filter(function(e){return e.target===r&&!!e.properties[l]}).forEach(function(e){return m=e.properties[l]})}var _=t[c]instanceof Array?f.getReflectedType(r,l):void 0,P=e?e[c]:void 0;if(h.constructor.prototype){var S=Object.getOwnPropertyDescriptor(h.constructor.prototype,u);if((f.transformationType===a.PLAIN_TO_CLASS||f.transformationType===a.CLASS_TO_CLASS)&&(h[u]instanceof Function||S&&!S.set))return"continue"}if(f.options.enableCircularCheck&&f.isCircular(p,o)){if(f.transformationType===a.CLASS_TO_CLASS){w=p;w=f.applyCustomTransformations(w,r,s,t,f.transformationType),h instanceof Map?h.set(u,w):h[u]=w}}else{var b=f.transformationType===a.PLAIN_TO_CLASS?u:s,w=f.transform(P,p,m,_,v,o+1);w=f.applyCustomTransformations(w,r,b,t,f.transformationType),h instanceof Map?h.set(u,w):h[u]=w}},f=this,p=0,m=l;p<m.length;p++){d(m[p])}return h}return t}return Boolean(t)}return Number(t)}return String(t)},TransformOperationExecutor.prototype.applyCustomTransformations=function(e,t,r,a,s){var i=this,o=n.defaultMetadataStorage.findTransformMetadatas(t,r,this.transformationType);return void 0!==this.options.version&&(o=o.filter(function(e){return!e.options||i.checkVersion(e.options.since,e.options.until)})),(o=this.options.groups&&this.options.groups.length?o.filter(function(e){return!e.options||i.checkGroups(e.options.groups)}):o.filter(function(e){return!e.options||!e.options.groups||!e.options.groups.length})).forEach(function(t){e=t.transformFn(e,a,s)}),e},TransformOperationExecutor.prototype.isCircular=function(e,t){var r=this.transformedTypesMap.get(e);return void 0!==r&&r.level<t},TransformOperationExecutor.prototype.getReflectedType=function(e,t){if(e){var r=n.defaultMetadataStorage.findTypeMetadata(e,t);return r?r.reflectedType:void 0}},TransformOperationExecutor.prototype.getKeys=function(e,t){var r=this,s=n.defaultMetadataStorage.getStrategy(e);"none"===s&&(s=this.options.strategy||"exposeAll");var i=[];if("exposeAll"===s&&(i=t instanceof Map?Array.from(t.keys()):Object.keys(t)),!this.options.ignoreDecorators&&e){var o=n.defaultMetadataStorage.getExposedProperties(e,this.transformationType);this.transformationType===a.PLAIN_TO_CLASS&&(o=o.map(function(t){var r=n.defaultMetadataStorage.findExposeMetadata(e,t);return r&&r.options&&r.options.name?r.options.name:t})),i=i.concat(o);var c=n.defaultMetadataStorage.getExcludedProperties(e,this.transformationType);c.length>0&&(i=i.filter(function(e){return-1===c.indexOf(e)})),void 0!==this.options.version&&(i=i.filter(function(t){var a=n.defaultMetadataStorage.findExposeMetadata(e,t);return!a||!a.options||r.checkVersion(a.options.since,a.options.until)})),i=this.options.groups&&this.options.groups.length?i.filter(function(t){var a=n.defaultMetadataStorage.findExposeMetadata(e,t);return!a||!a.options||r.checkGroups(a.options.groups)}):i.filter(function(t){var r=n.defaultMetadataStorage.findExposeMetadata(e,t);return!(r&&r.options&&r.options.groups&&r.options.groups.length)})}return this.options.excludePrefixes&&this.options.excludePrefixes.length&&(i=i.filter(function(e){return r.options.excludePrefixes.every(function(t){return e.substr(0,t.length)!==t})})),i=i.filter(function(e,t,r){return r.indexOf(e)===t})},TransformOperationExecutor.prototype.checkVersion=function(e,t){var r=!0;return r&&e&&(r=this.options.version>=e),r&&t&&(r=this.options.version<t),r},TransformOperationExecutor.prototype.checkGroups=function(e){return!e||this.options.groups.some(function(t){return-1!==e.indexOf(t)})},TransformOperationExecutor}();t.TransformOperationExecutor=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(30);t.defaultMetadataStorage=new a.MetadataStorage},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class Device{constructor(e,t,r){this.index=e,this.name=t,this.allowedMsgs=r}static fromMsg(e){return new Device(e.DeviceIndex,e.DeviceName,e.DeviceMessages)}get Name(){return this.name}get Index(){return this.index}get AllowedMessages(){return Object.keys(this.allowedMsgs)}}t.Device=Device},function(e,t,r){"use strict";var a=r(2);e.exports=function SchemaObject(e){a.copy(e,this)}},function(e,t,r){"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var r,a="boolean"==typeof t.cycles&&t.cycles,s=t.cmp&&(r=t.cmp,function(e){return function(t,a){var s={key:t,value:e[t]},n={key:a,value:e[a]};return r(s,n)}}),n=[];return function stringify(e){if(e&&e.toJSON&&"function"==typeof e.toJSON&&(e=e.toJSON()),void 0!==e){if("number"==typeof e)return isFinite(e)?""+e:"null";if("object"!=typeof e)return JSON.stringify(e);var t,r;if(Array.isArray(e)){for(r="[",t=0;t<e.length;t++)t&&(r+=","),r+=stringify(e[t])||"null";return r+"]"}if(null===e)return"null";if(-1!==n.indexOf(e)){if(a)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var i=n.push(e)-1,o=Object.keys(e).sort(s&&s(e));for(r="",t=0;t<o.length;t++){var c=o[t],u=stringify(e[c]);u&&(r&&(r+=","),r+=JSON.stringify(c)+":"+u)}return n.splice(i,1),"{"+r+"}"}}(e)}},function(e,t,r){"use strict";e.exports=function generate_validate(e,t,r){var a="",s=!0===e.schema.$async,n=e.util.schemaHasRulesExcept(e.schema,e.RULES.all,"$ref"),i=e.self._getId(e.schema);if(e.isTop&&(a+=" var validate = ",s&&(e.async=!0,a+="async "),a+="function(data, dataPath, parentData, parentDataProperty, rootData) { 'use strict'; ",i&&(e.opts.sourceCode||e.opts.processCode)&&(a+=" /*# sourceURL="+i+" */ ")),"boolean"==typeof e.schema||!n&&!e.schema.$ref){t="false schema";var o=e.level,c=e.dataLevel,u=e.schema[t],l=e.schemaPath+e.util.getProperty(t),h=e.errSchemaPath+"/"+t,d=!e.opts.allErrors,f="data"+(c||""),p="valid"+o;if(!1===e.schema){e.isTop?d=!0:a+=" var "+p+" = false; ",(Y=Y||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(g||"false schema")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'boolean schema is false' "),e.opts.verbose&&(a+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";var m=a;a=Y.pop(),!e.compositeRule&&d?e.async?a+=" throw new ValidationError(["+m+"]); ":a+=" validate.errors = ["+m+"]; return false; ":a+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else e.isTop?a+=s?" return data; ":" validate.errors = null; return true; ":a+=" var "+p+" = true; ";return e.isTop&&(a+=" }; return validate; "),a}if(e.isTop){var v=e.isTop;o=e.level=0,c=e.dataLevel=0,f="data";e.rootId=e.resolve.fullPath(e.self._getId(e.root.schema)),e.baseId=e.baseId||e.rootId,delete e.isTop,e.dataPathArr=[void 0],a+=" var vErrors = null; ",a+=" var errors = 0;     ",a+=" if (rootData === undefined) rootData = data; "}else{o=e.level,f="data"+((c=e.dataLevel)||"");if(i&&(e.baseId=e.resolve.url(e.baseId,i)),s&&!e.async)throw new Error("async schema in sync schema");a+=" var errs_"+o+" = errors;"}p="valid"+o,d=!e.opts.allErrors;var g,y="",_="",P=e.schema.type,S=Array.isArray(P);if(S&&1==P.length&&(P=P[0],S=!1),e.schema.$ref&&n){if("fail"==e.opts.extendRefs)throw new Error('$ref: validation keywords used in schema at path "'+e.errSchemaPath+'" (see option extendRefs)');!0!==e.opts.extendRefs&&(n=!1,e.logger.warn('$ref: keywords ignored in schema at path "'+e.errSchemaPath+'"'))}if(e.schema.$comment&&e.opts.$comment&&(a+=" "+e.RULES.all.$comment.code(e,"$comment")),P){if(e.opts.coerceTypes)var b=e.util.coerceToTypes(e.opts.coerceTypes,P);var w=e.RULES.types[P];if(b||S||!0===w||w&&!$shouldUseGroup(w)){l=e.schemaPath+".type",h=e.errSchemaPath+"/type",l=e.schemaPath+".type",h=e.errSchemaPath+"/type";var E=S?"checkDataTypes":"checkDataType";if(a+=" if ("+e.util[E](P,f,!0)+") { ",b){var I="dataType"+o,x="coerced"+o;a+=" var "+I+" = typeof "+f+"; ","array"==e.opts.coerceTypes&&(a+=" if ("+I+" == 'object' && Array.isArray("+f+")) "+I+" = 'array'; "),a+=" var "+x+" = undefined; ";var M="",D=b;if(D)for(var C,L=-1,O=D.length-1;L<O;)C=D[L+=1],L&&(a+=" if ("+x+" === undefined) { ",M+="}"),"array"==e.opts.coerceTypes&&"array"!=C&&(a+=" if ("+I+" == 'array' && "+f+".length == 1) { "+x+" = "+f+" = "+f+"[0]; "+I+" = typeof "+f+";  } "),"string"==C?a+=" if ("+I+" == 'number' || "+I+" == 'boolean') "+x+" = '' + "+f+"; else if ("+f+" === null) "+x+" = ''; ":"number"==C||"integer"==C?(a+=" if ("+I+" == 'boolean' || "+f+" === null || ("+I+" == 'string' && "+f+" && "+f+" == +"+f+" ","integer"==C&&(a+=" && !("+f+" % 1)"),a+=")) "+x+" = +"+f+"; "):"boolean"==C?a+=" if ("+f+" === 'false' || "+f+" === 0 || "+f+" === null) "+x+" = false; else if ("+f+" === 'true' || "+f+" === 1) "+x+" = true; ":"null"==C?a+=" if ("+f+" === '' || "+f+" === 0 || "+f+" === false) "+x+" = null; ":"array"==e.opts.coerceTypes&&"array"==C&&(a+=" if ("+I+" == 'string' || "+I+" == 'number' || "+I+" == 'boolean' || "+f+" == null) "+x+" = ["+f+"]; ");a+=" "+M+" if ("+x+" === undefined) {   ",(Y=Y||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(g||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",a+=S?""+P.join(","):""+P,a+="' } ",!1!==e.opts.messages&&(a+=" , message: 'should be ",a+=S?""+P.join(","):""+P,a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";m=a;a=Y.pop(),!e.compositeRule&&d?e.async?a+=" throw new ValidationError(["+m+"]); ":a+=" validate.errors = ["+m+"]; return false; ":a+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else {  ";var R=c?"data"+(c-1||""):"parentData",T=c?e.dataPathArr[c]:"parentDataProperty";a+=" "+f+" = "+x+"; ",c||(a+="if ("+R+" !== undefined)"),a+=" "+R+"["+T+"] = "+x+"; } "}else{(Y=Y||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(g||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",a+=S?""+P.join(","):""+P,a+="' } ",!1!==e.opts.messages&&(a+=" , message: 'should be ",a+=S?""+P.join(","):""+P,a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";m=a;a=Y.pop(),!e.compositeRule&&d?e.async?a+=" throw new ValidationError(["+m+"]); ":a+=" validate.errors = ["+m+"]; return false; ":a+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}a+=" } "}}if(e.schema.$ref&&!n)a+=" "+e.RULES.all.$ref.code(e,"$ref")+" ",d&&(a+=" } if (errors === ",a+=v?"0":"errs_"+o,a+=") { ",_+="}");else{var A=e.RULES;if(A)for(var B=-1,j=A.length-1;B<j;)if($shouldUseGroup(w=A[B+=1])){if(w.type&&(a+=" if ("+e.util.checkDataType(w.type,f)+") { "),e.opts.useDefaults&&!e.compositeRule)if("object"==w.type&&e.schema.properties){u=e.schema.properties;var $=Object.keys(u);if($)for(var k,F=-1,V=$.length-1;F<V;){if(void 0!==(N=u[k=$[F+=1]]).default)a+="  if ("+(z=f+e.util.getProperty(k))+" === undefined) "+z+" = ","shared"==e.opts.useDefaults?a+=" "+e.useDefault(N.default)+" ":a+=" "+JSON.stringify(N.default)+" ",a+="; "}}else if("array"==w.type&&Array.isArray(e.schema.items)){var U=e.schema.items;if(U){L=-1;for(var N,q=U.length-1;L<q;){var z;if(void 0!==(N=U[L+=1]).default)a+="  if ("+(z=f+"["+L+"]")+" === undefined) "+z+" = ","shared"==e.opts.useDefaults?a+=" "+e.useDefault(N.default)+" ":a+=" "+JSON.stringify(N.default)+" ",a+="; "}}}var W=w.rules;if(W)for(var H,Q=-1,K=W.length-1;Q<K;)if($shouldUseRule(H=W[Q+=1])){var G=H.code(e,H.keyword,w.type);G&&(a+=" "+G+" ",d&&(y+="}"))}if(d&&(a+=" "+y+" ",y=""),w.type&&(a+=" } ",P&&P===w.type&&!b)){a+=" else { ";var Y;l=e.schemaPath+".type",h=e.errSchemaPath+"/type";(Y=Y||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: '"+(g||"type")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(h)+" , params: { type: '",a+=S?""+P.join(","):""+P,a+="' } ",!1!==e.opts.messages&&(a+=" , message: 'should be ",a+=S?""+P.join(","):""+P,a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+l+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+f+" "),a+=" } "):a+=" {} ";m=a;a=Y.pop(),!e.compositeRule&&d?e.async?a+=" throw new ValidationError(["+m+"]); ":a+=" validate.errors = ["+m+"]; return false; ":a+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } "}d&&(a+=" if (errors === ",a+=v?"0":"errs_"+o,a+=") { ",_+="}")}}function $shouldUseGroup(e){for(var t=e.rules,r=0;r<t.length;r++)if($shouldUseRule(t[r]))return!0}function $shouldUseRule(t){return void 0!==e.schema[t.keyword]||t.implements&&function $ruleImplementsSomeKeyword(t){for(var r=t.implements,a=0;a<r.length;a++)if(void 0!==e.schema[r[a]])return!0}(t)}return d&&(a+=" "+_+" "),v?(s?(a+=" if (errors === 0) return data;           ",a+=" else throw new ValidationError(vErrors); "):(a+=" validate.errors = vErrors; ",a+=" return errors === 0;       "),a+=" }; return validate;"):a+=" var "+p+" = errors === errs_"+o+";",a=e.util.cleanUpCode(a),v&&(a=e.util.finalCleanUpCode(a,s)),a}},function(e,t,r){"use strict";e.exports=function generate__limit(e,t,r){var a,s=" ",n=e.level,i=e.dataLevel,o=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,h="data"+(i||""),d=e.opts.$data&&o&&o.$data;d?(s+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",a="schema"+n):a=o;var f="maximum"==t,p=f?"exclusiveMaximum":"exclusiveMinimum",m=e.schema[p],v=e.opts.$data&&m&&m.$data,g=f?"<":">",y=f?">":"<",_=void 0;if(v){var P=e.util.getData(m.$data,i,e.dataPathArr),S="exclusive"+n,b="exclType"+n,w="exclIsNumber"+n,E="' + "+(M="op"+n)+" + '";s+=" var schemaExcl"+n+" = "+P+"; ",s+=" var "+S+"; var "+b+" = typeof "+(P="schemaExcl"+n)+"; if ("+b+" != 'boolean' && "+b+" != 'undefined' && "+b+" != 'number') { ";var I;_=p;(I=I||[]).push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(_||"_exclusiveLimit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: {} ",!1!==e.opts.messages&&(s+=" , message: '"+p+" should be boolean' "),e.opts.verbose&&(s+=" , schema: validate.schema"+c+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),s+=" } "):s+=" {} ";var x=s;s=I.pop(),!e.compositeRule&&l?e.async?s+=" throw new ValidationError(["+x+"]); ":s+=" validate.errors = ["+x+"]; return false; ":s+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } else if ( ",d&&(s+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),s+=" "+b+" == 'number' ? ( ("+S+" = "+a+" === undefined || "+P+" "+g+"= "+a+") ? "+h+" "+y+"= "+P+" : "+h+" "+y+" "+a+" ) : ( ("+S+" = "+P+" === true) ? "+h+" "+y+"= "+a+" : "+h+" "+y+" "+a+" ) || "+h+" !== "+h+") { var op"+n+" = "+S+" ? '"+g+"' : '"+g+"=';"}else{E=g;if((w="number"==typeof m)&&d){var M="'"+E+"'";s+=" if ( ",d&&(s+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),s+=" ( "+a+" === undefined || "+m+" "+g+"= "+a+" ? "+h+" "+y+"= "+m+" : "+h+" "+y+" "+a+" ) || "+h+" !== "+h+") { "}else{w&&void 0===o?(S=!0,_=p,u=e.errSchemaPath+"/"+p,a=m,y+="="):(w&&(a=Math[f?"min":"max"](m,o)),m===(!w||a)?(S=!0,_=p,u=e.errSchemaPath+"/"+p,y+="="):(S=!1,E+="="));M="'"+E+"'";s+=" if ( ",d&&(s+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),s+=" "+h+" "+y+" "+a+" || "+h+" !== "+h+") { "}}_=_||t,(I=I||[]).push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(_||"_limit")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { comparison: "+M+", limit: "+a+", exclusive: "+S+" } ",!1!==e.opts.messages&&(s+=" , message: 'should be "+E+" ",s+=d?"' + "+a:a+"'"),e.opts.verbose&&(s+=" , schema:  ",s+=d?"validate.schema"+c:""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),s+=" } "):s+=" {} ";x=s;return s=I.pop(),!e.compositeRule&&l?e.async?s+=" throw new ValidationError(["+x+"]); ":s+=" validate.errors = ["+x+"]; return false; ":s+=" var err = "+x+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } ",l&&(s+=" else { "),s}},function(e,t,r){"use strict";e.exports=function generate__limitItems(e,t,r){var a,s=" ",n=e.level,i=e.dataLevel,o=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,h="data"+(i||""),d=e.opts.$data&&o&&o.$data;d?(s+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",a="schema"+n):a=o,s+="if ( ",d&&(s+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),s+=" "+h+".length "+("maxItems"==t?">":"<")+" "+a+") { ";var f=t,p=p||[];p.push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(f||"_limitItems")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+a+" } ",!1!==e.opts.messages&&(s+=" , message: 'should NOT have ",s+="maxItems"==t?"more":"less",s+=" than ",s+=d?"' + "+a+" + '":""+o,s+=" items' "),e.opts.verbose&&(s+=" , schema:  ",s+=d?"validate.schema"+c:""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),s+=" } "):s+=" {} ";var m=s;return s=p.pop(),!e.compositeRule&&l?e.async?s+=" throw new ValidationError(["+m+"]); ":s+=" validate.errors = ["+m+"]; return false; ":s+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",l&&(s+=" else { "),s}},function(e,t,r){"use strict";e.exports=function generate__limitLength(e,t,r){var a,s=" ",n=e.level,i=e.dataLevel,o=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,h="data"+(i||""),d=e.opts.$data&&o&&o.$data;d?(s+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",a="schema"+n):a=o;var f="maxLength"==t?">":"<";s+="if ( ",d&&(s+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),!1===e.opts.unicode?s+=" "+h+".length ":s+=" ucs2length("+h+") ",s+=" "+f+" "+a+") { ";var p=t,m=m||[];m.push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(p||"_limitLength")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+a+" } ",!1!==e.opts.messages&&(s+=" , message: 'should NOT be ",s+="maxLength"==t?"longer":"shorter",s+=" than ",s+=d?"' + "+a+" + '":""+o,s+=" characters' "),e.opts.verbose&&(s+=" , schema:  ",s+=d?"validate.schema"+c:""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),s+=" } "):s+=" {} ";var v=s;return s=m.pop(),!e.compositeRule&&l?e.async?s+=" throw new ValidationError(["+v+"]); ":s+=" validate.errors = ["+v+"]; return false; ":s+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",l&&(s+=" else { "),s}},function(e,t,r){"use strict";e.exports=function generate__limitProperties(e,t,r){var a,s=" ",n=e.level,i=e.dataLevel,o=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,h="data"+(i||""),d=e.opts.$data&&o&&o.$data;d?(s+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",a="schema"+n):a=o,s+="if ( ",d&&(s+=" ("+a+" !== undefined && typeof "+a+" != 'number') || "),s+=" Object.keys("+h+").length "+("maxProperties"==t?">":"<")+" "+a+") { ";var f=t,p=p||[];p.push(s),s="",!1!==e.createErrors?(s+=" { keyword: '"+(f||"_limitProperties")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { limit: "+a+" } ",!1!==e.opts.messages&&(s+=" , message: 'should NOT have ",s+="maxProperties"==t?"more":"less",s+=" than ",s+=d?"' + "+a+" + '":""+o,s+=" properties' "),e.opts.verbose&&(s+=" , schema:  ",s+=d?"validate.schema"+c:""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),s+=" } "):s+=" {} ";var m=s;return s=p.pop(),!e.compositeRule&&l?e.async?s+=" throw new ValidationError(["+m+"]); ":s+=" validate.errors = ["+m+"]; return false; ":s+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",l&&(s+=" else { "),s}},function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function fulfilled(e){try{step(a.next(e))}catch(e){n(e)}}function rejected(e){try{step(a.throw(e))}catch(e){n(e)}}function step(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const s=r(1),n=r(24);t.ButtplugEmbeddedServerConnector=class ButtplugEmbeddedServerConnector extends s.EventEmitter{constructor(){super(...arguments),this._connected=!1,this._server=null,this.Connect=(()=>a(this,void 0,void 0,function*(){return this._connected=!0,null===this._server&&(this._server=new n.ButtplugServer),this._server.addListener("message",this.OnMessageReceived),Promise.resolve()})),this.Disconnect=(()=>{this._connected&&(this._connected=!1,this._server=null,this.emit("disconnect"))}),this.Send=(e=>a(this,void 0,void 0,function*(){if(!this._connected)throw new Error("ButtplugClient not connected");const t=yield this._server.SendMessage(e);this.emit("message",[t])})),this.OnMessageReceived=(e=>{this.emit("message",[e])})}set Server(e){this._server=e}get Server(){return this._server}get Connected(){return this._connected}}},function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function fulfilled(e){try{step(a.next(e))}catch(e){n(e)}}function rejected(e){try{step(a.throw(e))}catch(e){n(e)}}function step(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),n=r(6),i=r(81),o=r(1),c=r(27),u=r(3);t.ButtplugServer=class ButtplugServer extends o.EventEmitter{constructor(e="Buttplug JS Internal Server",t=0){super(),this._serverName=e,this._maxPingTime=t,this._clientSchemaVersion=-1,this._pingTimedOut=!1,this._receivedRequestServerInfo=!1,this._logger=u.ButtplugLogger.Logger,this._outgoingLogLevel=u.ButtplugLogLevel.Off,this.AddDeviceManager=(e=>{this._deviceManager.AddDeviceManager(e)}),this.SendMessage=(e=>a(this,void 0,void 0,function*(){const t=e.Id;if(this._logger.Trace(`Server: Got Message: ${e}`),0===t)return this._logger.LogAndError("Message Id 0 is reserved for outgoing system messages. Please use another Id.",s.ErrorClass.ERROR_MSG,t);if(this._pingTimedOut)return this._logger.LogAndError("Ping timed out.",s.ErrorClass.ERROR_MSG,t);if(!this._receivedRequestServerInfo&&"RequestServerInfo"!==e.Type)return this._logger.LogAndError("RequestServerInfo must be first message received by server.",s.ErrorClass.ERROR_INIT,t);switch(e.Type){case"RequestLog":const r=e;return this._logger.Debug(`Server: RequestLog received for level ${r.LogLevel}`),r.LogLevel===u.ButtplugLogLevel[u.ButtplugLogLevel.Off]?this._logger.removeListener("log",this.OnLogMessage):this._outgoingLogLevel===u.ButtplugLogLevel.Off&&this._logger.addListener("log",this.OnLogMessage),this._logger.MaximumEventLogLevel=u.ButtplugLogLevel[r.LogLevel],this._outgoingLogLevel=u.ButtplugLogLevel[r.LogLevel],new s.Ok(r.Id);case"Ping":return new s.Ok(e.Id);case"RequestServerInfo":this._logger.Debug("Server: RequestServerInfo received.");const a=e;return this._clientSchemaVersion>1?new s.Error(`Client schema (${this._clientSchemaVersion}) newer than server schema (1). `+"Please upgrade server.",s.ErrorClass.ERROR_INIT,t):(this._receivedRequestServerInfo=!0,this._clientSchemaVersion=a.MessageVersion,this._clientName=a.ClientName,new s.ServerInfo(0,0,0,n.GetSchemaVersion(),this._maxPingTime,this._serverName,t));case"Test":this._logger.Debug("Server: Test received.");const i=e;return new s.Test(i.TestString,e.Id)}return this._deviceManager.SendMessage(e)})),this.Shutdown=(()=>a(this,void 0,void 0,function*(){})),this.OnLogMessage=(e=>{e.LogLevel>this._outgoingLogLevel||this.OnOutgoingMessage(new s.Log(u.ButtplugLogLevel[e.LogLevel],e.Message))}),this.OnOutgoingMessage=(e=>{if("Error"===e.constructor.name)return e;if(-1===this._clientSchemaVersion)return new s.Error("Cannot discern client schema version. Was RequestServerInfo message sent?");for(;e.SchemaVersion!==this._clientSchemaVersion&&e.SchemaVersion>0;)e=e.DowngradeMessage();"Error"===e.constructor.name&&this._logger.Error(e.ErrorMessage),this.emit("message",e)}),this._logger.Info(`Server: Starting Buttplug Server: ${this._serverName}`),this._deviceManager=new i.DeviceManager,c.ServerMessageHub.Instance.addListener("message",this.OnOutgoingMessage)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(83),s=r(84),n=r(89),i=r(90);t.BluetoothDevices=class BluetoothDevices{static GetDeviceInfo(){return[a.FleshlightLaunch.DeviceInfo,s.LovenseRev1.DeviceInfo,s.LovenseRev2.DeviceInfo,s.LovenseRev3.DeviceInfo,s.LovenseRev4.DeviceInfo,s.LovenseRev5.DeviceInfo,s.LovenseRev6.DeviceInfo,s.LovenseRev7.DeviceInfo,n.VorzeA10Cyclone.DeviceInfo,i.WeVibe.DeviceInfo]}}},function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function fulfilled(e){try{step(a.next(e))}catch(e){n(e)}}function rejected(e){try{step(a.throw(e))}catch(e){n(e)}}function step(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),n=r(1);t.ButtplugDevice=class ButtplugDevice extends n.EventEmitter{constructor(e){super(),this._name=e,this.MsgFuncs=new Map,this.ParseMessage=(e=>a(this,void 0,void 0,function*(){return this.MsgFuncs.has(e.Type)?this.MsgFuncs.get(e.Type)(e):new s.Error(`${this._name} cannot handle message of type ${e.Type}`,s.ErrorClass.ERROR_MSG,e.Id)}))}get Name(){return this._name}get AllowedMessageTypes(){return Object.keys(this.MessageSpecifications)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(1);class ServerMessageHub extends a.EventEmitter{static get Instance(){return ServerMessageHub.sInstance}emitMessage(e){this.emit("message",e)}}ServerMessageHub.sInstance=new ServerMessageHub,t.ServerMessageHub=ServerMessageHub},function(e,t,r){"use strict";function __export(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0}),__export(r(29)),__export(r(92)),__export(r(23)),__export(r(0)),__export(r(6)),__export(r(15)),__export(r(3)),__export(r(24)),__export(r(26)),__export(r(93)),__export(r(5)),__export(r(4)),__export(r(25)),__export(r(94))},function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function fulfilled(e){try{step(a.next(e))}catch(e){n(e)}}function rejected(e){try{step(a.throw(e))}catch(e){n(e)}}function step(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const s=r(3),n=r(1),i=r(15),o=r(38),c=r(23),u=r(0),l=r(6);t.ButtplugClient=class ButtplugClient extends n.EventEmitter{constructor(e="Generic Buttplug Client"){super(),this._pingTimer=null,this._connector=null,this._devices=new Map,this._counter=1,this._waitingMsgs=new Map,this._logger=s.ButtplugLogger.Logger,this._messageVersion=1,this.ConnectWebsocket=(e=>a(this,void 0,void 0,function*(){this._logger.Info(`ButtplugClient: Connecting to ${e}`),yield this.Connect(new o.ButtplugBrowserWebsocketConnector(e))})),this.ConnectLocal=(()=>a(this,void 0,void 0,function*(){this._logger.Info("ButtplugClient: Connecting to In-Browser Server"),yield this.Connect(new c.ButtplugEmbeddedServerConnector)})),this.Connect=(e=>a(this,void 0,void 0,function*(){this._logger.Info(`ButtplugClient: Connecting using ${e.constructor.name}`),yield e.Connect(),this._connector=e,this._connector.addListener("message",this.ParseMessages),this._connector.addListener("disconnect",this.DisconnectHandler),yield this.InitializeConnection()})),this.StartScanning=(()=>a(this,void 0,void 0,function*(){return this._logger.Debug("ButtplugClient: StartScanning called"),yield this.SendMsgExpectOk(new u.StartScanning)})),this.StopScanning=(()=>a(this,void 0,void 0,function*(){return this._logger.Debug("ButtplugClient: StopScanning called"),yield this.SendMsgExpectOk(new u.StopScanning)})),this.RequestLog=(e=>a(this,void 0,void 0,function*(){return this._logger.Debug(`ButtplugClient: RequestLog called with level ${e}`),yield this.SendMsgExpectOk(new u.RequestLog(e))})),this.StopAllDevices=(()=>a(this,void 0,void 0,function*(){return this._logger.Debug("ButtplugClient: StopAllDevices"),yield this.SendMsgExpectOk(new u.StopAllDevices)})),this.ParseMessages=(e=>{this.ParseMessagesInternal(e)}),this.DisconnectHandler=(()=>{this._logger.Info("ButtplugClient: Disconnect event receieved."),this.emit("disconnect")}),this.InitializeConnection=(()=>a(this,void 0,void 0,function*(){this.CheckConnector();const e=yield this.SendMessage(new u.RequestServerInfo(this._clientName,1));switch(e.Type){case"ServerInfo":{const t=e;this._logger.Info(`ButtplugClient: Connected to Server ${t.ServerName}`);const r=t.MaxPingTime;if(t.MessageVersion<this._messageVersion)throw this._connector.Disconnect(),new Error("Server protocol version is older than client protocol version. Please update server.");return r>0&&(this._pingTimer=setInterval(()=>{this.Connected?this.SendMessage(new u.Ping(this._counter)):this.ShutdownConnection()},Math.round(r/2))),yield this.RequestDeviceList(),!0}case"Error":{const t=e;throw this._logger.Error(`ButtplugClient: Cannot connect to server. ${t.ErrorMessage}`),this._connector.Disconnect(),new Error(e.ErrorMessage)}}return!1})),this.RequestDeviceList=(()=>a(this,void 0,void 0,function*(){this.CheckConnector(),this._logger.Debug("ButtplugClient: ReceiveDeviceList called"),(yield this.SendMessage(new u.RequestDeviceList)).Devices.forEach(e=>{if(this._devices.has(e.DeviceIndex))this._logger.Debug(`ButtplugClient: Device already added: ${e}`);else{const t=i.Device.fromMsg(e);this._logger.Debug(`ButtplugClient: Adding Device: ${t}`),this._devices.set(e.DeviceIndex,t),this.emit("deviceadded",t)}})})),this.ShutdownConnection=(()=>{null!==this._pingTimer&&(clearInterval(this._pingTimer),this._pingTimer=null)}),this.SendMsgExpectOk=(e=>a(this,void 0,void 0,function*(){let t,r;const a=yield this.SendMessage(e),s=new Promise((e,a)=>{t=e,r=a});switch(a.Type){case"Ok":t();break;default:r(a)}return s})),this._clientName=e,this._logger.Debug(`ButtplugClient: Client ${e} created.`)}get Connected(){return null!==this._connector&&this._connector.Connected}Disconnect(){this._logger.Debug("ButtplugClient: Disconnect called"),this.CheckConnector(),this.ShutdownConnection(),this._connector.Disconnect()}get Devices(){this.CheckConnector();const e=[];return this._devices.forEach((t,r)=>{e.push(t)}),e}SendDeviceMessage(e,t){return a(this,void 0,void 0,function*(){this.CheckConnector();const r=this._devices.get(e.Index);return void 0===r?(this._logger.Error(`Device ${e.Index} not available.`),Promise.reject(new Error("Device not available."))):-1===r.AllowedMessages.indexOf(t.Type)?(this._logger.Error(`Device ${e.Name} does not accept message type ${t.Type}.`),Promise.reject(new Error(`Device ${e.Name} does not accept message type ${t.Type}.`))):(t.DeviceIndex=e.Index,yield this.SendMsgExpectOk(t))})}ParseMessagesInternal(e){for(const t of e){if(t.Id>0&&this._waitingMsgs.has(t.Id))return void this._waitingMsgs.get(t.Id)(t);switch(t.Type){case"Log":this.emit("log",t);break;case"DeviceAdded":const e=t,r=i.Device.fromMsg(e);this._devices.set(e.DeviceIndex,r),this.emit("deviceadded",r);break;case"DeviceRemoved":const a=t;if(this._devices.has(a.DeviceIndex)){const e=this._devices.get(a.DeviceIndex);this._devices.delete(a.DeviceIndex),this.emit("deviceremoved",e)}break;case"ScanningFinished":this.emit("scanningfinished",t)}}}SendMessage(e){return a(this,void 0,void 0,function*(){let t;this.CheckConnector(),l.CheckMessage(e),e.Id=this._counter;const r=new Promise(e=>{t=e});return this._waitingMsgs.set(this._counter,t),this._counter+=1,this._connector.Send(e),yield r})}CheckConnector(){if(!this.Connected)throw new Error("ButtplugClient not connected")}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(13),s=function(){function MetadataStorage(){this._typeMetadatas=[],this._transformMetadatas=[],this._exposeMetadatas=[],this._excludeMetadatas=[]}return MetadataStorage.prototype.addTypeMetadata=function(e){this._typeMetadatas.push(e)},MetadataStorage.prototype.addTransformMetadata=function(e){this._transformMetadatas.push(e)},MetadataStorage.prototype.addExposeMetadata=function(e){this._exposeMetadatas.push(e)},MetadataStorage.prototype.addExcludeMetadata=function(e){this._excludeMetadatas.push(e)},MetadataStorage.prototype.findTransformMetadatas=function(e,t,r){return this.findMetadatas(this._transformMetadatas,e,t).filter(function(e){return!e.options||(!0===e.options.toClassOnly&&!0===e.options.toPlainOnly||(!0===e.options.toClassOnly?r===a.TransformationType.CLASS_TO_CLASS||r===a.TransformationType.PLAIN_TO_CLASS:!0!==e.options.toPlainOnly||r===a.TransformationType.CLASS_TO_PLAIN))})},MetadataStorage.prototype.findExcludeMetadata=function(e,t){return this.findMetadata(this._excludeMetadatas,e,t)},MetadataStorage.prototype.findExposeMetadata=function(e,t){return this.findMetadata(this._exposeMetadatas,e,t)},MetadataStorage.prototype.findExposeMetadataByCustomName=function(e,t){return this.getExposedMetadatas(e).find(function(e){return e.options&&e.options.name===t})},MetadataStorage.prototype.findTypeMetadata=function(e,t){return this.findMetadata(this._typeMetadatas,e,t)},MetadataStorage.prototype.getStrategy=function(e){var t=this._excludeMetadatas.find(function(t){return t.target===e&&void 0===t.propertyName}),r=this._exposeMetadatas.find(function(t){return t.target===e&&void 0===t.propertyName});return t&&r||!t&&!r?"none":t?"excludeAll":"exposeAll"},MetadataStorage.prototype.getExposedMetadatas=function(e){return this.getMetadata(this._exposeMetadatas,e)},MetadataStorage.prototype.getExcludedMetadatas=function(e){return this.getMetadata(this._excludeMetadatas,e)},MetadataStorage.prototype.getExposedProperties=function(e,t){return this.getExposedMetadatas(e).filter(function(e){return!e.options||(!0===e.options.toClassOnly&&!0===e.options.toPlainOnly||(!0===e.options.toClassOnly?t===a.TransformationType.CLASS_TO_CLASS||t===a.TransformationType.PLAIN_TO_CLASS:!0!==e.options.toPlainOnly||t===a.TransformationType.CLASS_TO_PLAIN))}).map(function(e){return e.propertyName})},MetadataStorage.prototype.getExcludedProperties=function(e,t){return this.getExcludedMetadatas(e).filter(function(e){return!e.options||(!0===e.options.toClassOnly&&!0===e.options.toPlainOnly||(!0===e.options.toClassOnly?t===a.TransformationType.CLASS_TO_CLASS||t===a.TransformationType.PLAIN_TO_CLASS:!0!==e.options.toPlainOnly||t===a.TransformationType.CLASS_TO_PLAIN))}).map(function(e){return e.propertyName})},MetadataStorage.prototype.clear=function(){this._typeMetadatas=[],this._exposeMetadatas=[],this._excludeMetadatas=[]},MetadataStorage.prototype.getMetadata=function(e,t){var r=e.filter(function(e){return e.target===t&&void 0!==e.propertyName});return e.filter(function(e){return t.prototype instanceof e.target&&void 0!==e.propertyName}).concat(r)},MetadataStorage.prototype.findMetadata=function(e,t,r){var a=e.find(function(e){return e.target===t&&e.propertyName===r}),s=e.find(function(e){return t.prototype instanceof e.target&&e.propertyName===r});return a||s},MetadataStorage.prototype.findMetadatas=function(e,t,r){var a=e.filter(function(e){return e.target===t&&e.propertyName===r});return e.filter(function(e){return t.prototype instanceof e.target&&e.propertyName===r}).reverse().concat(a.reverse())},MetadataStorage}();t.MetadataStorage=s},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(7),s=r(14),n=r(32),i=r(33),o=r(34),c=r(35);t.Transform=function Transform(e,t){return function(r,a){var n=new c.TransformMetadata(r.constructor,a,e,t);s.defaultMetadataStorage.addTransformMetadata(n)}},t.Type=function Type(e){return function(t,r){var a=Reflect.getMetadata("design:type",t,r),i=new n.TypeMetadata(t.constructor,r,a,e);s.defaultMetadataStorage.addTypeMetadata(i)}},t.Expose=function Expose(e){return function(t,r){var a=new i.ExposeMetadata(t instanceof Function?t:t.constructor,r,e||{});s.defaultMetadataStorage.addExposeMetadata(a)}},t.Exclude=function Exclude(e){return function(t,r){var a=new o.ExcludeMetadata(t instanceof Function?t:t.constructor,r,e||{});s.defaultMetadataStorage.addExcludeMetadata(a)}},t.TransformClassToPlain=function TransformClassToPlain(e){return function(t,r,s){var n=new a.ClassTransformer,i=s.value;s.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=i.apply(this,t);return!a||"object"!=typeof a&&"function"!=typeof a||"function"!=typeof a.then?n.classToPlain(a,e):a.then(function(t){return n.classToPlain(t,e)})}}},t.TransformClassToClass=function TransformClassToClass(e){return function(t,r,s){var n=new a.ClassTransformer,i=s.value;s.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=i.apply(this,t);return!a||"object"!=typeof a&&"function"!=typeof a||"function"!=typeof a.then?n.classToClass(a,e):a.then(function(t){return n.classToClass(t,e)})}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){return function TypeMetadata(e,t,r,a){this.target=e,this.propertyName=t,this.reflectedType=r,this.typeFunction=a}}();t.TypeMetadata=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){return function ExposeMetadata(e,t,r){this.target=e,this.propertyName=t,this.options=r}}();t.ExposeMetadata=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){return function ExcludeMetadata(e,t,r){this.target=e,this.propertyName=t,this.options=r}}();t.ExcludeMetadata=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){return function TransformMetadata(e,t,r,a){this.target=e,this.propertyName=t,this.transformFn=r,this.options=a}}();t.TransformMetadata=a},function(e,t,r){(function(e,t){var r,a;a=r||(r={}),function(r){var s="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),n=makeExporter(a);function makeExporter(e,t){return function(r,a){"function"!=typeof e[r]&&Object.defineProperty(e,r,{configurable:!0,writable:!0,value:a}),t&&t(r,a)}}void 0===s.Reflect?s.Reflect=a:n=makeExporter(s.Reflect,n),function(t){var r=Object.prototype.hasOwnProperty,a="function"==typeof Symbol,s=a&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",n=a&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",i="function"==typeof Object.create,o={__proto__:[]}instanceof Array,c=!i&&!o,u={create:i?function(){return MakeDictionary(Object.create(null))}:o?function(){return MakeDictionary({__proto__:null})}:function(){return MakeDictionary({})},has:c?function(e,t){return r.call(e,t)}:function(e,t){return t in e},get:c?function(e,t){return r.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),h="object"==typeof e&&Object({NODE_ENV:"production"})&&"true"===Object({NODE_ENV:"production"}).REFLECT_METADATA_USE_MAP_POLYFILL,d=h||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function CreateMapPolyfill(){var e={},t=[],r=function(){function MapIterator(e,t,r){this._index=0,this._keys=e,this._values=t,this._selector=r}return MapIterator.prototype["@@iterator"]=function(){return this},MapIterator.prototype[n]=function(){return this},MapIterator.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var r=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},MapIterator.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},MapIterator.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},MapIterator}();return function(){function Map(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(Map.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Map.prototype.has=function(e){return this._find(e,!1)>=0},Map.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},Map.prototype.set=function(e,t){var r=this._find(e,!0);return this._values[r]=t,this},Map.prototype.delete=function(t){var r=this._find(t,!1);if(r>=0){for(var a=this._keys.length,s=r+1;s<a;s++)this._keys[s-1]=this._keys[s],this._values[s-1]=this._values[s];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},Map.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},Map.prototype.keys=function(){return new r(this._keys,this._values,getKey)},Map.prototype.values=function(){return new r(this._keys,this._values,getValue)},Map.prototype.entries=function(){return new r(this._keys,this._values,getEntry)},Map.prototype["@@iterator"]=function(){return this.entries()},Map.prototype[n]=function(){return this.entries()},Map.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},Map}();function getKey(e,t){return e}function getValue(e,t){return t}function getEntry(e,t){return[e,t]}}():Map,f=h||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function CreateSetPolyfill(){return function(){function Set(){this._map=new d}return Object.defineProperty(Set.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),Set.prototype.has=function(e){return this._map.has(e)},Set.prototype.add=function(e){return this._map.set(e,e),this},Set.prototype.delete=function(e){return this._map.delete(e)},Set.prototype.clear=function(){this._map.clear()},Set.prototype.keys=function(){return this._map.keys()},Set.prototype.values=function(){return this._map.values()},Set.prototype.entries=function(){return this._map.entries()},Set.prototype["@@iterator"]=function(){return this.keys()},Set.prototype[n]=function(){return this.keys()},Set}()}():Set,p=new(h||"function"!=typeof WeakMap?function CreateWeakMapPolyfill(){var e=16,t=u.create(),a=CreateUniqueKey();return function(){function WeakMap(){this._key=CreateUniqueKey()}return WeakMap.prototype.has=function(e){var t=GetOrCreateWeakMapTable(e,!1);return void 0!==t&&u.has(t,this._key)},WeakMap.prototype.get=function(e){var t=GetOrCreateWeakMapTable(e,!1);return void 0!==t?u.get(t,this._key):void 0},WeakMap.prototype.set=function(e,t){var r=GetOrCreateWeakMapTable(e,!0);return r[this._key]=t,this},WeakMap.prototype.delete=function(e){var t=GetOrCreateWeakMapTable(e,!1);return void 0!==t&&delete t[this._key]},WeakMap.prototype.clear=function(){this._key=CreateUniqueKey()},WeakMap}();function CreateUniqueKey(){var e;do{e="@@WeakMap@@"+CreateUUID()}while(u.has(t,e));return t[e]=!0,e}function GetOrCreateWeakMapTable(e,t){if(!r.call(e,a)){if(!t)return;Object.defineProperty(e,a,{value:u.create()})}return e[a]}function FillRandomBytes(e,t){for(var r=0;r<t;++r)e[r]=255*Math.random()|0;return e}function CreateUUID(){var t=function GenRandomBytes(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):FillRandomBytes(new Uint8Array(e),e):FillRandomBytes(new Array(e),e)}(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var r="",a=0;a<e;++a){var s=t[a];4!==a&&6!==a&&8!==a||(r+="-"),s<16&&(r+="0"),r+=s.toString(16).toLowerCase()}return r}}():WeakMap);function GetOrCreateMetadataMap(e,t,r){var a=p.get(e);if(IsUndefined(a)){if(!r)return;a=new d,p.set(e,a)}var s=a.get(t);if(IsUndefined(s)){if(!r)return;s=new d,a.set(t,s)}return s}function OrdinaryHasOwnMetadata(e,t,r){var a=GetOrCreateMetadataMap(t,r,!1);return!IsUndefined(a)&&function ToBoolean(e){return!!e}(a.has(e))}function OrdinaryGetOwnMetadata(e,t,r){var a=GetOrCreateMetadataMap(t,r,!1);if(!IsUndefined(a))return a.get(e)}function OrdinaryDefineOwnMetadata(e,t,r,a){var s=GetOrCreateMetadataMap(r,a,!0);s.set(e,t)}function OrdinaryOwnMetadataKeys(e,t){var r,a,s=[],i=GetOrCreateMetadataMap(e,t,!1);if(IsUndefined(i))return s;for(var o,c=i.keys(),u=function GetIterator(e){var t=GetMethod(e,n);if(!IsCallable(t))throw new TypeError;var r=t.call(e);if(!IsObject(r))throw new TypeError;return r}(c),l=0;;){var h=!(o=u.next()).done&&o;if(!h)return s.length=l,s;var d=h.value;try{s[l]=d}catch(e){try{a=void 0,(a=(r=u).return)&&a.call(r)}finally{throw e}}l++}}function Type(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function IsUndefined(e){return void 0===e}function IsNull(e){return null===e}function IsObject(e){return"object"==typeof e?null!==e:"function"==typeof e}function ToPrimitive(e,t){switch(Type(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var r=3===t?"string":5===t?"number":"default",a=GetMethod(e,s);if(void 0!==a){var n=a.call(e,r);if(IsObject(n))throw new TypeError;return n}return function OrdinaryToPrimitive(e,t){if("string"===t){var r=e.toString;if(IsCallable(r)){var a=r.call(e);if(!IsObject(a))return a}var s=e.valueOf;if(IsCallable(s)){var a=s.call(e);if(!IsObject(a))return a}}else{var s=e.valueOf;if(IsCallable(s)){var a=s.call(e);if(!IsObject(a))return a}var n=e.toString;if(IsCallable(n)){var a=n.call(e);if(!IsObject(a))return a}}throw new TypeError}(e,"default"===r?"number":r)}function ToPropertyKey(e){var t=ToPrimitive(e,3);return function IsSymbol(e){return"symbol"==typeof e}(t)?t:function ToString(e){return""+e}(t)}function IsArray(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function IsCallable(e){return"function"==typeof e}function IsConstructor(e){return"function"==typeof e}function GetMethod(e,t){var r=e[t];if(void 0!==r&&null!==r){if(!IsCallable(r))throw new TypeError;return r}}function OrdinaryGetPrototypeOf(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===l)return t;if(t!==l)return t;var r=e.prototype,a=r&&Object.getPrototypeOf(r);if(null==a||a===Object.prototype)return t;var s=a.constructor;return"function"!=typeof s?t:s===e?t:s}function MakeDictionary(e){return e.__=void 0,delete e.__,e}t("decorate",function decorate(e,t,r,a){if(IsUndefined(r)){if(!IsArray(e))throw new TypeError;if(!IsConstructor(t))throw new TypeError;return function DecorateConstructor(e,t){for(var r=e.length-1;r>=0;--r){var a=e[r],s=a(t);if(!IsUndefined(s)&&!IsNull(s)){if(!IsConstructor(s))throw new TypeError;t=s}}return t}(e,t)}if(!IsArray(e))throw new TypeError;if(!IsObject(t))throw new TypeError;if(!IsObject(a)&&!IsUndefined(a)&&!IsNull(a))throw new TypeError;return IsNull(a)&&(a=void 0),r=ToPropertyKey(r),function DecorateProperty(e,t,r,a){for(var s=e.length-1;s>=0;--s){var n=e[s],i=n(t,r,a);if(!IsUndefined(i)&&!IsNull(i)){if(!IsObject(i))throw new TypeError;a=i}}return a}(e,t,r,a)}),t("metadata",function metadata(e,t){return function decorator(r,a){if(!IsObject(r))throw new TypeError;if(!IsUndefined(a)&&!function IsPropertyKey(e){switch(Type(e)){case 3:case 4:return!0;default:return!1}}(a))throw new TypeError;OrdinaryDefineOwnMetadata(e,t,r,a)}}),t("defineMetadata",function defineMetadata(e,t,r,a){if(!IsObject(r))throw new TypeError;return IsUndefined(a)||(a=ToPropertyKey(a)),OrdinaryDefineOwnMetadata(e,t,r,a)}),t("hasMetadata",function hasMetadata(e,t,r){if(!IsObject(t))throw new TypeError;return IsUndefined(r)||(r=ToPropertyKey(r)),function OrdinaryHasMetadata(e,t,r){var a=OrdinaryHasOwnMetadata(e,t,r);if(a)return!0;var s=OrdinaryGetPrototypeOf(t);return!IsNull(s)&&OrdinaryHasMetadata(e,s,r)}(e,t,r)}),t("hasOwnMetadata",function hasOwnMetadata(e,t,r){if(!IsObject(t))throw new TypeError;return IsUndefined(r)||(r=ToPropertyKey(r)),OrdinaryHasOwnMetadata(e,t,r)}),t("getMetadata",function getMetadata(e,t,r){if(!IsObject(t))throw new TypeError;return IsUndefined(r)||(r=ToPropertyKey(r)),function OrdinaryGetMetadata(e,t,r){var a=OrdinaryHasOwnMetadata(e,t,r);if(a)return OrdinaryGetOwnMetadata(e,t,r);var s=OrdinaryGetPrototypeOf(t);return IsNull(s)?void 0:OrdinaryGetMetadata(e,s,r)}(e,t,r)}),t("getOwnMetadata",function getOwnMetadata(e,t,r){if(!IsObject(t))throw new TypeError;return IsUndefined(r)||(r=ToPropertyKey(r)),OrdinaryGetOwnMetadata(e,t,r)}),t("getMetadataKeys",function getMetadataKeys(e,t){if(!IsObject(e))throw new TypeError;return IsUndefined(t)||(t=ToPropertyKey(t)),function OrdinaryMetadataKeys(e,t){var r=OrdinaryOwnMetadataKeys(e,t),a=OrdinaryGetPrototypeOf(e);if(null===a)return r;var s=OrdinaryMetadataKeys(a,t);if(s.length<=0)return r;if(r.length<=0)return s;for(var n=new f,i=[],o=0,c=r;o<c.length;o++){var u=c[o],l=n.has(u);l||(n.add(u),i.push(u))}for(var h=0,d=s;h<d.length;h++){var u=d[h],l=n.has(u);l||(n.add(u),i.push(u))}return i}(e,t)}),t("getOwnMetadataKeys",function getOwnMetadataKeys(e,t){if(!IsObject(e))throw new TypeError;return IsUndefined(t)||(t=ToPropertyKey(t)),OrdinaryOwnMetadataKeys(e,t)}),t("deleteMetadata",function deleteMetadata(e,t,r){if(!IsObject(t))throw new TypeError;IsUndefined(r)||(r=ToPropertyKey(r));var a=GetOrCreateMetadataMap(t,r,!1);if(IsUndefined(a))return!1;if(!a.delete(e))return!1;if(a.size>0)return!0;var s=p.get(t);return s.delete(r),s.size>0||(p.delete(t),!0)})}(n)}()}).call(t,r(37),r(8))},function(e,t){var r,a,s=e.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(r===setTimeout)return setTimeout(e,0);if((r===defaultSetTimout||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){r=defaultSetTimout}try{a="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){a=defaultClearTimeout}}();var n,i=[],o=!1,c=-1;function cleanUpNextTick(){o&&n&&(o=!1,n.length?i=n.concat(i):c=-1,i.length&&drainQueue())}function drainQueue(){if(!o){var e=runTimeout(cleanUpNextTick);o=!0;for(var t=i.length;t;){for(n=i,i=[];++c<t;)n&&n[c].run();c=-1,t=i.length}n=null,o=!1,function runClearTimeout(e){if(a===clearTimeout)return clearTimeout(e);if((a===defaultClearTimeout||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{return a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}s.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];i.push(new Item(e,t)),1!==i.length||o||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=noop,s.addListener=noop,s.once=noop,s.off=noop,s.removeListener=noop,s.removeAllListeners=noop,s.emit=noop,s.prependListener=noop,s.prependOnceListener=noop,s.listeners=function(e){return[]},s.binding=function(e){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function fulfilled(e){try{step(a.next(e))}catch(e){n(e)}}function rejected(e){try{step(a.throw(e))}catch(e){n(e)}}function step(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const s=r(1),n=r(6);t.ButtplugBrowserWebsocketConnector=class ButtplugBrowserWebsocketConnector extends s.EventEmitter{constructor(e){super(),this._url=e,this.Connect=(()=>a(this,void 0,void 0,function*(){const e=new WebSocket(this._url);let t,r;const s=new Promise((e,a)=>{t=e,r=a}),n=e=>r();return e.addEventListener("open",r=>a(this,void 0,void 0,function*(){this._ws=e,this._ws.addEventListener("message",e=>{this.ParseIncomingMessage(e)}),this._ws.removeEventListener("close",n),this._ws.addEventListener("close",this.Disconnect),t()})),e.addEventListener("close",n),s})),this.Disconnect=(()=>{this.Connected&&(this._ws.close(),this._ws=void 0,this.emit("disconnect"))}),this.Send=(e=>{if(!this.Connected)throw new Error("ButtplugClient not connected");this._ws.send("["+e.toJSON()+"]")}),this.ParseIncomingMessage=(e=>{if("string"==typeof e.data){const t=n.FromJSON(e.data);this.emit("message",t)}else if(e.data instanceof Blob){const t=new FileReader;t.addEventListener("load",e=>{this.OnReaderLoad(e)}),t.readAsText(e.data)}})}get Connected(){return void 0!==this._ws}OnReaderLoad(e){const t=n.FromJSON(e.target.result);this.emit("message",t)}}},function(e,t,r){"use strict";var a=r(40),s=r(9),n=r(50),i=r(16),o=r(17),c=r(51),u=r(52),l=r(73),h=r(2);e.exports=Ajv,Ajv.prototype.validate=function validate(e,t){var r;if("string"==typeof e){if(!(r=this.getSchema(e)))throw new Error('no schema with key or ref "'+e+'"')}else{var a=this._addSchema(e);r=a.validate||this._compile(a)}var s=r(t);!0!==r.$async&&(this.errors=r.errors);return s},Ajv.prototype.compile=function compile(e,t){var r=this._addSchema(e,void 0,t);return r.validate||this._compile(r)},Ajv.prototype.addSchema=function addSchema(e,t,r,a){if(Array.isArray(e)){for(var n=0;n<e.length;n++)this.addSchema(e[n],void 0,r,a);return this}var i=this._getId(e);if(void 0!==i&&"string"!=typeof i)throw new Error("schema id must be string");return checkUnique(this,t=s.normalizeId(t||i)),this._schemas[t]=this._addSchema(e,r,a,!0),this},Ajv.prototype.addMetaSchema=function addMetaSchema(e,t,r){return this.addSchema(e,t,r,!0),this},Ajv.prototype.validateSchema=function validateSchema(e,t){var r=e.$schema;if(void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(!(r=r||this._opts.defaultMeta||function defaultMeta(e){var t=e._opts.meta;return e._opts.defaultMeta="object"==typeof t?e._getId(t)||t:e.getSchema(p)?p:void 0,e._opts.defaultMeta}(this)))return this.logger.warn("meta-schema not available"),this.errors=null,!0;var a,s=this._formats.uri;this._formats.uri="function"==typeof s?this._schemaUriFormatFunc:this._schemaUriFormat;try{a=this.validate(r,e)}finally{this._formats.uri=s}if(!a&&t){var n="schema is invalid: "+this.errorsText();if("log"!=this._opts.validateSchema)throw new Error(n);this.logger.error(n)}return a},Ajv.prototype.getSchema=function getSchema(e){var t=_getSchemaObj(this,e);switch(typeof t){case"object":return t.validate||this._compile(t);case"string":return this.getSchema(t);case"undefined":return function _getSchemaFragment(e,t){var r=s.schema.call(e,{schema:{}},t);if(r){var n=r.schema,o=r.root,c=r.baseId,u=a.call(e,n,o,void 0,c);return e._fragments[t]=new i({ref:t,fragment:!0,schema:n,root:o,baseId:c,validate:u}),u}}(this,e)}},Ajv.prototype.removeSchema=function removeSchema(e){if(e instanceof RegExp)return _removeAllSchemas(this,this._schemas,e),_removeAllSchemas(this,this._refs,e),this;switch(typeof e){case"undefined":return _removeAllSchemas(this,this._schemas),_removeAllSchemas(this,this._refs),this._cache.clear(),this;case"string":var t=_getSchemaObj(this,e);return t&&this._cache.del(t.cacheKey),delete this._schemas[e],delete this._refs[e],this;case"object":var r=this._opts.serialize,a=r?r(e):e;this._cache.del(a);var n=this._getId(e);n&&(n=s.normalizeId(n),delete this._schemas[n],delete this._refs[n])}return this},Ajv.prototype.addFormat=function addFormat(e,t){"string"==typeof t&&(t=new RegExp(t));return this._formats[e]=t,this},Ajv.prototype.errorsText=function errorsText(e,t){if(!(e=e||this.errors))return"No errors";for(var r=void 0===(t=t||{}).separator?", ":t.separator,a=void 0===t.dataVar?"data":t.dataVar,s="",n=0;n<e.length;n++){var i=e[n];i&&(s+=a+i.dataPath+" "+i.message+r)}return s.slice(0,-r.length)},Ajv.prototype._addSchema=function _addSchema(e,t,r,a){if("object"!=typeof e&&"boolean"!=typeof e)throw new Error("schema should be object or boolean");var n=this._opts.serialize,o=n?n(e):e,c=this._cache.get(o);if(c)return c;a=a||!1!==this._opts.addUsedSchema;var u=s.normalizeId(this._getId(e));u&&a&&checkUnique(this,u);var l,h=!1!==this._opts.validateSchema&&!t;h&&!(l=u&&u==s.normalizeId(e.$schema))&&this.validateSchema(e,!0);var d=s.ids.call(this,e),f=new i({id:u,schema:e,localRefs:d,cacheKey:o,meta:r});"#"!=u[0]&&a&&(this._refs[u]=f);this._cache.put(o,f),h&&l&&this.validateSchema(e,!0);return f},Ajv.prototype._compile=function _compile(e,t){if(e.compiling)return e.validate=callValidate,callValidate.schema=e.schema,callValidate.errors=null,callValidate.root=t||callValidate,!0===e.schema.$async&&(callValidate.$async=!0),callValidate;var r,s;e.compiling=!0,e.meta&&(r=this._opts,this._opts=this._metaOpts);try{s=a.call(this,e.schema,t,e.localRefs)}finally{e.compiling=!1,e.meta&&(this._opts=r)}return e.validate=s,e.refs=s.refs,e.refVal=s.refVal,e.root=s.root,s;function callValidate(){var t=e.validate,r=t.apply(null,arguments);return callValidate.errors=t.errors,r}},Ajv.prototype.compileAsync=r(74);var d=r(75);Ajv.prototype.addKeyword=d.add,Ajv.prototype.getKeyword=d.get,Ajv.prototype.removeKeyword=d.remove;var f=r(11);Ajv.ValidationError=f.Validation,Ajv.MissingRefError=f.MissingRef,Ajv.$dataMetaSchema=l;var p="http://json-schema.org/draft-07/schema",m=["removeAdditional","useDefaults","coerceTypes"],v=["/properties"];function Ajv(e){if(!(this instanceof Ajv))return new Ajv(e);e=this._opts=h.copy(e)||{},function setLogger(e){var t=e._opts.logger;if(!1===t)e.logger={log:noop,warn:noop,error:noop};else{if(void 0===t&&(t=console),!("object"==typeof t&&t.log&&t.warn&&t.error))throw new Error("logger must implement log, warn and error methods");e.logger=t}}(this),this._schemas={},this._refs={},this._fragments={},this._formats=c(e.format);var t=this._schemaUriFormat=this._formats["uri-reference"];this._schemaUriFormatFunc=function(e){return t.test(e)},this._cache=e.cache||new n,this._loadingSchemas={},this._compilations=[],this.RULES=u(),this._getId=function chooseGetId(e){switch(e.schemaId){case"auto":return _get$IdOrId;case"id":return _getId;default:return _get$Id}}(e),e.loopRequired=e.loopRequired||1/0,"property"==e.errorDataPath&&(e._errorDataPathProperty=!0),void 0===e.serialize&&(e.serialize=o),this._metaOpts=function getMetaSchemaOptions(e){for(var t=h.copy(e._opts),r=0;r<m.length;r++)delete t[m[r]];return t}(this),e.formats&&function addInitialFormats(e){for(var t in e._opts.formats){var r=e._opts.formats[t];e.addFormat(t,r)}}(this),function addDraft6MetaSchema(e){var t;e._opts.$data&&(t=r(77),e.addMetaSchema(t,t.$id,!0));if(!1===e._opts.meta)return;var a=r(78);e._opts.$data&&(a=l(a,v));e.addMetaSchema(a,p,!0),e._refs["http://json-schema.org/schema"]=p}(this),"object"==typeof e.meta&&this.addMetaSchema(e.meta),function addInitialSchemas(e){var t=e._opts.schemas;if(!t)return;if(Array.isArray(t))e.addSchema(t);else for(var r in t)e.addSchema(t[r],r)}(this)}function _getSchemaObj(e,t){return t=s.normalizeId(t),e._schemas[t]||e._refs[t]||e._fragments[t]}function _removeAllSchemas(e,t,r){for(var a in t){var s=t[a];s.meta||r&&!r.test(a)||(e._cache.del(s.cacheKey),delete t[a])}}function _getId(e){return e.$id&&this.logger.warn("schema $id ignored",e.$id),e.id}function _get$Id(e){return e.id&&this.logger.warn("schema id ignored",e.id),e.$id}function _get$IdOrId(e){if(e.$id&&e.id&&e.$id!=e.id)throw new Error("schema $id is different from id");return e.$id||e.id}function checkUnique(e,t){if(e._schemas[t]||e._refs[t])throw new Error('schema with key or id "'+t+'" already exists')}function noop(){}},function(e,t,r){"use strict";var a=r(9),s=r(2),n=r(11),i=r(17),o=r(18),c=s.ucs2length,u=r(10),l=n.Validation;function compIndex(e,t,r){for(var a=0;a<this._compilations.length;a++){var s=this._compilations[a];if(s.schema==e&&s.root==t&&s.baseId==r)return a}return-1}function patternCode(e,t){return"var pattern"+e+" = new RegExp("+s.toQuotedString(t[e])+");"}function defaultCode(e){return"var default"+e+" = defaults["+e+"];"}function refValCode(e,t){return void 0===t[e]?"":"var refVal"+e+" = refVal["+e+"];"}function customRuleCode(e){return"var customRule"+e+" = customRules["+e+"];"}function vars(e,t){if(!e.length)return"";for(var r="",a=0;a<e.length;a++)r+=t(a,e);return r}e.exports=function compile(e,t,r,h){var d=this,f=this._opts,p=[void 0],m={},v=[],g={},y=[],_={},P=[];t=t||{schema:e,refVal:p,refs:m};var S=function checkCompiling(e,t,r){var a=compIndex.call(this,e,t,r);return a>=0?{index:a,compiling:!0}:(a=this._compilations.length,this._compilations[a]={schema:e,root:t,baseId:r},{index:a,compiling:!1})}.call(this,e,t,h);var b=this._compilations[S.index];if(S.compiling)return b.callValidate=function callValidate(){var e=b.validate;var t=e.apply(null,arguments);callValidate.errors=e.errors;return t};var w=this._formats;var E=this.RULES;try{var I=localCompile(e,t,r,h);b.validate=I;var x=b.callValidate;return x&&(x.schema=I.schema,x.errors=null,x.refs=I.refs,x.refVal=I.refVal,x.root=I.root,x.$async=I.$async,f.sourceCode&&(x.source=I.source)),I}finally{(function endCompiling(e,t,r){var a=compIndex.call(this,e,t,r);a>=0&&this._compilations.splice(a,1)}).call(this,e,t,h)}function localCompile(e,r,i,h){var g=!r||r&&r.schema==e;if(r.schema!=t.schema)return compile.call(d,e,r,i,h);var _,S=!0===e.$async,b=o({isTop:!0,schema:e,isRoot:g,baseId:h,root:r,schemaPath:"",errSchemaPath:"#",errorPath:'""',MissingRefError:n.MissingRef,RULES:E,validate:o,util:s,resolve:a,resolveRef:resolveRef,usePattern:usePattern,useDefault:useDefault,useCustomRule:useCustomRule,opts:f,formats:w,logger:d.logger,self:d});b=vars(p,refValCode)+vars(v,patternCode)+vars(y,defaultCode)+vars(P,customRuleCode)+b,f.processCode&&(b=f.processCode(b));try{var I=new Function("self","RULES","formats","root","refVal","defaults","customRules","equal","ucs2length","ValidationError",b);_=I(d,E,w,t,p,y,P,u,c,l),p[0]=_}catch(e){throw d.logger.error("Error compiling schema, function code:",b),e}return _.schema=e,_.errors=null,_.refs=m,_.refVal=p,_.root=g?_:r,S&&(_.$async=!0),!0===f.sourceCode&&(_.source={code:b,patterns:v,defaults:y}),_}function resolveRef(e,s,n){s=a.url(e,s);var i,o,c=m[s];if(void 0!==c)return resolvedRef(i=p[c],o="refVal["+c+"]");if(!n&&t.refs){var u=t.refs[s];if(void 0!==u)return i=t.refVal[u],o=addLocalRef(s,i),resolvedRef(i,o)}o=addLocalRef(s);var l=a.call(d,localCompile,t,s);if(void 0===l){var h=r&&r[s];h&&(l=a.inlineRef(h,f.inlineRefs)?h:compile.call(d,h,t,r,e))}if(void 0!==l)return function replaceLocalRef(e,t){var r=m[e];p[r]=t}(s,l),resolvedRef(l,o);!function removeLocalRef(e){delete m[e]}(s)}function addLocalRef(e,t){var r=p.length;return p[r]=t,m[e]=r,"refVal"+r}function resolvedRef(e,t){return"object"==typeof e||"boolean"==typeof e?{code:t,schema:e,inline:!0}:{code:t,$async:e&&!!e.$async}}function usePattern(e){var t=g[e];return void 0===t&&(t=g[e]=v.length,v[t]=e),"pattern"+t}function useDefault(e){switch(typeof e){case"boolean":case"number":return""+e;case"string":return s.toQuotedString(e);case"object":if(null===e)return"null";var t=i(e),r=_[t];return void 0===r&&(r=_[t]=y.length,y[r]=e),"default"+r}}function useCustomRule(e,t,r,a){var s=e.definition.validateSchema;if(s&&!1!==d._opts.validateSchema){var n=s(t);if(!n){var i="keyword schema is invalid: "+d.errorsText(s.errors);if("log"!=d._opts.validateSchema)throw new Error(i);d.logger.error(i)}}var o,c=e.definition.compile,u=e.definition.inline,l=e.definition.macro;if(c)o=c.call(d,t,r,a);else if(l)o=l.call(d,t,r,a),!1!==f.validateSchema&&d.validateSchema(o,!0);else if(u)o=u.call(d,a,e.keyword,t,r);else if(!(o=e.definition.validate))return;if(void 0===o)throw new Error('custom keyword "'+e.keyword+'"failed to compile');var h=P.length;return P[h]=o,{code:"customRule"+h,validate:o}}}},function(e,t,r){"use strict";var a=r(42),s=r(44);function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=urlParse,t.resolve=function urlResolve(e,t){return urlParse(e,!1,!0).resolve(t)},t.resolveObject=function urlResolveObject(e,t){return e?urlParse(e,!1,!0).resolveObject(t):t},t.format=function urlFormat(e){s.isString(e)&&(e=urlParse(e));return e instanceof Url?e.format():Url.prototype.format.call(e)},t.Url=Url;var n=/^([a-z0-9.+-]+:)/i,i=/:[0-9]*$/,o=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(c),l=["%","/","?",";","#"].concat(u),h=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,p={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=r(45);function urlParse(e,t,r){if(e&&s.isObject(e)&&e instanceof Url)return e;var a=new Url;return a.parse(e,t,r),a}Url.prototype.parse=function(e,t,r){if(!s.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),c=-1!==i&&i<e.indexOf("#")?"?":"#",y=e.split(c);y[0]=y[0].replace(/\\/g,"/");var _=e=y.join(c);if(_=_.trim(),!r&&1===e.split("#").length){var P=o.exec(_);if(P)return this.path=_,this.href=_,this.pathname=P[1],P[2]?(this.search=P[2],this.query=t?g.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var S=n.exec(_);if(S){var b=(S=S[0]).toLowerCase();this.protocol=b,_=_.substr(S.length)}if(r||S||_.match(/^\/\/[^@\/]+@[^@\/]+/)){var w="//"===_.substr(0,2);!w||S&&m[S]||(_=_.substr(2),this.slashes=!0)}if(!m[S]&&(w||S&&!v[S])){for(var E,I,x=-1,M=0;M<h.length;M++){-1!==(D=_.indexOf(h[M]))&&(-1===x||D<x)&&(x=D)}-1!==(I=-1===x?_.lastIndexOf("@"):_.lastIndexOf("@",x))&&(E=_.slice(0,I),_=_.slice(I+1),this.auth=decodeURIComponent(E)),x=-1;for(M=0;M<l.length;M++){var D;-1!==(D=_.indexOf(l[M]))&&(-1===x||D<x)&&(x=D)}-1===x&&(x=_.length),this.host=_.slice(0,x),_=_.slice(x),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var L=this.hostname.split(/\./),O=(M=0,L.length);M<O;M++){var R=L[M];if(R&&!R.match(d)){for(var T="",A=0,B=R.length;A<B;A++)R.charCodeAt(A)>127?T+="x":T+=R[A];if(!T.match(d)){var j=L.slice(0,M),$=L.slice(M+1),k=R.match(f);k&&(j.push(k[1]),$.unshift(k[2])),$.length&&(_="/"+$.join(".")+_),this.hostname=j.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=a.toASCII(this.hostname));var F=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+F,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==_[0]&&(_="/"+_))}if(!p[b])for(M=0,O=u.length;M<O;M++){var U=u[M];if(-1!==_.indexOf(U)){var N=encodeURIComponent(U);N===U&&(N=escape(U)),_=_.split(U).join(N)}}var q=_.indexOf("#");-1!==q&&(this.hash=_.substr(q),_=_.slice(0,q));var z=_.indexOf("?");if(-1!==z?(this.search=_.substr(z),this.query=_.substr(z+1),t&&(this.query=g.parse(this.query)),_=_.slice(0,z)):t&&(this.search="",this.query={}),_&&(this.pathname=_),v[b]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){F=this.pathname||"";var W=this.search||"";this.path=F+W}return this.href=this.format(),this},Url.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",a=this.hash||"",n=!1,i="";this.host?n=e+this.host:this.hostname&&(n=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&s.isObject(this.query)&&Object.keys(this.query).length&&(i=g.stringify(this.query));var o=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||v[t])&&!1!==n?(n="//"+(n||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):n||(n=""),a&&"#"!==a.charAt(0)&&(a="#"+a),o&&"?"!==o.charAt(0)&&(o="?"+o),t+n+(r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}))+(o=o.replace("#","%23"))+a},Url.prototype.resolve=function(e){return this.resolveObject(urlParse(e,!1,!0)).format()},Url.prototype.resolveObject=function(e){if(s.isString(e)){var t=new Url;t.parse(e,!1,!0),e=t}for(var r=new Url,a=Object.keys(this),n=0;n<a.length;n++){var i=a[n];r[i]=this[i]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),c=0;c<o.length;c++){var u=o[c];"protocol"!==u&&(r[u]=e[u])}return v[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!v[e.protocol]){for(var l=Object.keys(e),h=0;h<l.length;h++){var d=l[h];r[d]=e[d]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||m[e.protocol])r.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var p=r.pathname||"",g=r.search||"";r.path=p+g}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var y=r.pathname&&"/"===r.pathname.charAt(0),_=e.host||e.pathname&&"/"===e.pathname.charAt(0),P=_||y||r.host&&e.pathname,S=P,b=r.pathname&&r.pathname.split("/")||[],w=(f=e.pathname&&e.pathname.split("/")||[],r.protocol&&!v[r.protocol]);if(w&&(r.hostname="",r.port=null,r.host&&(""===b[0]?b[0]=r.host:b.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),P=P&&(""===f[0]||""===b[0])),_)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,b=f;else if(f.length)b||(b=[]),b.pop(),b=b.concat(f),r.search=e.search,r.query=e.query;else if(!s.isNullOrUndefined(e.search)){if(w)r.hostname=r.host=b.shift(),(D=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=D.shift(),r.host=r.hostname=D.shift());return r.search=e.search,r.query=e.query,s.isNull(r.pathname)&&s.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!b.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var E=b.slice(-1)[0],I=(r.host||e.host||b.length>1)&&("."===E||".."===E)||""===E,x=0,M=b.length;M>=0;M--)"."===(E=b[M])?b.splice(M,1):".."===E?(b.splice(M,1),x++):x&&(b.splice(M,1),x--);if(!P&&!S)for(;x--;x)b.unshift("..");!P||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),I&&"/"!==b.join("/").substr(-1)&&b.push("");var D,C=""===b[0]||b[0]&&"/"===b[0].charAt(0);w&&(r.hostname=r.host=C?"":b.length?b.shift():"",(D=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=D.shift(),r.host=r.hostname=D.shift()));return(P=P||r.host&&b.length)&&!C&&b.unshift(""),b.length?r.pathname=b.join("/"):(r.pathname=null,r.path=null),s.isNull(r.pathname)&&s.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},Url.prototype.parseHost=function(){var e=this.host,t=i.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){(function(e,a){var s;!function(n){"object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType;var i="object"==typeof a&&a;i.global!==i&&i.window!==i&&i.self;var o,c=2147483647,u=36,l=1,h=26,d=38,f=700,p=72,m=128,v="-",g=/^xn--/,y=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,P={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},S=u-l,b=Math.floor,w=String.fromCharCode;function error(e){throw new RangeError(P[e])}function map(e,t){for(var r=e.length,a=[];r--;)a[r]=t(e[r]);return a}function mapDomain(e,t){var r=e.split("@"),a="";return r.length>1&&(a=r[0]+"@",e=r[1]),a+map((e=e.replace(_,".")).split("."),t).join(".")}function ucs2decode(e){for(var t,r,a=[],s=0,n=e.length;s<n;)(t=e.charCodeAt(s++))>=55296&&t<=56319&&s<n?56320==(64512&(r=e.charCodeAt(s++)))?a.push(((1023&t)<<10)+(1023&r)+65536):(a.push(t),s--):a.push(t);return a}function ucs2encode(e){return map(e,function(e){var t="";return e>65535&&(t+=w((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=w(e)}).join("")}function digitToBasic(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function adapt(e,t,r){var a=0;for(e=r?b(e/f):e>>1,e+=b(e/t);e>S*h>>1;a+=u)e=b(e/S);return b(a+(S+1)*e/(e+d))}function decode(e){var t,r,a,s,n,i,o,d,f,g,y,_=[],P=e.length,S=0,w=m,E=p;for((r=e.lastIndexOf(v))<0&&(r=0),a=0;a<r;++a)e.charCodeAt(a)>=128&&error("not-basic"),_.push(e.charCodeAt(a));for(s=r>0?r+1:0;s<P;){for(n=S,i=1,o=u;s>=P&&error("invalid-input"),((d=(y=e.charCodeAt(s++))-48<10?y-22:y-65<26?y-65:y-97<26?y-97:u)>=u||d>b((c-S)/i))&&error("overflow"),S+=d*i,!(d<(f=o<=E?l:o>=E+h?h:o-E));o+=u)i>b(c/(g=u-f))&&error("overflow"),i*=g;E=adapt(S-n,t=_.length+1,0==n),b(S/t)>c-w&&error("overflow"),w+=b(S/t),S%=t,_.splice(S++,0,w)}return ucs2encode(_)}function encode(e){var t,r,a,s,n,i,o,d,f,g,y,_,P,S,E,I=[];for(_=(e=ucs2decode(e)).length,t=m,r=0,n=p,i=0;i<_;++i)(y=e[i])<128&&I.push(w(y));for(a=s=I.length,s&&I.push(v);a<_;){for(o=c,i=0;i<_;++i)(y=e[i])>=t&&y<o&&(o=y);for(o-t>b((c-r)/(P=a+1))&&error("overflow"),r+=(o-t)*P,t=o,i=0;i<_;++i)if((y=e[i])<t&&++r>c&&error("overflow"),y==t){for(d=r,f=u;!(d<(g=f<=n?l:f>=n+h?h:f-n));f+=u)E=d-g,S=u-g,I.push(w(digitToBasic(g+E%S,0))),d=b(E/S);I.push(w(digitToBasic(d,0))),n=adapt(r,P,a==s),r=0,++a}++r,++t}return I.join("")}o={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:function toASCII(e){return mapDomain(e,function(e){return y.test(e)?"xn--"+encode(e):e})},toUnicode:function toUnicode(e){return mapDomain(e,function(e){return g.test(e)?decode(e.slice(4).toLowerCase()):e})}},void 0===(s=function(){return o}.call(t,r,t,e))||(e.exports=s)}()}).call(t,r(43)(e),r(8))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,r){"use strict";t.decode=t.parse=r(46),t.encode=t.stringify=r(47)},function(e,t,r){"use strict";e.exports=function(e,t,r,s){t=t||"&",r=r||"=";var n={};if("string"!=typeof e||0===e.length)return n;var i=/\+/g;e=e.split(t);var o=1e3;s&&"number"==typeof s.maxKeys&&(o=s.maxKeys);var c,u,l=e.length;o>0&&l>o&&(l=o);for(var h=0;h<l;++h){var d,f,p,m,v=e[h].replace(i,"%20"),g=v.indexOf(r);g>=0?(d=v.substr(0,g),f=v.substr(g+1)):(d=v,f=""),p=decodeURIComponent(d),m=decodeURIComponent(f),c=n,u=p,Object.prototype.hasOwnProperty.call(c,u)?a(n[p])?n[p].push(m):n[p]=[n[p],m]:n[p]=m}return n};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,r){"use strict";var a=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,i){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?map(n(e),function(n){var i=encodeURIComponent(a(n))+r;return s(e[n])?map(e[n],function(e){return i+encodeURIComponent(a(e))}).join(t):i+encodeURIComponent(a(e[n]))}).join(t):i?encodeURIComponent(a(i))+r+encodeURIComponent(a(e)):""};var s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function map(e,t){if(e.map)return e.map(t);for(var r=[],a=0;a<e.length;a++)r.push(t(e[a],a));return r}var n=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},function(e,t,r){"use strict";e.exports=function ucs2length(e){for(var t,r=0,a=e.length,s=0;s<a;)r++,(t=e.charCodeAt(s++))>=55296&&t<=56319&&s<a&&56320==(64512&(t=e.charCodeAt(s)))&&s++;return r}},function(e,t,r){"use strict";var a=e.exports=function(e,t,r){"function"==typeof t&&(r=t,t={}),function _traverse(e,t,r,s,n,i,o,c,u){if(r&&"object"==typeof r&&!Array.isArray(r)){t(r,s,n,i,o,c,u);for(var l in r){var h=r[l];if(Array.isArray(h)){if(l in a.arrayKeywords)for(var d=0;d<h.length;d++)_traverse(e,t,h[d],s+"/"+l+"/"+d,n,s,l,r,d)}else if(l in a.propsKeywords){if(h&&"object"==typeof h)for(var f in h)_traverse(e,t,h[f],s+"/"+l+"/"+(p=f,p.replace(/~/g,"~0").replace(/\//g,"~1")),n,s,l,r,f)}else(l in a.keywords||e.allKeys&&!(l in a.skipKeywords))&&_traverse(e,t,h,s+"/"+l,n,s,l,r)}}var p}(t,r,e,"",e)};a.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0},a.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},a.propsKeywords={definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},a.skipKeywords={enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},function(e,t,r){"use strict";var a=e.exports=function Cache(){this._cache={}};a.prototype.put=function Cache_put(e,t){this._cache[e]=t},a.prototype.get=function Cache_get(e){return this._cache[e]},a.prototype.del=function Cache_del(e){delete this._cache[e]},a.prototype.clear=function Cache_clear(){this._cache={}}},function(e,t,r){"use strict";var a=r(2),s=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,n=[0,31,28,31,30,31,30,31,31,30,31,30,31],i=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d:\d\d)?$/i,o=/^[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*$/i,c=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,u=/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,l=/^(?:(?:http[s\u017F]?|ftp):\/\/)(?:(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+(?::(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?@)?(?:(?!10(?:\.[0-9]{1,3}){3})(?!127(?:\.[0-9]{1,3}){3})(?!169\.254(?:\.[0-9]{1,3}){2})(?!192\.168(?:\.[0-9]{1,3}){2})(?!172\.(?:1[6-9]|2[0-9]|3[01])(?:\.[0-9]{1,3}){2})(?:[1-9][0-9]?|1[0-9][0-9]|2[01][0-9]|22[0-3])(?:\.(?:1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}(?:\.(?:[1-9][0-9]?|1[0-9][0-9]|2[0-4][0-9]|25[0-4]))|(?:(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)(?:\.(?:(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+-?)*(?:[0-9KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+)*(?:\.(?:(?:[KSa-z\xA1-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]){2,})))(?::[0-9]{2,5})?(?:\/(?:[\0-\x08\x0E-\x1F!-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*)?$/i,h=/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,d=/^(?:\/(?:[^~/]|~0|~1)*)*$/,f=/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,p=/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/;function formats(e){return e="full"==e?"full":"fast",a.copy(formats[e])}function date(e){var t=e.match(s);if(!t)return!1;var r=+t[1],a=+t[2],i=+t[3];return a>=1&&a<=12&&i>=1&&i<=(2==a&&function isLeapYear(e){return e%4==0&&(e%100!=0||e%400==0)}(r)?29:n[a])}function time(e,t){var r=e.match(i);if(!r)return!1;var a=r[1],s=r[2],n=r[3],o=r[5];return(a<=23&&s<=59&&n<=59||23==a&&59==s&&60==n)&&(!t||o)}e.exports=formats,formats.fast={date:/^\d\d\d\d-[0-1]\d-[0-3]\d$/,time:/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d:\d\d)?$/i,"date-time":/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d:\d\d)$/i,uri:/^(?:[a-z][a-z0-9+-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,"uri-template":u,url:l,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i,hostname:o,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:regex,uuid:h,"json-pointer":d,"json-pointer-uri-fragment":f,"relative-json-pointer":p},formats.full={date:date,time:time,"date-time":function date_time(e){var t=e.split(m);return 2==t.length&&date(t[0])&&time(t[1],!0)},uri:function uri(e){return v.test(e)&&c.test(e)},"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":u,url:l,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&''*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:function hostname(e){return e.length<=255&&o.test(e)},ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^\s*(?:(?:(?:[0-9a-f]{1,4}:){7}(?:[0-9a-f]{1,4}|:))|(?:(?:[0-9a-f]{1,4}:){6}(?::[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){5}(?:(?:(?::[0-9a-f]{1,4}){1,2})|:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(?:(?:[0-9a-f]{1,4}:){4}(?:(?:(?::[0-9a-f]{1,4}){1,3})|(?:(?::[0-9a-f]{1,4})?:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){3}(?:(?:(?::[0-9a-f]{1,4}){1,4})|(?:(?::[0-9a-f]{1,4}){0,2}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){2}(?:(?:(?::[0-9a-f]{1,4}){1,5})|(?:(?::[0-9a-f]{1,4}){0,3}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?:(?:[0-9a-f]{1,4}:){1}(?:(?:(?::[0-9a-f]{1,4}){1,6})|(?:(?::[0-9a-f]{1,4}){0,4}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(?::(?:(?:(?::[0-9a-f]{1,4}){1,7})|(?:(?::[0-9a-f]{1,4}){0,5}:(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(?:\.(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(?:%.+)?\s*$/i,regex:regex,uuid:h,"json-pointer":d,"json-pointer-uri-fragment":f,"relative-json-pointer":p};var m=/t|\s/i;var v=/\/|:/;var g=/[^\\]\\Z/;function regex(e){if(g.test(e))return!1;try{return new RegExp(e),!0}catch(e){return!1}}},function(e,t,r){"use strict";var a=r(53),s=r(2).toHash;e.exports=function rules(){var e=[{type:"number",rules:[{maximum:["exclusiveMaximum"]},{minimum:["exclusiveMinimum"]},"multipleOf","format"]},{type:"string",rules:["maxLength","minLength","pattern","format"]},{type:"array",rules:["maxItems","minItems","items","contains","uniqueItems"]},{type:"object",rules:["maxProperties","minProperties","required","dependencies","propertyNames",{properties:["additionalProperties","patternProperties"]}]},{rules:["$ref","const","enum","not","anyOf","oneOf","allOf","if"]}],t=["type","$comment"];return e.all=s(t),e.types=s(["number","integer","string","array","object","boolean","null"]),e.forEach(function(r){r.rules=r.rules.map(function(r){var s;if("object"==typeof r){var n=Object.keys(r)[0];s=r[n],r=n,s.forEach(function(r){t.push(r),e.all[r]=!0})}return t.push(r),e.all[r]={keyword:r,code:a[r],implements:s}}),e.all.$comment={keyword:"$comment",code:a.$comment},r.type&&(e.types[r.type]=r)}),e.keywords=s(t.concat(["$schema","$id","id","$data","title","description","default","definitions","examples","readOnly","writeOnly","contentMediaType","contentEncoding","additionalItems","then","else"])),e.custom={},e}},function(e,t,r){"use strict";e.exports={$ref:r(54),allOf:r(55),anyOf:r(56),$comment:r(57),const:r(58),contains:r(59),dependencies:r(60),enum:r(61),format:r(62),if:r(63),items:r(64),maximum:r(19),minimum:r(19),maxItems:r(20),minItems:r(20),maxLength:r(21),minLength:r(21),maxProperties:r(22),minProperties:r(22),multipleOf:r(65),not:r(66),oneOf:r(67),pattern:r(68),properties:r(69),propertyNames:r(70),required:r(71),uniqueItems:r(72),validate:r(18)}},function(e,t,r){"use strict";e.exports=function generate_ref(e,t,r){var a,s,n=" ",i=e.level,o=e.dataLevel,c=e.schema[t],u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,h="data"+(o||""),d="valid"+i;if("#"==c||"#/"==c)e.isRoot?(a=e.async,s="validate"):(a=!0===e.root.schema.$async,s="root.refVal[0]");else{var f=e.resolveRef(e.baseId,c,e.isRoot);if(void 0===f){var p=e.MissingRefError.message(e.baseId,c);if("fail"==e.opts.missingRefs){e.logger.error(p),(y=y||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: '$ref' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { ref: '"+e.util.escapeQuotes(c)+"' } ",!1!==e.opts.messages&&(n+=" , message: 'can\\'t resolve reference "+e.util.escapeQuotes(c)+"' "),e.opts.verbose&&(n+=" , schema: "+e.util.toQuotedString(c)+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),n+=" } "):n+=" {} ";var m=n;n=y.pop(),!e.compositeRule&&l?e.async?n+=" throw new ValidationError(["+m+"]); ":n+=" validate.errors = ["+m+"]; return false; ":n+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",l&&(n+=" if (false) { ")}else{if("ignore"!=e.opts.missingRefs)throw new e.MissingRefError(e.baseId,c,p);e.logger.warn(p),l&&(n+=" if (true) { ")}}else if(f.inline){var v=e.util.copy(e);v.level++;var g="valid"+v.level;v.schema=f.schema,v.schemaPath="",v.errSchemaPath=c,n+=" "+e.validate(v).replace(/validate\.schema/g,f.code)+" ",l&&(n+=" if ("+g+") { ")}else a=!0===f.$async||e.async&&!1!==f.$async,s=f.code}if(s){var y;(y=y||[]).push(n),n="",e.opts.passContext?n+=" "+s+".call(this, ":n+=" "+s+"( ",n+=" "+h+", (dataPath || '')",'""'!=e.errorPath&&(n+=" + "+e.errorPath);var _=n+=" , "+(o?"data"+(o-1||""):"parentData")+" , "+(o?e.dataPathArr[o]:"parentDataProperty")+", rootData)  ";if(n=y.pop(),a){if(!e.async)throw new Error("async schema referenced by sync schema");l&&(n+=" var "+d+"; "),n+=" try { await "+_+"; ",l&&(n+=" "+d+" = true; "),n+=" } catch (e) { if (!(e instanceof ValidationError)) throw e; if (vErrors === null) vErrors = e.errors; else vErrors = vErrors.concat(e.errors); errors = vErrors.length; ",l&&(n+=" "+d+" = false; "),n+=" } ",l&&(n+=" if ("+d+") { ")}else n+=" if (!"+_+") { if (vErrors === null) vErrors = "+s+".errors; else vErrors = vErrors.concat("+s+".errors); errors = vErrors.length; } ",l&&(n+=" else { ")}return n}},function(e,t,r){"use strict";e.exports=function generate_allOf(e,t,r){var a=" ",s=e.schema[t],n=e.schemaPath+e.util.getProperty(t),i=e.errSchemaPath+"/"+t,o=!e.opts.allErrors,c=e.util.copy(e),u="";c.level++;var l="valid"+c.level,h=c.baseId,d=!0,f=s;if(f)for(var p,m=-1,v=f.length-1;m<v;)p=f[m+=1],e.util.schemaHasRules(p,e.RULES.all)&&(d=!1,c.schema=p,c.schemaPath=n+"["+m+"]",c.errSchemaPath=i+"/"+m,a+="  "+e.validate(c)+" ",c.baseId=h,o&&(a+=" if ("+l+") { ",u+="}"));return o&&(a+=d?" if (true) { ":" "+u.slice(0,-1)+" "),a=e.util.cleanUpCode(a)}},function(e,t,r){"use strict";e.exports=function generate_anyOf(e,t,r){var a=" ",s=e.level,n=e.dataLevel,i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,l="data"+(n||""),h="valid"+s,d="errs__"+s,f=e.util.copy(e),p="";f.level++;var m="valid"+f.level;if(i.every(function(t){return e.util.schemaHasRules(t,e.RULES.all)})){var v=f.baseId;a+=" var "+d+" = errors; var "+h+" = false;  ";var g=e.compositeRule;e.compositeRule=f.compositeRule=!0;var y=i;if(y)for(var _,P=-1,S=y.length-1;P<S;)_=y[P+=1],f.schema=_,f.schemaPath=o+"["+P+"]",f.errSchemaPath=c+"/"+P,a+="  "+e.validate(f)+" ",f.baseId=v,a+=" "+h+" = "+h+" || "+m+"; if (!"+h+") { ",p+="}";e.compositeRule=f.compositeRule=g,a+=" "+p+" if (!"+h+") {   var err =   ",!1!==e.createErrors?(a+=" { keyword: 'anyOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'should match some schema in anyOf' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; "),a+=" } else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } ",e.opts.allErrors&&(a+=" } "),a=e.util.cleanUpCode(a)}else u&&(a+=" if (true) { ");return a}},function(e,t,r){"use strict";e.exports=function generate_comment(e,t,r){var a=" ",s=e.schema[t],n=e.errSchemaPath+"/"+t,i=(e.opts.allErrors,e.util.toQuotedString(s));return!0===e.opts.$comment?a+=" console.log("+i+");":"function"==typeof e.opts.$comment&&(a+=" self._opts.$comment("+i+", "+e.util.toQuotedString(n)+", validate.root.schema);"),a}},function(e,t,r){"use strict";e.exports=function generate_const(e,t,r){var a=" ",s=e.level,n=e.dataLevel,i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,l="data"+(n||""),h="valid"+s,d=e.opts.$data&&i&&i.$data;d&&(a+=" var schema"+s+" = "+e.util.getData(i.$data,n,e.dataPathArr)+"; "),d||(a+=" var schema"+s+" = validate.schema"+o+";"),a+="var "+h+" = equal("+l+", schema"+s+"); if (!"+h+") {   ";var f=f||[];f.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'const' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'should be equal to constant' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ";var p=a;return a=f.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+p+"]); ":a+=" validate.errors = ["+p+"]; return false; ":a+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" }",u&&(a+=" else { "),a}},function(e,t,r){"use strict";e.exports=function generate_contains(e,t,r){var a=" ",s=e.level,n=e.dataLevel,i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,l="data"+(n||""),h="valid"+s,d="errs__"+s,f=e.util.copy(e);f.level++;var p="valid"+f.level,m="i"+s,v=f.dataLevel=e.dataLevel+1,g="data"+v,y=e.baseId,_=e.util.schemaHasRules(i,e.RULES.all);if(a+="var "+d+" = errors;var "+h+";",_){var P=e.compositeRule;e.compositeRule=f.compositeRule=!0,f.schema=i,f.schemaPath=o,f.errSchemaPath=c,a+=" var "+p+" = false; for (var "+m+" = 0; "+m+" < "+l+".length; "+m+"++) { ",f.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers,!0);var S=l+"["+m+"]";f.dataPathArr[v]=m;var b=e.validate(f);f.baseId=y,e.util.varOccurences(b,g)<2?a+=" "+e.util.varReplace(b,g,S)+" ":a+=" var "+g+" = "+S+"; "+b+" ",a+=" if ("+p+") break; }  ",e.compositeRule=f.compositeRule=P,a+="  if (!"+p+") {"}else a+=" if ("+l+".length == 0) {";var w=w||[];w.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'contains' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'should contain a valid item' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ";var E=a;return a=w.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+E+"]); ":a+=" validate.errors = ["+E+"]; return false; ":a+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else { ",_&&(a+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; } "),e.opts.allErrors&&(a+=" } "),a=e.util.cleanUpCode(a)}},function(e,t,r){"use strict";e.exports=function generate_dependencies(e,t,r){var a=" ",s=e.level,n=e.dataLevel,i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,l="data"+(n||""),h="errs__"+s,d=e.util.copy(e),f="";d.level++;var p="valid"+d.level,m={},v={},g=e.opts.ownProperties;for(S in i){var y=i[S],_=Array.isArray(y)?v:m;_[S]=y}a+="var "+h+" = errors;";var P=e.errorPath;a+="var missing"+s+";";for(var S in v)if((_=v[S]).length){if(a+=" if ( "+l+e.util.getProperty(S)+" !== undefined ",g&&(a+=" && Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(S)+"') "),u){a+=" && ( ";var b=_;if(b)for(var w=-1,E=b.length-1;w<E;){L=b[w+=1],w&&(a+=" || "),a+=" ( ( "+(A=l+(T=e.util.getProperty(L)))+" === undefined ",g&&(a+=" || ! Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(L)+"') "),a+=") && (missing"+s+" = "+e.util.toQuotedString(e.opts.jsonPointers?L:T)+") ) "}a+=")) {  ";var I="missing"+s,x="' + "+I+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(P,I,!0):P+" + "+I);var M=M||[];M.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(S)+"', missingProperty: '"+x+"', depsCount: "+_.length+", deps: '"+e.util.escapeQuotes(1==_.length?_[0]:_.join(", "))+"' } ",!1!==e.opts.messages&&(a+=" , message: 'should have ",1==_.length?a+="property "+e.util.escapeQuotes(_[0]):a+="properties "+e.util.escapeQuotes(_.join(", ")),a+=" when property "+e.util.escapeQuotes(S)+" is present' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ";var D=a;a=M.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+D+"]); ":a+=" validate.errors = ["+D+"]; return false; ":a+=" var err = "+D+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; "}else{a+=" ) { ";var C=_;if(C)for(var L,O=-1,R=C.length-1;O<R;){L=C[O+=1];var T=e.util.getProperty(L),A=(x=e.util.escapeQuotes(L),l+T);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(P,L,e.opts.jsonPointers)),a+=" if ( "+A+" === undefined ",g&&(a+=" || ! Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(L)+"') "),a+=") {  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'dependencies' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { property: '"+e.util.escapeQuotes(S)+"', missingProperty: '"+x+"', depsCount: "+_.length+", deps: '"+e.util.escapeQuotes(1==_.length?_[0]:_.join(", "))+"' } ",!1!==e.opts.messages&&(a+=" , message: 'should have ",1==_.length?a+="property "+e.util.escapeQuotes(_[0]):a+="properties "+e.util.escapeQuotes(_.join(", ")),a+=" when property "+e.util.escapeQuotes(S)+" is present' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}a+=" }   ",u&&(f+="}",a+=" else { ")}e.errorPath=P;var B=d.baseId;for(var S in m){y=m[S];e.util.schemaHasRules(y,e.RULES.all)&&(a+=" "+p+" = true; if ( "+l+e.util.getProperty(S)+" !== undefined ",g&&(a+=" && Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(S)+"') "),a+=") { ",d.schema=y,d.schemaPath=o+e.util.getProperty(S),d.errSchemaPath=c+"/"+e.util.escapeFragment(S),a+="  "+e.validate(d)+" ",d.baseId=B,a+=" }  ",u&&(a+=" if ("+p+") { ",f+="}"))}return u&&(a+="   "+f+" if ("+h+" == errors) {"),a=e.util.cleanUpCode(a)}},function(e,t,r){"use strict";e.exports=function generate_enum(e,t,r){var a=" ",s=e.level,n=e.dataLevel,i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,l="data"+(n||""),h="valid"+s,d=e.opts.$data&&i&&i.$data;d&&(a+=" var schema"+s+" = "+e.util.getData(i.$data,n,e.dataPathArr)+"; ");var f="i"+s,p="schema"+s;d||(a+=" var "+p+" = validate.schema"+o+";"),a+="var "+h+";",d&&(a+=" if (schema"+s+" === undefined) "+h+" = true; else if (!Array.isArray(schema"+s+")) "+h+" = false; else {"),a+=h+" = false;for (var "+f+"=0; "+f+"<"+p+".length; "+f+"++) if (equal("+l+", "+p+"["+f+"])) { "+h+" = true; break; }",d&&(a+="  }  "),a+=" if (!"+h+") {   ";var m=m||[];m.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'enum' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { allowedValues: schema"+s+" } ",!1!==e.opts.messages&&(a+=" , message: 'should be equal to one of the allowed values' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ";var v=a;return a=m.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+v+"]); ":a+=" validate.errors = ["+v+"]; return false; ":a+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" }",u&&(a+=" else { "),a}},function(e,t,r){"use strict";e.exports=function generate_format(e,t,r){var a=" ",s=e.level,n=e.dataLevel,i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,l="data"+(n||"");if(!1===e.opts.format)return u&&(a+=" if (true) { "),a;var h,d=e.opts.$data&&i&&i.$data;d?(a+=" var schema"+s+" = "+e.util.getData(i.$data,n,e.dataPathArr)+"; ",h="schema"+s):h=i;var f=e.opts.unknownFormats,p=Array.isArray(f);if(d){a+=" var "+(m="format"+s)+" = formats["+h+"]; var "+(v="isObject"+s)+" = typeof "+m+" == 'object' && !("+m+" instanceof RegExp) && "+m+".validate; var "+(g="formatType"+s)+" = "+v+" && "+m+".type || 'string'; if ("+v+") { ",e.async&&(a+=" var async"+s+" = "+m+".async; "),a+=" "+m+" = "+m+".validate; } if (  ",d&&(a+=" ("+h+" !== undefined && typeof "+h+" != 'string') || "),a+=" (","ignore"!=f&&(a+=" ("+h+" && !"+m+" ",p&&(a+=" && self._opts.unknownFormats.indexOf("+h+") == -1 "),a+=") || "),a+=" ("+m+" && "+g+" == '"+r+"' && !(typeof "+m+" == 'function' ? ",e.async?a+=" (async"+s+" ? await "+m+"("+l+") : "+m+"("+l+")) ":a+=" "+m+"("+l+") ",a+=" : "+m+".test("+l+"))))) {"}else{var m;if(!(m=e.formats[i])){if("ignore"==f)return e.logger.warn('unknown format "'+i+'" ignored in schema at path "'+e.errSchemaPath+'"'),u&&(a+=" if (true) { "),a;if(p&&f.indexOf(i)>=0)return u&&(a+=" if (true) { "),a;throw new Error('unknown format "'+i+'" is used in schema at path "'+e.errSchemaPath+'"')}var v,g=(v="object"==typeof m&&!(m instanceof RegExp)&&m.validate)&&m.type||"string";if(v){var y=!0===m.async;m=m.validate}if(g!=r)return u&&(a+=" if (true) { "),a;if(y){if(!e.async)throw new Error("async format in sync schema");a+=" if (!(await "+(_="formats"+e.util.getProperty(i)+".validate")+"("+l+"))) { "}else{a+=" if (! ";var _="formats"+e.util.getProperty(i);v&&(_+=".validate"),a+="function"==typeof m?" "+_+"("+l+") ":" "+_+".test("+l+") ",a+=") { "}}var P=P||[];P.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'format' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { format:  ",a+=d?""+h:""+e.util.toQuotedString(i),a+="  } ",!1!==e.opts.messages&&(a+=" , message: 'should match format \"",a+=d?"' + "+h+" + '":""+e.util.escapeQuotes(i),a+="\"' "),e.opts.verbose&&(a+=" , schema:  ",a+=d?"validate.schema"+o:""+e.util.toQuotedString(i),a+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ";var S=a;return a=P.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+S+"]); ":a+=" validate.errors = ["+S+"]; return false; ":a+=" var err = "+S+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } ",u&&(a+=" else { "),a}},function(e,t,r){"use strict";e.exports=function generate_if(e,t,r){var a=" ",s=e.level,n=e.dataLevel,i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,l="data"+(n||""),h="valid"+s,d="errs__"+s,f=e.util.copy(e);f.level++;var p="valid"+f.level,m=e.schema.then,v=e.schema.else,g=void 0!==m&&e.util.schemaHasRules(m,e.RULES.all),y=void 0!==v&&e.util.schemaHasRules(v,e.RULES.all),_=f.baseId;if(g||y){var P;f.createErrors=!1,f.schema=i,f.schemaPath=o,f.errSchemaPath=c,a+=" var "+d+" = errors; var "+h+" = true;  ";var S=e.compositeRule;e.compositeRule=f.compositeRule=!0,a+="  "+e.validate(f)+" ",f.baseId=_,f.createErrors=!0,a+="  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }  ",e.compositeRule=f.compositeRule=S,g?(a+=" if ("+p+") {  ",f.schema=e.schema.then,f.schemaPath=e.schemaPath+".then",f.errSchemaPath=e.errSchemaPath+"/then",a+="  "+e.validate(f)+" ",f.baseId=_,a+=" "+h+" = "+p+"; ",g&&y?a+=" var "+(P="ifClause"+s)+" = 'then'; ":P="'then'",a+=" } ",y&&(a+=" else { ")):a+=" if (!"+p+") { ",y&&(f.schema=e.schema.else,f.schemaPath=e.schemaPath+".else",f.errSchemaPath=e.errSchemaPath+"/else",a+="  "+e.validate(f)+" ",f.baseId=_,a+=" "+h+" = "+p+"; ",g&&y?a+=" var "+(P="ifClause"+s)+" = 'else'; ":P="'else'",a+=" } "),a+=" if (!"+h+") {   var err =   ",!1!==e.createErrors?(a+=" { keyword: 'if' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { failingKeyword: "+P+" } ",!1!==e.opts.messages&&(a+=" , message: 'should match \"' + "+P+" + '\" schema' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; "),a+=" }   ",u&&(a+=" else { "),a=e.util.cleanUpCode(a)}else u&&(a+=" if (true) { ");return a}},function(e,t,r){"use strict";e.exports=function generate_items(e,t,r){var a=" ",s=e.level,n=e.dataLevel,i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,l="data"+(n||""),h="valid"+s,d="errs__"+s,f=e.util.copy(e),p="";f.level++;var m="valid"+f.level,v="i"+s,g=f.dataLevel=e.dataLevel+1,y="data"+g,_=e.baseId;if(a+="var "+d+" = errors;var "+h+";",Array.isArray(i)){var P=e.schema.additionalItems;if(!1===P){a+=" "+h+" = "+l+".length <= "+i.length+"; ";var S=c;c=e.errSchemaPath+"/additionalItems",a+="  if (!"+h+") {   ";var b=b||[];b.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'additionalItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { limit: "+i.length+" } ",!1!==e.opts.messages&&(a+=" , message: 'should NOT have more than "+i.length+" items' "),e.opts.verbose&&(a+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ";var w=a;a=b.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+w+"]); ":a+=" validate.errors = ["+w+"]; return false; ":a+=" var err = "+w+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } ",c=S,u&&(p+="}",a+=" else { ")}var E=i;if(E)for(var I,x=-1,M=E.length-1;x<M;)if(I=E[x+=1],e.util.schemaHasRules(I,e.RULES.all)){a+=" "+m+" = true; if ("+l+".length > "+x+") { ";var D=l+"["+x+"]";f.schema=I,f.schemaPath=o+"["+x+"]",f.errSchemaPath=c+"/"+x,f.errorPath=e.util.getPathExpr(e.errorPath,x,e.opts.jsonPointers,!0),f.dataPathArr[g]=x;var C=e.validate(f);f.baseId=_,e.util.varOccurences(C,y)<2?a+=" "+e.util.varReplace(C,y,D)+" ":a+=" var "+y+" = "+D+"; "+C+" ",a+=" }  ",u&&(a+=" if ("+m+") { ",p+="}")}if("object"==typeof P&&e.util.schemaHasRules(P,e.RULES.all)){f.schema=P,f.schemaPath=e.schemaPath+".additionalItems",f.errSchemaPath=e.errSchemaPath+"/additionalItems",a+=" "+m+" = true; if ("+l+".length > "+i.length+") {  for (var "+v+" = "+i.length+"; "+v+" < "+l+".length; "+v+"++) { ",f.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers,!0);D=l+"["+v+"]";f.dataPathArr[g]=v;C=e.validate(f);f.baseId=_,e.util.varOccurences(C,y)<2?a+=" "+e.util.varReplace(C,y,D)+" ":a+=" var "+y+" = "+D+"; "+C+" ",u&&(a+=" if (!"+m+") break; "),a+=" } }  ",u&&(a+=" if ("+m+") { ",p+="}")}}else if(e.util.schemaHasRules(i,e.RULES.all)){f.schema=i,f.schemaPath=o,f.errSchemaPath=c,a+="  for (var "+v+" = 0; "+v+" < "+l+".length; "+v+"++) { ",f.errorPath=e.util.getPathExpr(e.errorPath,v,e.opts.jsonPointers,!0);D=l+"["+v+"]";f.dataPathArr[g]=v;C=e.validate(f);f.baseId=_,e.util.varOccurences(C,y)<2?a+=" "+e.util.varReplace(C,y,D)+" ":a+=" var "+y+" = "+D+"; "+C+" ",u&&(a+=" if (!"+m+") break; "),a+=" }"}return u&&(a+=" "+p+" if ("+d+" == errors) {"),a=e.util.cleanUpCode(a)}},function(e,t,r){"use strict";e.exports=function generate_multipleOf(e,t,r){var a,s=" ",n=e.level,i=e.dataLevel,o=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,h="data"+(i||""),d=e.opts.$data&&o&&o.$data;d?(s+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",a="schema"+n):a=o,s+="var division"+n+";if (",d&&(s+=" "+a+" !== undefined && ( typeof "+a+" != 'number' || "),s+=" (division"+n+" = "+h+" / "+a+", ",e.opts.multipleOfPrecision?s+=" Math.abs(Math.round(division"+n+") - division"+n+") > 1e-"+e.opts.multipleOfPrecision+" ":s+=" division"+n+" !== parseInt(division"+n+") ",s+=" ) ",d&&(s+="  )  "),s+=" ) {   ";var f=f||[];f.push(s),s="",!1!==e.createErrors?(s+=" { keyword: 'multipleOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { multipleOf: "+a+" } ",!1!==e.opts.messages&&(s+=" , message: 'should be multiple of ",s+=d?"' + "+a:a+"'"),e.opts.verbose&&(s+=" , schema:  ",s+=d?"validate.schema"+c:""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),s+=" } "):s+=" {} ";var p=s;return s=f.pop(),!e.compositeRule&&l?e.async?s+=" throw new ValidationError(["+p+"]); ":s+=" validate.errors = ["+p+"]; return false; ":s+=" var err = "+p+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",l&&(s+=" else { "),s}},function(e,t,r){"use strict";e.exports=function generate_not(e,t,r){var a=" ",s=e.level,n=e.dataLevel,i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,l="data"+(n||""),h="errs__"+s,d=e.util.copy(e);d.level++;var f="valid"+d.level;if(e.util.schemaHasRules(i,e.RULES.all)){d.schema=i,d.schemaPath=o,d.errSchemaPath=c,a+=" var "+h+" = errors;  ";var p,m=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.createErrors=!1,d.opts.allErrors&&(p=d.opts.allErrors,d.opts.allErrors=!1),a+=" "+e.validate(d)+" ",d.createErrors=!0,p&&(d.opts.allErrors=p),e.compositeRule=d.compositeRule=m,a+=" if ("+f+") {   ";var v=v||[];v.push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'should NOT be valid' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ";var g=a;a=v.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+g+"]); ":a+=" validate.errors = ["+g+"]; return false; ":a+=" var err = "+g+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else {  errors = "+h+"; if (vErrors !== null) { if ("+h+") vErrors.length = "+h+"; else vErrors = null; } ",e.opts.allErrors&&(a+=" } ")}else a+="  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'not' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: {} ",!1!==e.opts.messages&&(a+=" , message: 'should NOT be valid' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",u&&(a+=" if (false) { ");return a}},function(e,t,r){"use strict";e.exports=function generate_oneOf(e,t,r){var a=" ",s=e.level,n=e.dataLevel,i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,l="data"+(n||""),h="valid"+s,d="errs__"+s,f=e.util.copy(e),p="";f.level++;var m="valid"+f.level,v=f.baseId,g="prevValid"+s,y="passingSchemas"+s;a+="var "+d+" = errors , "+g+" = false , "+h+" = false , "+y+" = null; ";var _=e.compositeRule;e.compositeRule=f.compositeRule=!0;var P=i;if(P)for(var S,b=-1,w=P.length-1;b<w;)S=P[b+=1],e.util.schemaHasRules(S,e.RULES.all)?(f.schema=S,f.schemaPath=o+"["+b+"]",f.errSchemaPath=c+"/"+b,a+="  "+e.validate(f)+" ",f.baseId=v):a+=" var "+m+" = true; ",b&&(a+=" if ("+m+" && "+g+") { "+h+" = false; "+y+" = ["+y+", "+b+"]; } else { ",p+="}"),a+=" if ("+m+") { "+h+" = "+g+" = true; "+y+" = "+b+"; }";return e.compositeRule=f.compositeRule=_,a+=p+"if (!"+h+") {   var err =   ",!1!==e.createErrors?(a+=" { keyword: 'oneOf' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { passingSchemas: "+y+" } ",!1!==e.opts.messages&&(a+=" , message: 'should match exactly one schema in oneOf' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; "),a+="} else {  errors = "+d+"; if (vErrors !== null) { if ("+d+") vErrors.length = "+d+"; else vErrors = null; }",e.opts.allErrors&&(a+=" } "),a}},function(e,t,r){"use strict";e.exports=function generate_pattern(e,t,r){var a,s=" ",n=e.level,i=e.dataLevel,o=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,h="data"+(i||""),d=e.opts.$data&&o&&o.$data;d?(s+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",a="schema"+n):a=o;var f=d?"(new RegExp("+a+"))":e.usePattern(o);s+="if ( ",d&&(s+=" ("+a+" !== undefined && typeof "+a+" != 'string') || "),s+=" !"+f+".test("+h+") ) {   ";var p=p||[];p.push(s),s="",!1!==e.createErrors?(s+=" { keyword: 'pattern' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { pattern:  ",s+=d?""+a:""+e.util.toQuotedString(o),s+="  } ",!1!==e.opts.messages&&(s+=" , message: 'should match pattern \"",s+=d?"' + "+a+" + '":""+e.util.escapeQuotes(o),s+="\"' "),e.opts.verbose&&(s+=" , schema:  ",s+=d?"validate.schema"+c:""+e.util.toQuotedString(o),s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),s+=" } "):s+=" {} ";var m=s;return s=p.pop(),!e.compositeRule&&l?e.async?s+=" throw new ValidationError(["+m+"]); ":s+=" validate.errors = ["+m+"]; return false; ":s+=" var err = "+m+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+="} ",l&&(s+=" else { "),s}},function(e,t,r){"use strict";e.exports=function generate_properties(e,t,r){var a=" ",s=e.level,n=e.dataLevel,i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,l="data"+(n||""),h="errs__"+s,d=e.util.copy(e),f="";d.level++;var p="valid"+d.level,m="key"+s,v="idx"+s,g=d.dataLevel=e.dataLevel+1,y="data"+g,_="dataProperties"+s,P=Object.keys(i||{}),S=e.schema.patternProperties||{},b=Object.keys(S),w=e.schema.additionalProperties,E=P.length||b.length,I=!1===w,x="object"==typeof w&&Object.keys(w).length,M=e.opts.removeAdditional,D=I||x||M,C=e.opts.ownProperties,L=e.baseId,O=e.schema.required;if(O&&(!e.opts.v5||!O.$data)&&O.length<e.opts.loopRequired)var R=e.util.toHash(O);if(a+="var "+h+" = errors;var "+p+" = true;",C&&(a+=" var "+_+" = undefined;"),D){if(a+=C?" "+_+" = "+_+" || Object.keys("+l+"); for (var "+v+"=0; "+v+"<"+_+".length; "+v+"++) { var "+m+" = "+_+"["+v+"]; ":" for (var "+m+" in "+l+") { ",E){if(a+=" var isAdditional"+s+" = !(false ",P.length)if(P.length>5)a+=" || validate.schema"+o+"["+m+"] ";else{var T=P;if(T)for(var A=-1,B=T.length-1;A<B;)K=T[A+=1],a+=" || "+m+" == "+e.util.toQuotedString(K)+" "}if(b.length){var j=b;if(j)for(var $=-1,k=j.length-1;$<k;)se=j[$+=1],a+=" || "+e.usePattern(se)+".test("+m+") "}a+=" ); if (isAdditional"+s+") { "}if("all"==M)a+=" delete "+l+"["+m+"]; ";else{var F=e.errorPath,V="' + "+m+" + '";if(e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers)),I)if(M)a+=" delete "+l+"["+m+"]; ";else{a+=" "+p+" = false; ";var U=c;c=e.errSchemaPath+"/additionalProperties",(te=te||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'additionalProperties' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { additionalProperty: '"+V+"' } ",!1!==e.opts.messages&&(a+=" , message: 'should NOT have additional properties' "),e.opts.verbose&&(a+=" , schema: false , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ";var N=a;a=te.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+N+"]); ":a+=" validate.errors = ["+N+"]; return false; ":a+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=U,u&&(a+=" break; ")}else if(x)if("failing"==M){a+=" var "+h+" = errors;  ";var q=e.compositeRule;e.compositeRule=d.compositeRule=!0,d.schema=w,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);var z=l+"["+m+"]";d.dataPathArr[g]=m;var W=e.validate(d);d.baseId=L,e.util.varOccurences(W,y)<2?a+=" "+e.util.varReplace(W,y,z)+" ":a+=" var "+y+" = "+z+"; "+W+" ",a+=" if (!"+p+") { errors = "+h+"; if (validate.errors !== null) { if (errors) validate.errors.length = errors; else validate.errors = null; } delete "+l+"["+m+"]; }  ",e.compositeRule=d.compositeRule=q}else{d.schema=w,d.schemaPath=e.schemaPath+".additionalProperties",d.errSchemaPath=e.errSchemaPath+"/additionalProperties",d.errorPath=e.opts._errorDataPathProperty?e.errorPath:e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);z=l+"["+m+"]";d.dataPathArr[g]=m;W=e.validate(d);d.baseId=L,e.util.varOccurences(W,y)<2?a+=" "+e.util.varReplace(W,y,z)+" ":a+=" var "+y+" = "+z+"; "+W+" ",u&&(a+=" if (!"+p+") break; ")}e.errorPath=F}E&&(a+=" } "),a+=" }  ",u&&(a+=" if ("+p+") { ",f+="}")}var H=e.opts.useDefaults&&!e.compositeRule;if(P.length){var Q=P;if(Q)for(var K,G=-1,Y=Q.length-1;G<Y;){var J=i[K=Q[G+=1]];if(e.util.schemaHasRules(J,e.RULES.all)){var Z=e.util.getProperty(K),X=(z=l+Z,H&&void 0!==J.default);d.schema=J,d.schemaPath=o+Z,d.errSchemaPath=c+"/"+e.util.escapeFragment(K),d.errorPath=e.util.getPath(e.errorPath,K,e.opts.jsonPointers),d.dataPathArr[g]=e.util.toQuotedString(K);W=e.validate(d);if(d.baseId=L,e.util.varOccurences(W,y)<2){W=e.util.varReplace(W,y,z);var ee=z}else{ee=y;a+=" var "+y+" = "+z+"; "}if(X)a+=" "+W+" ";else{if(R&&R[K]){a+=" if ( "+ee+" === undefined ",C&&(a+=" || ! Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(K)+"') "),a+=") { "+p+" = false; ";F=e.errorPath,U=c;var te,re=e.util.escapeQuotes(K);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(F,K,e.opts.jsonPointers)),c=e.errSchemaPath+"/required",(te=te||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+re+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+re+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ";N=a;a=te.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+N+"]); ":a+=" validate.errors = ["+N+"]; return false; ":a+=" var err = "+N+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",c=U,e.errorPath=F,a+=" } else { "}else u?(a+=" if ( "+ee+" === undefined ",C&&(a+=" || ! Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(K)+"') "),a+=") { "+p+" = true; } else { "):(a+=" if ("+ee+" !== undefined ",C&&(a+=" &&   Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(K)+"') "),a+=" ) { ");a+=" "+W+" } "}}u&&(a+=" if ("+p+") { ",f+="}")}}if(b.length){var ae=b;if(ae)for(var se,ne=-1,ie=ae.length-1;ne<ie;){J=S[se=ae[ne+=1]];if(e.util.schemaHasRules(J,e.RULES.all)){d.schema=J,d.schemaPath=e.schemaPath+".patternProperties"+e.util.getProperty(se),d.errSchemaPath=e.errSchemaPath+"/patternProperties/"+e.util.escapeFragment(se),a+=C?" "+_+" = "+_+" || Object.keys("+l+"); for (var "+v+"=0; "+v+"<"+_+".length; "+v+"++) { var "+m+" = "+_+"["+v+"]; ":" for (var "+m+" in "+l+") { ",a+=" if ("+e.usePattern(se)+".test("+m+")) { ",d.errorPath=e.util.getPathExpr(e.errorPath,m,e.opts.jsonPointers);z=l+"["+m+"]";d.dataPathArr[g]=m;W=e.validate(d);d.baseId=L,e.util.varOccurences(W,y)<2?a+=" "+e.util.varReplace(W,y,z)+" ":a+=" var "+y+" = "+z+"; "+W+" ",u&&(a+=" if (!"+p+") break; "),a+=" } ",u&&(a+=" else "+p+" = true; "),a+=" }  ",u&&(a+=" if ("+p+") { ",f+="}")}}}return u&&(a+=" "+f+" if ("+h+" == errors) {"),a=e.util.cleanUpCode(a)}},function(e,t,r){"use strict";e.exports=function generate_propertyNames(e,t,r){var a=" ",s=e.level,n=e.dataLevel,i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,l="data"+(n||""),h="errs__"+s,d=e.util.copy(e);d.level++;var f="valid"+d.level;if(e.util.schemaHasRules(i,e.RULES.all)){d.schema=i,d.schemaPath=o,d.errSchemaPath=c;var p="key"+s,m="idx"+s,v="i"+s,g="' + "+p+" + '",y="data"+(d.dataLevel=e.dataLevel+1),_="dataProperties"+s,P=e.opts.ownProperties,S=e.baseId;a+=" var "+h+" = errors; ",P&&(a+=" var "+_+" = undefined; "),a+=P?" "+_+" = "+_+" || Object.keys("+l+"); for (var "+m+"=0; "+m+"<"+_+".length; "+m+"++) { var "+p+" = "+_+"["+m+"]; ":" for (var "+p+" in "+l+") { ",a+=" var startErrs"+s+" = errors; ";var b=p,w=e.compositeRule;e.compositeRule=d.compositeRule=!0;var E=e.validate(d);d.baseId=S,e.util.varOccurences(E,y)<2?a+=" "+e.util.varReplace(E,y,b)+" ":a+=" var "+y+" = "+b+"; "+E+" ",e.compositeRule=d.compositeRule=w,a+=" if (!"+f+") { for (var "+v+"=startErrs"+s+"; "+v+"<errors; "+v+"++) { vErrors["+v+"].propertyName = "+p+"; }   var err =   ",!1!==e.createErrors?(a+=" { keyword: 'propertyNames' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { propertyName: '"+g+"' } ",!1!==e.opts.messages&&(a+=" , message: 'property name \\'"+g+"\\' is invalid' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&u&&(e.async?a+=" throw new ValidationError(vErrors); ":a+=" validate.errors = vErrors; return false; "),u&&(a+=" break; "),a+=" } }"}return u&&(a+="  if ("+h+" == errors) {"),a=e.util.cleanUpCode(a)}},function(e,t,r){"use strict";e.exports=function generate_required(e,t,r){var a=" ",s=e.level,n=e.dataLevel,i=e.schema[t],o=e.schemaPath+e.util.getProperty(t),c=e.errSchemaPath+"/"+t,u=!e.opts.allErrors,l="data"+(n||""),h="valid"+s,d=e.opts.$data&&i&&i.$data;d&&(a+=" var schema"+s+" = "+e.util.getData(i.$data,n,e.dataPathArr)+"; ");var f="schema"+s;if(!d)if(i.length<e.opts.loopRequired&&e.schema.properties&&Object.keys(e.schema.properties).length){var p=[],m=i;if(m)for(var v,g=-1,y=m.length-1;g<y;){v=m[g+=1];var _=e.schema.properties[v];_&&e.util.schemaHasRules(_,e.RULES.all)||(p[p.length]=v)}}else p=i;if(d||p.length){var P=e.errorPath,S=d||p.length>=e.opts.loopRequired,b=e.opts.ownProperties;if(u)if(a+=" var missing"+s+"; ",S){d||(a+=" var "+f+" = validate.schema"+o+"; ");var w="' + "+(C="schema"+s+"["+(x="i"+s)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(P,C,e.opts.jsonPointers)),a+=" var "+h+" = true; ",d&&(a+=" if (schema"+s+" === undefined) "+h+" = true; else if (!Array.isArray(schema"+s+")) "+h+" = false; else {"),a+=" for (var "+x+" = 0; "+x+" < "+f+".length; "+x+"++) { "+h+" = "+l+"["+f+"["+x+"]] !== undefined ",b&&(a+=" &&   Object.prototype.hasOwnProperty.call("+l+", "+f+"["+x+"]) "),a+="; if (!"+h+") break; } ",d&&(a+="  }  "),a+="  if (!"+h+") {   ",(D=D||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+w+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ";var E=a;a=D.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+E+"]); ":a+=" validate.errors = ["+E+"]; return false; ":a+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else { "}else{a+=" if ( ";var I=p;if(I)for(var x=-1,M=I.length-1;x<M;){O=I[x+=1],x&&(a+=" || "),a+=" ( ( "+(B=l+(A=e.util.getProperty(O)))+" === undefined ",b&&(a+=" || ! Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(O)+"') "),a+=") && (missing"+s+" = "+e.util.toQuotedString(e.opts.jsonPointers?O:A)+") ) "}a+=") {  ";var D;w="' + "+(C="missing"+s)+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.opts.jsonPointers?e.util.getPathExpr(P,C,!0):P+" + "+C),(D=D||[]).push(a),a="",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+w+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ";E=a;a=D.pop(),!e.compositeRule&&u?e.async?a+=" throw new ValidationError(["+E+"]); ":a+=" validate.errors = ["+E+"]; return false; ":a+=" var err = "+E+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",a+=" } else { "}else if(S){d||(a+=" var "+f+" = validate.schema"+o+"; ");var C;w="' + "+(C="schema"+s+"["+(x="i"+s)+"]")+" + '";e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPathExpr(P,C,e.opts.jsonPointers)),d&&(a+=" if ("+f+" && !Array.isArray("+f+")) {  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+w+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } else if ("+f+" !== undefined) { "),a+=" for (var "+x+" = 0; "+x+" < "+f+".length; "+x+"++) { if ("+l+"["+f+"["+x+"]] === undefined ",b&&(a+=" || ! Object.prototype.hasOwnProperty.call("+l+", "+f+"["+x+"]) "),a+=") {  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+w+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } } ",d&&(a+="  }  ")}else{var L=p;if(L)for(var O,R=-1,T=L.length-1;R<T;){O=L[R+=1];var A=e.util.getProperty(O),B=(w=e.util.escapeQuotes(O),l+A);e.opts._errorDataPathProperty&&(e.errorPath=e.util.getPath(P,O,e.opts.jsonPointers)),a+=" if ( "+B+" === undefined ",b&&(a+=" || ! Object.prototype.hasOwnProperty.call("+l+", '"+e.util.escapeQuotes(O)+"') "),a+=") {  var err =   ",!1!==e.createErrors?(a+=" { keyword: 'required' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(c)+" , params: { missingProperty: '"+w+"' } ",!1!==e.opts.messages&&(a+=" , message: '",e.opts._errorDataPathProperty?a+="is a required property":a+="should have required property \\'"+w+"\\'",a+="' "),e.opts.verbose&&(a+=" , schema: validate.schema"+o+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+l+" "),a+=" } "):a+=" {} ",a+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; } "}}e.errorPath=P}else u&&(a+=" if (true) {");return a}},function(e,t,r){"use strict";e.exports=function generate_uniqueItems(e,t,r){var a,s=" ",n=e.level,i=e.dataLevel,o=e.schema[t],c=e.schemaPath+e.util.getProperty(t),u=e.errSchemaPath+"/"+t,l=!e.opts.allErrors,h="data"+(i||""),d="valid"+n,f=e.opts.$data&&o&&o.$data;if(f?(s+=" var schema"+n+" = "+e.util.getData(o.$data,i,e.dataPathArr)+"; ",a="schema"+n):a=o,(o||f)&&!1!==e.opts.uniqueItems){f&&(s+=" var "+d+"; if ("+a+" === false || "+a+" === undefined) "+d+" = true; else if (typeof "+a+" != 'boolean') "+d+" = false; else { "),s+=" var i = "+h+".length , "+d+" = true , j; if (i > 1) { ";var p=e.schema.items&&e.schema.items.type;s+=p&&"object"!=p&&"array"!=p?" var itemIndices = {}, item; for (;i--;) { var item = "+h+"[i]; if (typeof item != '"+p+"') continue; if (itemIndices[item] !== undefined) { "+d+" = false; j = itemIndices[item]; break; } itemIndices[item] = i; } ":" outer: for (;i--;) { for (j = i; j--;) { if (equal("+h+"[i], "+h+"[j])) { "+d+" = false; break outer; } } } ",s+=" } ",f&&(s+="  }  "),s+=" if (!"+d+") {   ";var m=m||[];m.push(s),s="",!1!==e.createErrors?(s+=" { keyword: 'uniqueItems' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(u)+" , params: { i: i, j: j } ",!1!==e.opts.messages&&(s+=" , message: 'should NOT have duplicate items (items ## ' + j + ' and ' + i + ' are identical)' "),e.opts.verbose&&(s+=" , schema:  ",s+=f?"validate.schema"+c:""+o,s+="         , parentSchema: validate.schema"+e.schemaPath+" , data: "+h+" "),s+=" } "):s+=" {} ";var v=s;s=m.pop(),!e.compositeRule&&l?e.async?s+=" throw new ValidationError(["+v+"]); ":s+=" validate.errors = ["+v+"]; return false; ":s+=" var err = "+v+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",s+=" } ",l&&(s+=" else { ")}else l&&(s+=" if (true) { ");return s}},function(e,t,r){"use strict";var a=["multipleOf","maximum","exclusiveMaximum","minimum","exclusiveMinimum","maxLength","minLength","pattern","additionalItems","maxItems","minItems","uniqueItems","maxProperties","minProperties","required","additionalProperties","enum","format","const"];e.exports=function(e,t){for(var r=0;r<t.length;r++){e=JSON.parse(JSON.stringify(e));var s,n=t[r].split("/"),i=e;for(s=1;s<n.length;s++)i=i[n[s]];for(s=0;s<a.length;s++){var o=a[s],c=i[o];c&&(i[o]={anyOf:[c,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]})}}return e}},function(e,t,r){"use strict";var a=r(11).MissingRef;e.exports=function compileAsync(e,t,r){var s=this;if("function"!=typeof this._opts.loadSchema)throw new Error("options.loadSchema should be a function");"function"==typeof t&&(r=t,t=void 0);var n=loadMetaSchemaOf(e).then(function(){var r=s._addSchema(e,void 0,t);return r.validate||function _compileAsync(e){try{return s._compile(e)}catch(r){if(r instanceof a)return function loadMissingSchema(r){var n=r.missingSchema;if(added(n))throw new Error("Schema "+n+" is loaded but "+r.missingRef+" cannot be resolved");var i=s._loadingSchemas[n];i||(i=s._loadingSchemas[n]=s._opts.loadSchema(n)).then(removePromise,removePromise);return i.then(function(e){if(!added(n))return loadMetaSchemaOf(e).then(function(){added(n)||s.addSchema(e,n,void 0,t)})}).then(function(){return function _compileAsync(e){try{return s._compile(e)}catch(e){if(e instanceof a)return loadMissingSchema(e);throw e}function loadMissingSchema(r){var a=r.missingSchema;if(added(a))throw new Error("Schema "+a+" is loaded but "+r.missingRef+" cannot be resolved");var n=s._loadingSchemas[a];return n||(n=s._loadingSchemas[a]=s._opts.loadSchema(a)).then(removePromise,removePromise),n.then(function(e){if(!added(a))return loadMetaSchemaOf(e).then(function(){added(a)||s.addSchema(e,a,void 0,t)})}).then(function(){return _compileAsync(e)});function removePromise(){delete s._loadingSchemas[a]}function added(e){return s._refs[e]||s._schemas[e]}}}(e)});function removePromise(){delete s._loadingSchemas[n]}function added(e){return s._refs[e]||s._schemas[e]}}(r);throw r}function loadMissingSchema(r){var a=r.missingSchema;if(added(a))throw new Error("Schema "+a+" is loaded but "+r.missingRef+" cannot be resolved");var n=s._loadingSchemas[a];return n||(n=s._loadingSchemas[a]=s._opts.loadSchema(a)).then(removePromise,removePromise),n.then(function(e){if(!added(a))return loadMetaSchemaOf(e).then(function(){added(a)||s.addSchema(e,a,void 0,t)})}).then(function(){return _compileAsync(e)});function removePromise(){delete s._loadingSchemas[a]}function added(e){return s._refs[e]||s._schemas[e]}}}(r)});r&&n.then(function(e){r(null,e)},r);return n;function loadMetaSchemaOf(e){var t=e.$schema;return t&&!s.getSchema(t)?compileAsync.call(s,{$ref:t},!0):Promise.resolve()}}},function(e,t,r){"use strict";var a=/^[a-z_$][a-z0-9_$-]*$/i,s=r(76);e.exports={add:function addKeyword(e,t){var r=this.RULES;if(r.keywords[e])throw new Error("Keyword "+e+" is already defined");if(!a.test(e))throw new Error("Keyword "+e+" is not a valid identifier");if(t){if(t.macro&&void 0!==t.valid)throw new Error('"valid" option cannot be used with macro keywords');var n=t.type;if(Array.isArray(n)){var i,o=n.length;for(i=0;i<o;i++)checkDataType(n[i]);for(i=0;i<o;i++)_addRule(e,n[i],t)}else n&&checkDataType(n),_addRule(e,n,t);var c=!0===t.$data&&this._opts.$data;if(c&&!t.validate)throw new Error('$data support: "validate" function is not defined');var u=t.metaSchema;u&&(c&&(u={anyOf:[u,{$ref:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#"}]}),t.validateSchema=this.compile(u,!0))}function _addRule(e,t,a){for(var n,i=0;i<r.length;i++){var o=r[i];if(o.type==t){n=o;break}}n||(n={type:t,rules:[]},r.push(n));var c={keyword:e,definition:a,custom:!0,code:s,implements:a.implements};n.rules.push(c),r.custom[e]=c}function checkDataType(e){if(!r.types[e])throw new Error("Unknown type "+e)}return r.keywords[e]=r.all[e]=!0,this},get:function getKeyword(e){var t=this.RULES.custom[e];return t?t.definition:this.RULES.keywords[e]||!1},remove:function removeKeyword(e){var t=this.RULES;delete t.keywords[e],delete t.all[e],delete t.custom[e];for(var r=0;r<t.length;r++)for(var a=t[r].rules,s=0;s<a.length;s++)if(a[s].keyword==e){a.splice(s,1);break}return this}}},function(e,t,r){"use strict";e.exports=function generate_custom(e,t,r){var a,s,n=" ",i=e.level,o=e.dataLevel,c=e.schema[t],u=e.schemaPath+e.util.getProperty(t),l=e.errSchemaPath+"/"+t,h=!e.opts.allErrors,d="data"+(o||""),f="valid"+i,p="errs__"+i,m=e.opts.$data&&c&&c.$data;m?(n+=" var schema"+i+" = "+e.util.getData(c.$data,o,e.dataPathArr)+"; ",s="schema"+i):s=c;var v,g,y,_,P,S="definition"+i,b=this.definition,w="";if(m&&b.$data){P="keywordValidate"+i;var E=b.validateSchema;n+=" var "+S+" = RULES.custom['"+t+"'].definition; var "+P+" = "+S+".validate;"}else{if(!(_=e.useCustomRule(this,c,e.schema,e)))return;s="validate.schema"+u,P=_.code,v=b.compile,g=b.inline,y=b.macro}var I=P+".errors",x="i"+i,M="ruleErr"+i,D=b.async;if(D&&!e.async)throw new Error("async keyword in sync schema");if(g||y||(n+=I+" = null;"),n+="var "+p+" = errors;var "+f+";",m&&b.$data&&(w+="}",n+=" if ("+s+" === undefined) { "+f+" = true; } else { ",E&&(w+="}",n+=" "+f+" = "+S+".validateSchema("+s+"); if ("+f+") { ")),g)b.statements?n+=" "+_.validate+" ":n+=" "+f+" = "+_.validate+"; ";else if(y){var C=e.util.copy(e);w="";C.level++;var L="valid"+C.level;C.schema=_.validate,C.schemaPath="";var O=e.compositeRule;e.compositeRule=C.compositeRule=!0;var R=e.validate(C).replace(/validate\.schema/g,P);e.compositeRule=C.compositeRule=O,n+=" "+R}else{(j=j||[]).push(n),n="",n+="  "+P+".call( ",e.opts.passContext?n+="this":n+="self",v||!1===b.schema?n+=" , "+d+" ":n+=" , "+s+" , "+d+" , validate.schema"+e.schemaPath+" ",n+=" , (dataPath || '')",'""'!=e.errorPath&&(n+=" + "+e.errorPath);var T=o?"data"+(o-1||""):"parentData",A=o?e.dataPathArr[o]:"parentDataProperty",B=n+=" , "+T+" , "+A+" , rootData )  ";n=j.pop(),!1===b.errors?(n+=" "+f+" = ",D&&(n+="await "),n+=B+"; "):n+=D?" var "+(I="customErrors"+i)+" = null; try { "+f+" = await "+B+"; } catch (e) { "+f+" = false; if (e instanceof ValidationError) "+I+" = e.errors; else throw e; } ":" "+I+" = null; "+f+" = "+B+"; "}if(b.modifying&&(n+=" if ("+T+") "+d+" = "+T+"["+A+"];"),n+=""+w,b.valid)h&&(n+=" if (true) { ");else{var j;n+=" if ( ",void 0===b.valid?(n+=" !",n+=y?""+L:""+f):n+=" "+!b.valid+" ",n+=") { ",a=this.keyword,(j=j||[]).push(n),n="",(j=j||[]).push(n),n="",!1!==e.createErrors?(n+=" { keyword: '"+(a||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(n+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ";var $=n;n=j.pop(),!e.compositeRule&&h?e.async?n+=" throw new ValidationError(["+$+"]); ":n+=" validate.errors = ["+$+"]; return false; ":n+=" var err = "+$+";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ";var k=n;n=j.pop(),g?b.errors?"full"!=b.errors&&(n+="  for (var "+x+"="+p+"; "+x+"<errors; "+x+"++) { var "+M+" = vErrors["+x+"]; if ("+M+".dataPath === undefined) "+M+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+M+".schemaPath === undefined) { "+M+'.schemaPath = "'+l+'"; } ',e.opts.verbose&&(n+=" "+M+".schema = "+s+"; "+M+".data = "+d+"; "),n+=" } "):!1===b.errors?n+=" "+k+" ":(n+=" if ("+p+" == errors) { "+k+" } else {  for (var "+x+"="+p+"; "+x+"<errors; "+x+"++) { var "+M+" = vErrors["+x+"]; if ("+M+".dataPath === undefined) "+M+".dataPath = (dataPath || '') + "+e.errorPath+"; if ("+M+".schemaPath === undefined) { "+M+'.schemaPath = "'+l+'"; } ',e.opts.verbose&&(n+=" "+M+".schema = "+s+"; "+M+".data = "+d+"; "),n+=" } } "):y?(n+="   var err =   ",!1!==e.createErrors?(n+=" { keyword: '"+(a||"custom")+"' , dataPath: (dataPath || '') + "+e.errorPath+" , schemaPath: "+e.util.toQuotedString(l)+" , params: { keyword: '"+this.keyword+"' } ",!1!==e.opts.messages&&(n+=" , message: 'should pass \""+this.keyword+"\" keyword validation' "),e.opts.verbose&&(n+=" , schema: validate.schema"+u+" , parentSchema: validate.schema"+e.schemaPath+" , data: "+d+" "),n+=" } "):n+=" {} ",n+=";  if (vErrors === null) vErrors = [err]; else vErrors.push(err); errors++; ",!e.compositeRule&&h&&(e.async?n+=" throw new ValidationError(vErrors); ":n+=" validate.errors = vErrors; return false; ")):!1===b.errors?n+=" "+k+" ":(n+=" if (Array.isArray("+I+")) { if (vErrors === null) vErrors = "+I+"; else vErrors = vErrors.concat("+I+"); errors = vErrors.length;  for (var "+x+"="+p+"; "+x+"<errors; "+x+"++) { var "+M+" = vErrors["+x+"]; if ("+M+".dataPath === undefined) "+M+".dataPath = (dataPath || '') + "+e.errorPath+";  "+M+'.schemaPath = "'+l+'";  ',e.opts.verbose&&(n+=" "+M+".schema = "+s+"; "+M+".data = "+d+"; "),n+=" } } else { "+k+" } "),n+=" } ",h&&(n+=" else { ")}return n}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"https://raw.githubusercontent.com/epoberezkin/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON Schema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-06/schema#",title:"Buttplug Message Schema",version:1,description:"The JSON Protocol format for the Buttplug Protocol.",components:{Id:{description:"User-set id for the message. 0 denotes system message and is reserved.",type:"integer",minimum:0,maximum:4294967295},SystemId:{description:"Used for non-direct-reply messages that can only be sent from server to client, using the reserved system message Id of 0.",type:"integer",minimum:0,maximum:0},DeviceName:{description:"Name of the device",type:"string"},DeviceIndex:{description:"Index used for referencing the device in device messages.",type:"integer",minimum:0},IdMessage:{properties:{Id:{$ref:"#/components/Id"}},additionalProperties:!1,minProperties:1,maxProperties:1,required:["Id"]},DeviceMessages:{description:"A list of the messages a device will accept on this server implementation.",type:"array",items:{type:"string",minItems:1}},DeviceMessagesEx:{description:"A list of the messages a device will accept on this server implementation.",type:"object",items:{description:"A list of the messages attributes.",type:"object",properties:{FeatureCount:{$ref:"#/components/FeatureCount"}},additionalProperties:!0,minItems:1}},SystemIdMessage:{description:"Message sent by the server that is not in direct reply to a message send from the client, and always uses system Id.",properties:{Id:{$ref:"#/components/SystemId"}},additionalProperties:!1,minProperties:1,maxProperties:1,required:["Id"]},DeviceIndexMessage:{properties:{Id:{$ref:"#/components/Id"},DeviceIndex:{$ref:"#/components/DeviceIndex"}},additionalProperties:!1,minProperties:2,maxProperties:2,required:["Id","DeviceIndex"]},FeatureCount:{description:"Number of features on device.",type:"integer",minimum:0}},messages:{Ok:{type:"object",description:"Signifies successful processing of the message indicated by the id.",anyOf:[{$ref:"#/components/IdMessage"}]},Ping:{type:"object",description:"Connection keep-alive message.",anyOf:[{$ref:"#/components/IdMessage"}]},Error:{type:"object",description:"Signifies the server encountered an error while processing the message indicated by the id.",properties:{Id:{$ref:"#/components/Id"},ErrorMessage:{type:"string"},ErrorCode:{type:"number",minimum:0,maximum:4}},additionalProperties:!1,minProperties:3,maxProperties:3,required:["Id","ErrorMessage","ErrorCode"]},Test:{type:"object",description:"Used for connection/application testing. Causes server to echo back the string sent. Sending string of 'Error' will result in a server error. ",properties:{Id:{$ref:"#/components/Id"},TestString:{description:"String to be echo'd back from server. Setting this to 'Error' will cause an error to be thrown.",type:"string"}},minProperties:2,maxProperties:2,additionalProperties:!1,required:["Id","TestString"]},DeviceList:{type:"object",description:"List of all available devices known to the system.",properties:{Id:{$ref:"#/components/Id"},Devices:{description:"Array of device ids and names.",type:"array",items:{properties:{DeviceName:{$ref:"#/components/DeviceName"},DeviceIndex:{$ref:"#/components/DeviceIndex"},DeviceMessages:{oneOf:[{$ref:"#/components/DeviceMessages"},{$ref:"#/components/DeviceMessagesEx"}]}},minProperties:3,maxProperties:3,additionalProperties:!1,required:["DeviceName","DeviceIndex","DeviceMessages"]}}},minProperties:2,maxProperties:2,additionalProperties:!1,required:["Id","Devices"]},DeviceAdded:{type:"object",description:"Notifies client that a device of a certain type has been added to the server.",properties:{Id:{$ref:"#/components/SystemId"},DeviceName:{$ref:"#/components/DeviceName"},DeviceIndex:{$ref:"#/components/DeviceIndex"},DeviceMessages:{oneOf:[{$ref:"#/components/DeviceMessages"},{$ref:"#/components/DeviceMessagesEx"}]}},minProperties:4,maxProperties:4,additionalProperties:!1,required:["Id","DeviceName","DeviceIndex","DeviceMessages"]},DeviceRemoved:{type:"object",description:"Notifies client that a device of a certain type has been removed from the server.",anyOf:[{$ref:"#/components/DeviceIndexMessage"}]},RequestDeviceList:{type:"object",description:"Request for the server to send a list of devices to the client.",anyOf:[{$ref:"#/components/IdMessage"}]},StartScanning:{type:"object",description:"Request for the server to start scanning for new devices.",anyOf:[{$ref:"#/components/IdMessage"}]},StopScanning:{type:"object",description:"Request for the server to stop scanning for new devices.",anyOf:[{$ref:"#/components/IdMessage"}]},ScanningFinished:{type:"object",description:"Server notification to client that scanning has ended.",anyOf:[{$ref:"#/components/SystemIdMessage"}]},RequestLog:{type:"object",description:"Request for server to stream log messages of a certain level to client.",properties:{Id:{$ref:"#/components/Id"},LogLevel:{description:"Maximum level of log message to receive.",enum:["Off","Fatal","Error","Warn","Info","Debug","Trace"]}},minProperties:2,maxProperties:2,additionalProperties:!1,required:["Id","LogLevel"]},Log:{type:"object",description:"Log message from the server.",properties:{Id:{$ref:"#/components/SystemId"},LogLevel:{description:"Log level of message.",enum:["Off","Fatal","Error","Warn","Info","Debug","Trace"]},LogMessage:{description:"Log message from server.",type:"string"}},minProperties:3,maxProperties:3,additionalProperties:!1,required:["Id","LogLevel","LogMessage"]},RequestServerInfo:{type:"object",description:"Request server version, and relay client name.",properties:{Id:{$ref:"#/components/Id"},ClientName:{description:"Name of the client software.",type:"string"},MessageVersion:{description:"Message template version of the client software.",type:"integer",minimum:0}},minProperties:2,maxProperties:3,additionalProperties:!1,required:["Id","ClientName"]},ServerInfo:{type:"object",description:"Server version information, in Major.Minor.Build format.",properties:{Id:{$ref:"#/components/Id"},ServerName:{description:"Name of the server. Can be 0-length.",type:"string"},MessageVersion:{description:"Message template version of the server software.",type:"integer",minimum:0},MajorVersion:{description:"Major version of server.",type:"integer",minimum:0},MinorVersion:{description:"Minor version of server.",type:"integer",minimum:0},BuildVersion:{description:"Build version of server.",type:"integer",minimum:0},MaxPingTime:{description:"Maximum time (in milliseconds) the server will wait between ping messages from client before shutting down.",type:"integer",minimum:0}},minProperties:7,maxProperties:7,additionalProperties:!1,required:["Id","MajorVersion","MinorVersion","BuildVersion","MessageVersion","MaxPingTime","ServerName"]},FleshlightLaunchFW12Cmd:{type:"object",description:"Sends speed and position command to the Fleshlight Launch Device denoted by the device index.",properties:{Id:{$ref:"#/components/Id"},DeviceIndex:{$ref:"#/components/DeviceIndex"},Speed:{description:"Speed at which to move to designated position.",type:"integer",minimum:0,maximum:99},Position:{description:"Position to which to move Fleshlight.",type:"integer",minimum:0,maximum:99}},minProperties:4,maxProperties:4,additionalProperties:!1,required:["Id","DeviceIndex","Speed","Position"]},LovenseCmd:{type:"object",description:"Sends a command string to a Lovense device. Command string will be verified by sender.",properties:{Id:{$ref:"#/components/Id"},DeviceIndex:{$ref:"#/components/DeviceIndex"},Command:{description:"Command to send to Lovense device.",type:"string"}},minProperties:3,maxProperties:3,additionalProperties:!1,required:["Id","DeviceIndex","Command"]},SingleMotorVibrateCmd:{type:"object",description:"Sends a vibrate command to a device that supports vibration.",properties:{Id:{$ref:"#/components/Id"},DeviceIndex:{$ref:"#/components/DeviceIndex"},Speed:{description:"Device vibration speed (floating point, 0 < x < 1), stepping will be device specific.",type:"number",minimum:0,maximum:1}},minProperties:3,maxProperties:3,additionalProperties:!1,required:["Id","DeviceIndex","Speed"]},RawCmd:{type:"object",description:"Sends a raw byte array to a device. Should only be used for testing/development.",properties:{Id:{$ref:"#/components/Id"},DeviceIndex:{$ref:"#/components/DeviceIndex"},Command:{description:"Raw byte string to send to device.",type:"array",items:{type:"integer",minimum:0,maximum:255,minItems:1}}},minProperties:3,maxProperties:3,additionalProperties:!1,required:["Id","DeviceIndex","Command"]},KiirooCmd:{type:"object",description:"Sends a raw byte string to a Kiiroo Onyx/Pearl device.",properties:{Id:{$ref:"#/components/Id"},DeviceIndex:{$ref:"#/components/DeviceIndex"},Command:{description:"Command to send to Kiiroo device.",type:"string"}},minProperties:3,maxProperties:3,additionalProperties:!1,required:["Id","DeviceIndex","Command"]},VorzeA10CycloneCmd:{type:"object",description:"Sends a raw byte string to a Kiiroo Onyx/Pearl device.",properties:{Id:{$ref:"#/components/Id"},DeviceIndex:{$ref:"#/components/DeviceIndex"},Speed:{description:"Rotation speed command for the Cyclone.",type:"integer",minimum:0,maximum:100},Clockwise:{description:"True for clockwise rotation (in relation to device facing user), false for Counter-clockwise",type:"boolean"}},minProperties:4,maxProperties:4,additionalProperties:!1,required:["Id","DeviceIndex","Speed","Clockwise"]},StopDeviceCmd:{type:"object",description:"Stops the all actions currently being taken by a device.",properties:{Id:{$ref:"#/components/Id"},DeviceIndex:{$ref:"#/components/DeviceIndex"}},minProperties:2,maxProperties:2,additionalProperties:!1,required:["Id","DeviceIndex"]},StopAllDevices:{type:"object",description:"Stops all actions currently being taken by all connected devices.",anyOf:[{$ref:"#/components/IdMessage"}]},VibrateCmd:{type:"object",description:"Sends a vibrate command to a device that supports vibration.",properties:{Id:{$ref:"#/components/Id"},DeviceIndex:{$ref:"#/components/DeviceIndex"},Speeds:{description:"Device vibration speeds (floating point, 0 < x < 1) keyed on vibrator number, stepping will be device specific.",type:"array",items:{Index:{description:"Vibrator number.",type:"integer",minimum:0},Speed:{description:"Vibration speed (floating point, 0 < x < 1), stepping will be device specific.",type:"number",minimum:0,maximum:1}},minProperties:2,maxProperties:2,additionalProperties:!1,required:["Index","Speed"]}},minProperties:3,maxProperties:3,additionalProperties:!1,required:["Id","DeviceIndex","Speeds"]},RotateCmd:{type:"object",description:"Sends a rotate command to a device that supports rotation.",properties:{Id:{$ref:"#/components/Id"},DeviceIndex:{$ref:"#/components/DeviceIndex"},Rotations:{description:"Device rotation speeds (floating point, 0 < x < 1) keyed on rotator number, stepping will be device specific.",type:"array",items:{Index:{description:"Rotator number.",type:"integer",minimum:0},Speed:{description:"Rotation speed (floating point, 0 < x < 1), stepping will be device specific.",type:"number",minimum:0,maximum:1},Clockwise:{description:"Rotation direction (boolean). Not all devices have a concept of actual clockwise.",type:"boolean"}},minProperties:3,maxProperties:3,additionalProperties:!1,required:["Index","Speed","Clockwise"]}},minProperties:3,maxProperties:3,additionalProperties:!1,required:["Id","DeviceIndex","Rotations"]},LinearCmd:{type:"object",description:"Sends a linear movement command to a device that supports linear movements.",properties:{Id:{$ref:"#/components/Id"},DeviceIndex:{$ref:"#/components/DeviceIndex"},Vectors:{description:"Device linear movement times (milliseconds) and positions (floating point, 0 < x < 1) keyed on linear actuator number, stepping will be device specific.",type:"array",items:{Index:{description:"Linear actuator number.",type:"integer",minimum:0},Duration:{description:"Linear movement time in milliseconds.",type:"number",minimum:0},Position:{description:"Linear movement position (floating point, 0 < x < 1), stepping will be device specific.",type:"number",minimum:0,maximum:1}},minProperties:3,maxProperties:3,additionalProperties:!1,required:["Index","Speed","Position"]}},minProperties:3,maxProperties:3,additionalProperties:!1,required:["Id","DeviceIndex","Vectors"]}},type:"array",items:{title:"Messages",description:"One or more messages validated by the Buttplug Message schema list.",properties:{Ok:{$ref:"#/messages/Ok"},Error:{$ref:"#/messages/Error"},Ping:{$ref:"#/messages/Ping"},Test:{$ref:"#/messages/Test"},DeviceList:{$ref:"#/messages/DeviceList"},DeviceAdded:{$ref:"#/messages/DeviceAdded"},DeviceRemoved:{$ref:"#/messages/DeviceRemoved"},RequestDeviceList:{$ref:"#/messages/RequestDeviceList"},StopDeviceCmd:{$ref:"#/messages/StopDeviceCmd"},StopAllDevices:{$ref:"#/messages/StopAllDevices"},StartScanning:{$ref:"#/messages/StartScanning"},StopScanning:{$ref:"#/messages/StopScanning"},ScanningFinished:{$ref:"#/messages/ScanningFinished"},RequestLog:{$ref:"#/messages/RequestLog"},Log:{$ref:"#/messages/Log"},RequestServerInfo:{$ref:"#/messages/RequestServerInfo"},ServerInfo:{$ref:"#/messages/ServerInfo"},FleshlightLaunchFW12Cmd:{$ref:"#/messages/FleshlightLaunchFW12Cmd"},LovenseCmd:{$ref:"#/messages/LovenseCmd"},SingleMotorVibrateCmd:{$ref:"#/messages/SingleMotorVibrateCmd"},KiirooCmd:{$ref:"#/messages/KiirooCmd"},RawCmd:{$ref:"#/messages/RawCmd"},VorzeA10CycloneCmd:{$ref:"#/messages/VorzeA10CycloneCmd"},VibrateCmd:{$ref:"#/messages/VibrateCmd"},RotateCmd:{$ref:"#/messages/RotateCmd"},LinearCmd:{$ref:"#/messages/LinearCmd"}},additionalProperties:!1,minProperties:1,maxProperties:1},minItems:1,additionalProperties:!1}},function(e,t){e.exports={$schema:"http://json-schema.org/draft-06/schema#",$id:"http://json-schema.org/draft-06/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},title:{type:"string"},description:{type:"string"},default:{},examples:{type:"array",items:{}},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:{}},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:{},enum:{type:"array",minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:{}}},function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function fulfilled(e){try{step(a.next(e))}catch(e){n(e)}}function rejected(e){try{step(a.throw(e))}catch(e){n(e)}}function step(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const s=r(0),n=r(82),i=r(1),o=r(27),c=r(3);t.DeviceManager=class DeviceManager extends i.EventEmitter{constructor(){super(),this._subtypeManagers=[],this._devices=new Map,this._deviceCounter=1,this._logger=c.ButtplugLogger.Logger,this.AddDeviceManager=(e=>{this._logger.Info(`DeviceManager: Adding Device Manager ${e.constructor.name}`),this._subtypeManagers.push(e),e.addListener("deviceadded",this.OnDeviceAdded),e.addListener("deviceremoved",this.OnDeviceRemoved),e.addListener("scanningfinished",this.OnScanningFinished)}),this.SendMessage=(e=>a(this,void 0,void 0,function*(){const t=e.Id;switch(e.Type){case"StartScanning":if(this._logger.Debug("DeviceManager: Starting scan"),0===this._subtypeManagers.length)return this._logger.LogAndError("No device managers available, cannot scan.",s.ErrorClass.ERROR_DEVICE,t);for(const e of this._subtypeManagers)if(!e.IsScanning)try{yield e.StartScanning()}catch(e){return this._logger.LogAndError(e.message,s.ErrorClass.ERROR_DEVICE,t)}return new s.Ok(t);case"StopScanning":this._logger.Debug("DeviceManager: Stopping scan");for(const e of this._subtypeManagers)e.IsScanning&&e.StopScanning();return new s.Ok(t);case"StopAllDevices":return this._logger.Debug("DeviceManager: Stopping all devices"),this._devices.forEach((e,t)=>{e.ParseMessage(new s.StopDeviceCmd)}),new s.Ok(t);case"RequestDeviceList":this._logger.Debug("DeviceManager: Sending device list");const r=[];return this._devices.forEach((e,t)=>{r.push(new s.DeviceInfo(t,e.Name,e.AllowedMessageTypes))}),new s.DeviceList(r,t)}const r=e;if(void 0===r.DeviceIndex)return this._logger.LogAndError(`Message Type ${e.Type} unhandled by this server.`,s.ErrorClass.ERROR_MSG,t);if(!this._devices.has(r.DeviceIndex))return this._logger.LogAndError(`Device Index ${r.DeviceIndex} does not exist`,s.ErrorClass.ERROR_DEVICE,t);const a=this._devices.get(r.DeviceIndex);return a.AllowedMessageTypes.indexOf(e.Type)<0?this._logger.LogAndError(`Device ${a.Name} does not take message type ${e.Type}`,s.ErrorClass.ERROR_DEVICE,t):(this._logger.Trace(`DeviceManager: Sending ${r.Type} to ${a.Name} (${r.Id})`),yield a.ParseMessage(r))})),this.OnDeviceAdded=(e=>{const t=this._deviceCounter;this._deviceCounter+=1,this._devices.set(t,e),this._logger.Info(`DeviceManager: Device Added: ${e.Name} (${t})`),e.addListener("deviceremoved",this.OnDeviceRemoved),o.ServerMessageHub.Instance.emitMessage(new s.DeviceAdded(t,e.Name,e.MessageSpecifications))}),this.OnDeviceRemoved=(e=>{let t=null;for(const r of Array.from(this._devices.entries()))if(r[1]===e){t=r[0];break}null!==t&&(e.removeAllListeners("deviceremoved"),this._devices.delete(t),this._logger.Info(`DeviceManager: Device Removed: ${e.Name} (${t})`),o.ServerMessageHub.Instance.emitMessage(new s.DeviceRemoved(t)))}),this.OnScanningFinished=(()=>{this._logger.Debug("DeviceManager: Scanning Finished.");for(const e of this._subtypeManagers)if(e.IsScanning)return;o.ServerMessageHub.Instance.emitMessage(new s.ScanningFinished)}),this._logger.Debug("DeviceManager: Starting Device Manager"),"undefined"!=typeof window&&void 0!==window.navigator&&navigator.bluetooth?this.AddDeviceManager(new n.WebBluetoothDeviceManager):this._logger.Info("DeviceManager: Not adding WebBluetooth Manager, no capabilities found.")}}},function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function fulfilled(e){try{step(a.next(e))}catch(e){n(e)}}function rejected(e){try{step(a.throw(e))}catch(e){n(e)}}function step(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const s=r(25),n=r(1),i=r(91);t.WebBluetoothDeviceManager=class WebBluetoothDeviceManager extends n.EventEmitter{constructor(){super(...arguments),this.OpenDevice=(e=>a(this,void 0,void 0,function*(){if(void 0===e)return;const t=s.BluetoothDevices.GetDeviceInfo();let r=null;for(const a of t)if(a.Names.indexOf(e.name)>=0){r=a;break}if(null===r)return;const a=yield i.WebBluetoothDevice.CreateDevice(r,e);this.emit("deviceadded",a)}))}StartScanning(){return a(this,void 0,void 0,function*(){const e=s.BluetoothDevices.GetDeviceInfo(),t={filters:new Array,optionalServices:new Array};for(const r of e){for(const e of r.Names)t.filters.push({name:e});t.optionalServices=[...t.optionalServices,...r.Services]}let r;try{r=yield navigator.bluetooth.requestDevice(t)}catch(e){if(this.emit("scanningfinished"),-1!==e.message.indexOf("User cancelled"))return;throw new Error("Bluetooth scanning interrupted. Either user cancelled out of dialog, or bluetooth radio is not available. Exception: "+e)}try{yield this.OpenDevice(r)}catch(e){throw this.emit("scanningfinished"),new Error(`Cannot open device ${r.name}: ${e}`)}this.emit("scanningfinished")})}StopScanning(){}get IsScanning(){return!1}}},function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function fulfilled(e){try{step(a.next(e))}catch(e){n(e)}}function rejected(e){try{step(a.throw(e))}catch(e){n(e)}}function step(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const s=r(4),n=r(5),i=r(0);class FleshlightLaunch extends n.ButtplugBluetoothDevice{constructor(e){super("Fleshlight Launch",e),this._lastPosition=0,this.HandleStopDeviceCmd=(e=>a(this,void 0,void 0,function*(){return yield this.HandleFleshlightLaunchFW12Cmd(new i.FleshlightLaunchFW12Cmd(0,0,e.DeviceIndex,e.Id))})),this.HandleFleshlightLaunchFW12Cmd=(e=>a(this,void 0,void 0,function*(){return this._lastPosition=e.Position,yield this._deviceImpl.WriteValue("tx",new Uint8Array([e.Position,e.Speed])),new i.Ok(e.Id)})),this.HandleLinearCmd=(e=>a(this,void 0,void 0,function*(){if(1!==e.Vectors.length)return new i.Error("LinearCmd requires 1 vector for this device.",i.ErrorClass.ERROR_DEVICE,e.Id);const t=e.Vectors[0],r=100*t.Position,a=Math.abs(r-this._lastPosition);let s=Math.floor(25e3*Math.pow(90*t.Duration/a,-1.05));s=Math.min(Math.max(s,0),95);const n=Math.floor(r/99*90+4.5);return yield this.HandleFleshlightLaunchFW12Cmd(new i.FleshlightLaunchFW12Cmd(s,n,e.DeviceIndex,e.Id))})),this.MsgFuncs.set(i.StopDeviceCmd.name,this.HandleStopDeviceCmd),this.MsgFuncs.set(i.FleshlightLaunchFW12Cmd.name,this.HandleFleshlightLaunchFW12Cmd),this.MsgFuncs.set(i.LinearCmd.name,this.HandleLinearCmd)}static CreateInstance(e){return a(this,void 0,void 0,function*(){return yield e.WriteValue("cmd",new Uint8Array([0])),new FleshlightLaunch(e)})}get MessageSpecifications(){return{FleshlightLaunchFW12Cmd:{},StopDeviceCmd:{},LinearCmd:{FeatureCount:1}}}}FleshlightLaunch.DeviceInfo=new s.BluetoothDeviceInfo(["Launch"],["88f80580-0000-01e6-aace-0002a5d5c51b"],{cmd:"88f80583-0000-01e6-aace-0002a5d5c51b",tx:"88f80581-0000-01e6-aace-0002a5d5c51b"},FleshlightLaunch.CreateInstance),t.FleshlightLaunch=FleshlightLaunch},function(e,t,r){"use strict";(function(e){var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function fulfilled(e){try{step(a.next(e))}catch(e){n(e)}}function rejected(e){try{step(a.throw(e))}catch(e){n(e)}}function step(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const s=r(4),n=r(5),i=r(0);class Lovense extends n.ButtplugBluetoothDevice{constructor(t){super(`Lovense ${t.Name}`,t),this.HandleVibrateCmd=(e=>a(this,void 0,void 0,function*(){return 1!==e.Speeds.length?new i.Error("Lovense devices require VibrateCmd to have 1 speed command, "+`${e.Speeds.length} sent.`,i.ErrorClass.ERROR_DEVICE,e.Id):yield this.HandleSingleMotorVibrateCmd(new i.SingleMotorVibrateCmd(e.Speeds[0].Speed,e.DeviceIndex,e.Id))})),this.HandleStopDeviceCmd=(e=>a(this,void 0,void 0,function*(){return yield this.HandleSingleMotorVibrateCmd(new i.SingleMotorVibrateCmd(0,e.DeviceIndex,e.Id))})),this.HandleSingleMotorVibrateCmd=(t=>a(this,void 0,void 0,function*(){const r=Math.floor(20*t.Speed);return yield this._deviceImpl.WriteValue("tx",e.from("Vibrate:"+r+";")),new i.Ok(t.Id)})),this.MsgFuncs.set(i.StopDeviceCmd.name,this.HandleStopDeviceCmd),this.MsgFuncs.set(i.VibrateCmd.name,this.HandleVibrateCmd),this.MsgFuncs.set(i.SingleMotorVibrateCmd.name,this.HandleSingleMotorVibrateCmd)}static CreateInstance(e){return Promise.resolve(new Lovense(e))}get MessageSpecifications(){return{VibrateCmd:{FeatureCount:1},SingleMotorVibrateCmd:{},StopDeviceCmd:{}}}}Lovense._deviceNames={"LVS-A011":"Nora","LVS-C011":"Nora","LVS-B011":"Max","LVS-L009":"Ambi","LVS-S001":"Lush","LVS-S35":"Lush","LVS-Z36":"Hush","LVS-Z001":"Hush",LVS_Z001:"Hush","LVS-Domi37":"Domi","LVS-Domi38":"Domi","LVS-Domi39":"Domi","LVS-P36":"Edge","LVS-Edge37":"Edge"},t.Lovense=Lovense;class LovenseRev1{}LovenseRev1.DeviceInfo=new s.BluetoothDeviceInfo(["LVS-A011","LVS-C011","LVS-B011","LVS-L009"],["0000fff0-0000-1000-8000-00805f9b34fb"],{tx:"0000fff2-0000-1000-8000-00805f9b34fb"},Lovense.CreateInstance),t.LovenseRev1=LovenseRev1;class LovenseRev2{}LovenseRev2.DeviceInfo=new s.BluetoothDeviceInfo(["LVS-S001","LVS-Z001","LVS_Z001"],["6e400001-b5a3-f393-e0a9-e50e24dcca9e"],{tx:"6e400002-b5a3-f393-e0a9-e50e24dcca9e"},Lovense.CreateInstance),t.LovenseRev2=LovenseRev2;class LovenseRev3{}LovenseRev3.DeviceInfo=new s.BluetoothDeviceInfo(["LVS-P36"],["50300001-0024-4bd4-bbd5-a6920e4c5653"],{tx:"50300002-0024-4bd4-bbd5-a6920e4c5653"},Lovense.CreateInstance),t.LovenseRev3=LovenseRev3;class LovenseRev4{}LovenseRev4.DeviceInfo=new s.BluetoothDeviceInfo(["LVS-Domi37","LVS-Domi38","LVS-Domi39"],["57300001-0023-4bd4-bbd5-a6920e4c5653"],{tx:"57300002-0023-4bd4-bbd5-a6920e4c5653"},Lovense.CreateInstance),t.LovenseRev4=LovenseRev4;class LovenseRev5{}LovenseRev5.DeviceInfo=new s.BluetoothDeviceInfo(["LVS-Z36"],["5a300001-0024-4bd4-bbd5-a6920e4c5653"],{tx:"5a300002-0024-4bd4-bbd5-a6920e4c5653"},Lovense.CreateInstance),t.LovenseRev5=LovenseRev5;class LovenseRev6{}LovenseRev6.DeviceInfo=new s.BluetoothDeviceInfo(["LVS-Edge37"],["50300001-0023-4bd4-bbd5-a6920e4c5653"],{tx:"50300002-0023-4bd4-bbd5-a6920e4c5653"},Lovense.CreateInstance),t.LovenseRev6=LovenseRev6;class LovenseRev7{}LovenseRev7.DeviceInfo=new s.BluetoothDeviceInfo(["LVS-S35"],["53300001-0023-4bd4-bbd5-a6920e4c5653"],{tx:"53300002-0023-4bd4-bbd5-a6920e4c5653"},Lovense.CreateInstance),t.LovenseRev7=LovenseRev7}).call(t,r(85).Buffer)},function(e,t,r){"use strict";(function(e){var a=r(86),s=r(87),n=r(88);function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function createBuffer(e,t){if(kMaxLength()<t)throw new RangeError("Invalid typed array length");return Buffer.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=Buffer.prototype:(null===e&&(e=new Buffer(t)),e.length=t),e}function Buffer(e,t,r){if(!(Buffer.TYPED_ARRAY_SUPPORT||this instanceof Buffer))return new Buffer(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return allocUnsafe(this,e)}return from(this,e,t,r)}function from(e,t,r,a){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function fromArrayBuffer(e,t,r,a){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(a||0))throw new RangeError("'length' is out of bounds");t=void 0===r&&void 0===a?new Uint8Array(t):void 0===a?new Uint8Array(t,r):new Uint8Array(t,r,a);Buffer.TYPED_ARRAY_SUPPORT?(e=t).__proto__=Buffer.prototype:e=fromArrayLike(e,t);return e}(e,t,r,a):"string"==typeof t?function fromString(e,t,r){"string"==typeof r&&""!==r||(r="utf8");if(!Buffer.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var a=0|byteLength(t,r),s=(e=createBuffer(e,a)).write(t,r);s!==a&&(e=e.slice(0,s));return e}(e,t,r):function fromObject(e,t){if(Buffer.isBuffer(t)){var r=0|checked(t.length);return 0===(e=createBuffer(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function isnan(e){return e!=e}(t.length)?createBuffer(e,0):fromArrayLike(e,t);if("Buffer"===t.type&&n(t.data))return fromArrayLike(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function assertSize(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function allocUnsafe(e,t){if(assertSize(t),e=createBuffer(e,t<0?0:0|checked(t)),!Buffer.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function fromArrayLike(e,t){var r=t.length<0?0:0|checked(t.length);e=createBuffer(e,r);for(var a=0;a<r;a+=1)e[a]=255&t[a];return e}function checked(e){if(e>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|e}function byteLength(e,t){if(Buffer.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var a=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return utf8ToBytes(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return base64ToBytes(e).length;default:if(a)return utf8ToBytes(e).length;t=(""+t).toLowerCase(),a=!0}}function swap(e,t,r){var a=e[t];e[t]=e[r],e[r]=a}function bidirectionalIndexOf(e,t,r,a,s){if(0===e.length)return-1;if("string"==typeof r?(a=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=s?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(s)return-1;r=e.length-1}else if(r<0){if(!s)return-1;r=0}if("string"==typeof t&&(t=Buffer.from(t,a)),Buffer.isBuffer(t))return 0===t.length?-1:arrayIndexOf(e,t,r,a,s);if("number"==typeof t)return t&=255,Buffer.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?s?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):arrayIndexOf(e,[t],r,a,s);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(e,t,r,a,s){var n,i=1,o=e.length,c=t.length;if(void 0!==a&&("ucs2"===(a=String(a).toLowerCase())||"ucs-2"===a||"utf16le"===a||"utf-16le"===a)){if(e.length<2||t.length<2)return-1;i=2,o/=2,c/=2,r/=2}function read(e,t){return 1===i?e[t]:e.readUInt16BE(t*i)}if(s){var u=-1;for(n=r;n<o;n++)if(read(e,n)===read(t,-1===u?0:n-u)){if(-1===u&&(u=n),n-u+1===c)return u*i}else-1!==u&&(n-=n-u),u=-1}else for(r+c>o&&(r=o-c),n=r;n>=0;n--){for(var l=!0,h=0;h<c;h++)if(read(e,n+h)!==read(t,h)){l=!1;break}if(l)return n}return-1}function hexWrite(e,t,r,a){r=Number(r)||0;var s=e.length-r;a?(a=Number(a))>s&&(a=s):a=s;var n=t.length;if(n%2!=0)throw new TypeError("Invalid hex string");a>n/2&&(a=n/2);for(var i=0;i<a;++i){var o=parseInt(t.substr(2*i,2),16);if(isNaN(o))return i;e[r+i]=o}return i}function asciiWrite(e,t,r,a){return blitBuffer(function asciiToBytes(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,a)}function base64Slice(e,t,r){return 0===t&&r===e.length?a.fromByteArray(e):a.fromByteArray(e.slice(t,r))}function utf8Slice(e,t,r){r=Math.min(e.length,r);for(var a=[],s=t;s<r;){var n,o,c,u,l=e[s],h=null,d=l>239?4:l>223?3:l>191?2:1;if(s+d<=r)switch(d){case 1:l<128&&(h=l);break;case 2:128==(192&(n=e[s+1]))&&(u=(31&l)<<6|63&n)>127&&(h=u);break;case 3:n=e[s+1],o=e[s+2],128==(192&n)&&128==(192&o)&&(u=(15&l)<<12|(63&n)<<6|63&o)>2047&&(u<55296||u>57343)&&(h=u);break;case 4:n=e[s+1],o=e[s+2],c=e[s+3],128==(192&n)&&128==(192&o)&&128==(192&c)&&(u=(15&l)<<18|(63&n)<<12|(63&o)<<6|63&c)>65535&&u<1114112&&(h=u)}null===h?(h=65533,d=1):h>65535&&(h-=65536,a.push(h>>>10&1023|55296),h=56320|1023&h),a.push(h),s+=d}return function decodeCodePointsArray(e){var t=e.length;if(t<=i)return String.fromCharCode.apply(String,e);var r="",a=0;for(;a<t;)r+=String.fromCharCode.apply(String,e.slice(a,a+=i));return r}(a)}t.Buffer=Buffer,t.SlowBuffer=function SlowBuffer(e){+e!=e&&(e=0);return Buffer.alloc(+e)},t.INSPECT_MAX_BYTES=50,Buffer.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function typedArraySupport(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=kMaxLength(),Buffer.poolSize=8192,Buffer._augment=function(e){return e.__proto__=Buffer.prototype,e},Buffer.from=function(e,t,r){return from(null,e,t,r)},Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0})),Buffer.alloc=function(e,t,r){return function alloc(e,t,r,a){return assertSize(t),t<=0?createBuffer(e,t):void 0!==r?"string"==typeof a?createBuffer(e,t).fill(r,a):createBuffer(e,t).fill(r):createBuffer(e,t)}(null,e,t,r)},Buffer.allocUnsafe=function(e){return allocUnsafe(null,e)},Buffer.allocUnsafeSlow=function(e){return allocUnsafe(null,e)},Buffer.isBuffer=function isBuffer(e){return!(null==e||!e._isBuffer)},Buffer.compare=function compare(e,t){if(!Buffer.isBuffer(e)||!Buffer.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,a=t.length,s=0,n=Math.min(r,a);s<n;++s)if(e[s]!==t[s]){r=e[s],a=t[s];break}return r<a?-1:a<r?1:0},Buffer.isEncoding=function isEncoding(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function concat(e,t){if(!n(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Buffer.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var a=Buffer.allocUnsafe(t),s=0;for(r=0;r<e.length;++r){var i=e[r];if(!Buffer.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(a,s),s+=i.length}return a},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function swap16(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)swap(this,t,t+1);return this},Buffer.prototype.swap32=function swap32(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)swap(this,t,t+3),swap(this,t+1,t+2);return this},Buffer.prototype.swap64=function swap64(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)swap(this,t,t+7),swap(this,t+1,t+6),swap(this,t+2,t+5),swap(this,t+3,t+4);return this},Buffer.prototype.toString=function toString(){var e=0|this.length;return 0===e?"":0===arguments.length?utf8Slice(this,0,e):function slowToString(e,t,r){var a=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return hexSlice(this,t,r);case"utf8":case"utf-8":return utf8Slice(this,t,r);case"ascii":return asciiSlice(this,t,r);case"latin1":case"binary":return latin1Slice(this,t,r);case"base64":return base64Slice(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,t,r);default:if(a)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),a=!0}}.apply(this,arguments)},Buffer.prototype.equals=function equals(e){if(!Buffer.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Buffer.compare(this,e)},Buffer.prototype.inspect=function inspect(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},Buffer.prototype.compare=function compare(e,t,r,a,s){if(!Buffer.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===a&&(a=0),void 0===s&&(s=this.length),t<0||r>e.length||a<0||s>this.length)throw new RangeError("out of range index");if(a>=s&&t>=r)return 0;if(a>=s)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,a>>>=0,s>>>=0,this===e)return 0;for(var n=s-a,i=r-t,o=Math.min(n,i),c=this.slice(a,s),u=e.slice(t,r),l=0;l<o;++l)if(c[l]!==u[l]){n=c[l],i=u[l];break}return n<i?-1:i<n?1:0},Buffer.prototype.includes=function includes(e,t,r){return-1!==this.indexOf(e,t,r)},Buffer.prototype.indexOf=function indexOf(e,t,r){return bidirectionalIndexOf(this,e,t,r,!0)},Buffer.prototype.lastIndexOf=function lastIndexOf(e,t,r){return bidirectionalIndexOf(this,e,t,r,!1)},Buffer.prototype.write=function write(e,t,r,a){if(void 0===t)a="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)a=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===a&&(a="utf8")):(a=r,r=void 0)}var s=this.length-t;if((void 0===r||r>s)&&(r=s),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");a||(a="utf8");for(var n,i,o,c,u,l,h,d,f,p=!1;;)switch(a){case"hex":return hexWrite(this,e,t,r);case"utf8":case"utf-8":return d=t,f=r,blitBuffer(utf8ToBytes(e,(h=this).length-d),h,d,f);case"ascii":return asciiWrite(this,e,t,r);case"latin1":case"binary":return asciiWrite(this,e,t,r);case"base64":return c=this,u=t,l=r,blitBuffer(base64ToBytes(e),c,u,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i=t,o=r,blitBuffer(function utf16leToBytes(e,t){for(var r,a,s,n=[],i=0;i<e.length&&!((t-=2)<0);++i)r=e.charCodeAt(i),a=r>>8,s=r%256,n.push(s),n.push(a);return n}(e,(n=this).length-i),n,i,o);default:if(p)throw new TypeError("Unknown encoding: "+a);a=(""+a).toLowerCase(),p=!0}},Buffer.prototype.toJSON=function toJSON(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var i=4096;function asciiSlice(e,t,r){var a="";r=Math.min(e.length,r);for(var s=t;s<r;++s)a+=String.fromCharCode(127&e[s]);return a}function latin1Slice(e,t,r){var a="";r=Math.min(e.length,r);for(var s=t;s<r;++s)a+=String.fromCharCode(e[s]);return a}function hexSlice(e,t,r){var a=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>a)&&(r=a);for(var s="",n=t;n<r;++n)s+=toHex(e[n]);return s}function utf16leSlice(e,t,r){for(var a=e.slice(t,r),s="",n=0;n<a.length;n+=2)s+=String.fromCharCode(a[n]+256*a[n+1]);return s}function checkOffset(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function checkInt(e,t,r,a,s,n){if(!Buffer.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<n)throw new RangeError('"value" argument is out of bounds');if(r+a>e.length)throw new RangeError("Index out of range")}function objectWriteUInt16(e,t,r,a){t<0&&(t=65535+t+1);for(var s=0,n=Math.min(e.length-r,2);s<n;++s)e[r+s]=(t&255<<8*(a?s:1-s))>>>8*(a?s:1-s)}function objectWriteUInt32(e,t,r,a){t<0&&(t=4294967295+t+1);for(var s=0,n=Math.min(e.length-r,4);s<n;++s)e[r+s]=t>>>8*(a?s:3-s)&255}function checkIEEE754(e,t,r,a,s,n){if(r+a>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function writeFloat(e,t,r,a,n){return n||checkIEEE754(e,0,r,4),s.write(e,t,r,a,23,4),r+4}function writeDouble(e,t,r,a,n){return n||checkIEEE754(e,0,r,8),s.write(e,t,r,a,52,8),r+8}Buffer.prototype.slice=function slice(e,t){var r,a=this.length;if(e=~~e,t=void 0===t?a:~~t,e<0?(e+=a)<0&&(e=0):e>a&&(e=a),t<0?(t+=a)<0&&(t=0):t>a&&(t=a),t<e&&(t=e),Buffer.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=Buffer.prototype;else{var s=t-e;r=new Buffer(s,void 0);for(var n=0;n<s;++n)r[n]=this[n+e]}return r},Buffer.prototype.readUIntLE=function readUIntLE(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var a=this[e],s=1,n=0;++n<t&&(s*=256);)a+=this[e+n]*s;return a},Buffer.prototype.readUIntBE=function readUIntBE(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var a=this[e+--t],s=1;t>0&&(s*=256);)a+=this[e+--t]*s;return a},Buffer.prototype.readUInt8=function readUInt8(e,t){return t||checkOffset(e,1,this.length),this[e]},Buffer.prototype.readUInt16LE=function readUInt16LE(e,t){return t||checkOffset(e,2,this.length),this[e]|this[e+1]<<8},Buffer.prototype.readUInt16BE=function readUInt16BE(e,t){return t||checkOffset(e,2,this.length),this[e]<<8|this[e+1]},Buffer.prototype.readUInt32LE=function readUInt32LE(e,t){return t||checkOffset(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Buffer.prototype.readUInt32BE=function readUInt32BE(e,t){return t||checkOffset(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Buffer.prototype.readIntLE=function readIntLE(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var a=this[e],s=1,n=0;++n<t&&(s*=256);)a+=this[e+n]*s;return a>=(s*=128)&&(a-=Math.pow(2,8*t)),a},Buffer.prototype.readIntBE=function readIntBE(e,t,r){e|=0,t|=0,r||checkOffset(e,t,this.length);for(var a=t,s=1,n=this[e+--a];a>0&&(s*=256);)n+=this[e+--a]*s;return n>=(s*=128)&&(n-=Math.pow(2,8*t)),n},Buffer.prototype.readInt8=function readInt8(e,t){return t||checkOffset(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Buffer.prototype.readInt16LE=function readInt16LE(e,t){t||checkOffset(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt16BE=function readInt16BE(e,t){t||checkOffset(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},Buffer.prototype.readInt32LE=function readInt32LE(e,t){return t||checkOffset(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Buffer.prototype.readInt32BE=function readInt32BE(e,t){return t||checkOffset(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Buffer.prototype.readFloatLE=function readFloatLE(e,t){return t||checkOffset(e,4,this.length),s.read(this,e,!0,23,4)},Buffer.prototype.readFloatBE=function readFloatBE(e,t){return t||checkOffset(e,4,this.length),s.read(this,e,!1,23,4)},Buffer.prototype.readDoubleLE=function readDoubleLE(e,t){return t||checkOffset(e,8,this.length),s.read(this,e,!0,52,8)},Buffer.prototype.readDoubleBE=function readDoubleBE(e,t){return t||checkOffset(e,8,this.length),s.read(this,e,!1,52,8)},Buffer.prototype.writeUIntLE=function writeUIntLE(e,t,r,a){(e=+e,t|=0,r|=0,a)||checkInt(this,e,t,r,Math.pow(2,8*r)-1,0);var s=1,n=0;for(this[t]=255&e;++n<r&&(s*=256);)this[t+n]=e/s&255;return t+r},Buffer.prototype.writeUIntBE=function writeUIntBE(e,t,r,a){(e=+e,t|=0,r|=0,a)||checkInt(this,e,t,r,Math.pow(2,8*r)-1,0);var s=r-1,n=1;for(this[t+s]=255&e;--s>=0&&(n*=256);)this[t+s]=e/n&255;return t+r},Buffer.prototype.writeUInt8=function writeUInt8(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Buffer.prototype.writeUInt16LE=function writeUInt16LE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):objectWriteUInt16(this,e,t,!0),t+2},Buffer.prototype.writeUInt16BE=function writeUInt16BE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):objectWriteUInt16(this,e,t,!1),t+2},Buffer.prototype.writeUInt32LE=function writeUInt32LE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):objectWriteUInt32(this,e,t,!0),t+4},Buffer.prototype.writeUInt32BE=function writeUInt32BE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):objectWriteUInt32(this,e,t,!1),t+4},Buffer.prototype.writeIntLE=function writeIntLE(e,t,r,a){if(e=+e,t|=0,!a){var s=Math.pow(2,8*r-1);checkInt(this,e,t,r,s-1,-s)}var n=0,i=1,o=0;for(this[t]=255&e;++n<r&&(i*=256);)e<0&&0===o&&0!==this[t+n-1]&&(o=1),this[t+n]=(e/i>>0)-o&255;return t+r},Buffer.prototype.writeIntBE=function writeIntBE(e,t,r,a){if(e=+e,t|=0,!a){var s=Math.pow(2,8*r-1);checkInt(this,e,t,r,s-1,-s)}var n=r-1,i=1,o=0;for(this[t+n]=255&e;--n>=0&&(i*=256);)e<0&&0===o&&0!==this[t+n+1]&&(o=1),this[t+n]=(e/i>>0)-o&255;return t+r},Buffer.prototype.writeInt8=function writeInt8(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Buffer.prototype.writeInt16LE=function writeInt16LE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):objectWriteUInt16(this,e,t,!0),t+2},Buffer.prototype.writeInt16BE=function writeInt16BE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):objectWriteUInt16(this,e,t,!1),t+2},Buffer.prototype.writeInt32LE=function writeInt32LE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):objectWriteUInt32(this,e,t,!0),t+4},Buffer.prototype.writeInt32BE=function writeInt32BE(e,t,r){return e=+e,t|=0,r||checkInt(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Buffer.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):objectWriteUInt32(this,e,t,!1),t+4},Buffer.prototype.writeFloatLE=function writeFloatLE(e,t,r){return writeFloat(this,e,t,!0,r)},Buffer.prototype.writeFloatBE=function writeFloatBE(e,t,r){return writeFloat(this,e,t,!1,r)},Buffer.prototype.writeDoubleLE=function writeDoubleLE(e,t,r){return writeDouble(this,e,t,!0,r)},Buffer.prototype.writeDoubleBE=function writeDoubleBE(e,t,r){return writeDouble(this,e,t,!1,r)},Buffer.prototype.copy=function copy(e,t,r,a){if(r||(r=0),a||0===a||(a=this.length),t>=e.length&&(t=e.length),t||(t=0),a>0&&a<r&&(a=r),a===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(a<0)throw new RangeError("sourceEnd out of bounds");a>this.length&&(a=this.length),e.length-t<a-r&&(a=e.length-t+r);var s,n=a-r;if(this===e&&r<t&&t<a)for(s=n-1;s>=0;--s)e[s+t]=this[s+r];else if(n<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(s=0;s<n;++s)e[s+t]=this[s+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+n),t);return n},Buffer.prototype.fill=function fill(e,t,r,a){if("string"==typeof e){if("string"==typeof t?(a=t,t=0,r=this.length):"string"==typeof r&&(a=r,r=this.length),1===e.length){var s=e.charCodeAt(0);s<256&&(e=s)}if(void 0!==a&&"string"!=typeof a)throw new TypeError("encoding must be a string");if("string"==typeof a&&!Buffer.isEncoding(a))throw new TypeError("Unknown encoding: "+a)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var n;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(n=t;n<r;++n)this[n]=e;else{var i=Buffer.isBuffer(e)?e:utf8ToBytes(new Buffer(e,a).toString()),o=i.length;for(n=0;n<r-t;++n)this[n+t]=i[n%o]}return this};var o=/[^+\/0-9A-Za-z-_]/g;function toHex(e){return e<16?"0"+e.toString(16):e.toString(16)}function utf8ToBytes(e,t){var r;t=t||1/0;for(var a=e.length,s=null,n=[],i=0;i<a;++i){if((r=e.charCodeAt(i))>55295&&r<57344){if(!s){if(r>56319){(t-=3)>-1&&n.push(239,191,189);continue}if(i+1===a){(t-=3)>-1&&n.push(239,191,189);continue}s=r;continue}if(r<56320){(t-=3)>-1&&n.push(239,191,189),s=r;continue}r=65536+(s-55296<<10|r-56320)}else s&&(t-=3)>-1&&n.push(239,191,189);if(s=null,r<128){if((t-=1)<0)break;n.push(r)}else if(r<2048){if((t-=2)<0)break;n.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;n.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;n.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return n}function base64ToBytes(e){return a.toByteArray(function base64clean(e){if((e=function stringtrim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(o,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function blitBuffer(e,t,r,a){for(var s=0;s<a&&!(s+r>=t.length||s>=e.length);++s)t[s+r]=e[s];return s}}).call(t,r(8))},function(e,t,r){"use strict";t.byteLength=function byteLength(e){return 3*e.length/4-placeHoldersCount(e)},t.toByteArray=function toByteArray(e){var t,r,a,i,o,c=e.length;i=placeHoldersCount(e),o=new n(3*c/4-i),r=i>0?c-4:c;var u=0;for(t=0;t<r;t+=4)a=s[e.charCodeAt(t)]<<18|s[e.charCodeAt(t+1)]<<12|s[e.charCodeAt(t+2)]<<6|s[e.charCodeAt(t+3)],o[u++]=a>>16&255,o[u++]=a>>8&255,o[u++]=255&a;2===i?(a=s[e.charCodeAt(t)]<<2|s[e.charCodeAt(t+1)]>>4,o[u++]=255&a):1===i&&(a=s[e.charCodeAt(t)]<<10|s[e.charCodeAt(t+1)]<<4|s[e.charCodeAt(t+2)]>>2,o[u++]=a>>8&255,o[u++]=255&a);return o},t.fromByteArray=function fromByteArray(e){for(var t,r=e.length,s=r%3,n="",i=[],o=0,c=r-s;o<c;o+=16383)i.push(encodeChunk(e,o,o+16383>c?c:o+16383));1===s?(t=e[r-1],n+=a[t>>2],n+=a[t<<4&63],n+="=="):2===s&&(t=(e[r-2]<<8)+e[r-1],n+=a[t>>10],n+=a[t>>4&63],n+=a[t<<2&63],n+="=");return i.push(n),i.join("")};for(var a=[],s=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,c=i.length;o<c;++o)a[o]=i[o],s[i.charCodeAt(o)]=o;function placeHoldersCount(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function encodeChunk(e,t,r){for(var s,n,i=[],o=t;o<r;o+=3)s=(e[o]<<16)+(e[o+1]<<8)+e[o+2],i.push(a[(n=s)>>18&63]+a[n>>12&63]+a[n>>6&63]+a[63&n]);return i.join("")}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,r,a,s){var n,i,o=8*s-a-1,c=(1<<o)-1,u=c>>1,l=-7,h=r?s-1:0,d=r?-1:1,f=e[t+h];for(h+=d,n=f&(1<<-l)-1,f>>=-l,l+=o;l>0;n=256*n+e[t+h],h+=d,l-=8);for(i=n&(1<<-l)-1,n>>=-l,l+=a;l>0;i=256*i+e[t+h],h+=d,l-=8);if(0===n)n=1-u;else{if(n===c)return i?NaN:1/0*(f?-1:1);i+=Math.pow(2,a),n-=u}return(f?-1:1)*i*Math.pow(2,n-a)},t.write=function(e,t,r,a,s,n){var i,o,c,u=8*n-s-1,l=(1<<u)-1,h=l>>1,d=23===s?Math.pow(2,-24)-Math.pow(2,-77):0,f=a?0:n-1,p=a?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,i=l):(i=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-i))<1&&(i--,c*=2),(t+=i+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(i++,c/=2),i+h>=l?(o=0,i=l):i+h>=1?(o=(t*c-1)*Math.pow(2,s),i+=h):(o=t*Math.pow(2,h-1)*Math.pow(2,s),i=0));s>=8;e[r+f]=255&o,f+=p,o/=256,s-=8);for(i=i<<s|o,u+=s;u>0;e[r+f]=255&i,f+=p,i/=256,u-=8);e[r+f-p]|=128*m}},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function fulfilled(e){try{step(a.next(e))}catch(e){n(e)}}function rejected(e){try{step(a.throw(e))}catch(e){n(e)}}function step(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const s=r(4),n=r(5),i=r(0);class VorzeA10Cyclone extends n.ButtplugBluetoothDevice{constructor(e){super("Vorze A10 Cyclone",e),this.HandleRotateCmd=(e=>a(this,void 0,void 0,function*(){return 1!==e.Rotations.length?new i.Error("Vorze A10 Cyclone devices require RotateCmd to have 1 rotation command,"+` ${e.Rotations.length} sent.`,i.ErrorClass.ERROR_DEVICE,e.Id):yield this.HandleVorzeA10CycloneCmd(new i.VorzeA10CycloneCmd(100*e.Rotations[0].Speed,e.Rotations[0].Clockwise,e.DeviceIndex,e.Id))})),this.HandleStopDeviceCmd=(e=>a(this,void 0,void 0,function*(){return yield this.HandleVorzeA10CycloneCmd(new i.VorzeA10CycloneCmd(0,!1,e.DeviceIndex,e.Id))})),this.HandleVorzeA10CycloneCmd=(e=>a(this,void 0,void 0,function*(){const t=255&((e.Clockwise?1:0)<<7|e.Speed);return yield this._deviceImpl.WriteValue("tx",new Uint8Array([1,1,t])),new i.Ok(e.Id)})),this.MsgFuncs.set(i.StopDeviceCmd.name,this.HandleStopDeviceCmd),this.MsgFuncs.set(i.VorzeA10CycloneCmd.name,this.HandleVorzeA10CycloneCmd),this.MsgFuncs.set(i.RotateCmd.name,this.HandleRotateCmd)}static CreateInstance(e){return a(this,void 0,void 0,function*(){return e.WriteValue("cmd",new Uint8Array([0])),new VorzeA10Cyclone(e)})}get MessageSpecifications(){return{RotateCmd:{FeatureCount:1},VorzeA10CycloneCmd:{},StopDeviceCmd:{}}}}VorzeA10Cyclone.DeviceInfo=new s.BluetoothDeviceInfo(["CycSA"],["40ee1111-63ec-4b7f-8ce7-712efd55b90e"],{tx:"40ee2222-63ec-4b7f-8ce7-712efd55b90e"},VorzeA10Cyclone.CreateInstance),t.VorzeA10Cyclone=VorzeA10Cyclone},function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function fulfilled(e){try{step(a.next(e))}catch(e){n(e)}}function rejected(e){try{step(a.throw(e))}catch(e){n(e)}}function step(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const s=r(4),n=r(5),i=r(0);class WeVibe extends n.ButtplugBluetoothDevice{constructor(e){super(`WeVibe ${e.Name}`,e),this.HandleVibrateCmd=(e=>a(this,void 0,void 0,function*(){return 1!==e.Speeds.length?new i.Error("WeVibe devices require VibrateCmd to have 1 speed command, "+`${e.Speeds.length} sent.`,i.ErrorClass.ERROR_DEVICE,e.Id):yield this.HandleSingleMotorVibrateCmd(new i.SingleMotorVibrateCmd(e.Speeds[0].Speed,e.DeviceIndex,e.Id))})),this.HandleStopDeviceCmd=(e=>a(this,void 0,void 0,function*(){return yield this.HandleSingleMotorVibrateCmd(new i.SingleMotorVibrateCmd(0,e.DeviceIndex,e.Id))})),this.HandleSingleMotorVibrateCmd=(e=>a(this,void 0,void 0,function*(){const t=Math.floor(15*e.Speed),r=new Uint8Array([15,3,0,t<<4|t,0,3,0,0]);return yield this._deviceImpl.WriteValue("tx",r),new i.Ok(e.Id)})),this.MsgFuncs.set(i.StopDeviceCmd.name,this.HandleStopDeviceCmd),this.MsgFuncs.set(i.SingleMotorVibrateCmd.name,this.HandleSingleMotorVibrateCmd),this.MsgFuncs.set(i.VibrateCmd.name,this.HandleVibrateCmd)}static CreateInstance(e){return a(this,void 0,void 0,function*(){return new WeVibe(e)})}get MessageSpecifications(){return{VibrateCmd:{FeatureCount:1},SingleMotorVibrateCmd:{},StopDeviceCmd:{}}}}WeVibe.DeviceInfo=new s.BluetoothDeviceInfo(["4 Plus","Ditto","Nova","Wish","Pivot","Verge","Cougar"],["f000bb03-0451-4000-b000-000000000000"],{tx:"f000c000-0451-4000-b000-000000000000",rx:"f000b000-0451-4000-b000-000000000000"},WeVibe.CreateInstance),t.WeVibe=WeVibe},function(e,t,r){"use strict";var a=this&&this.__awaiter||function(e,t,r,a){return new(r||(r=Promise))(function(s,n){function fulfilled(e){try{step(a.next(e))}catch(e){n(e)}}function rejected(e){try{step(a.throw(e))}catch(e){n(e)}}function step(e){e.done?s(e.value):new r(function(t){t(e.value)}).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0});const s=r(3),n=r(1);class WebBluetoothDevice extends n.EventEmitter{constructor(e,t){super(),this._deviceInfo=e,this._device=t,this._logger=s.ButtplugLogger.Logger,this._characteristics=new Map,this.Connect=(()=>a(this,void 0,void 0,function*(){this._logger.Debug(`WebBluetoothDevice: ${this.constructor.name} connecting`),this._device.addEventListener("gattserverdisconnected",this.OnDisconnect),this._server=yield this._device.gatt.connect(),this._service=yield this._server.getPrimaryService(this._deviceInfo.Services[0]);for(const e of Object.getOwnPropertyNames(this._deviceInfo.Characteristics))this._characteristics.set(e,yield this._service.getCharacteristic(this._deviceInfo.Characteristics[e]))})),this.OnDisconnect=(()=>{this._logger.Debug(`WebBluetoothDevice: ${this.constructor.name} disconnecting`),this._device.removeEventListener("gattserverdisconnected",this.OnDisconnect),this.emit("deviceremoved")}),this.WriteValue=((e,t)=>a(this,void 0,void 0,function*(){if(!this._characteristics.has(e))return;const r=this._characteristics.get(e);this._logger.Trace(`WebBluetoothDevice: ${this.constructor.name} writing ${t} to ${r.uuid}`),yield r.writeValue(t)})),this.ReadValue=(e=>a(this,void 0,void 0,function*(){if(!this._characteristics.has(e))throw new Error("Tried to access wrong characteristic!");const t=this._characteristics.get(e);return this._logger.Trace(`WebBluetoothDevice: ${this.constructor.name} reading from ${t.uuid}`),yield t.readValue()}))}static CreateDevice(e,t){return a(this,void 0,void 0,function*(){const r=new WebBluetoothDevice(e,t);yield r.Connect();const a=yield e.Create(r);return r.addListener("deviceremoved",()=>{a.OnDisconnect()}),s.ButtplugLogger.Logger.Debug(`WebBluetoothDevice: Creating ${a.constructor.name}`),a})}get Name(){return this._device.name}}t.WebBluetoothDevice=WebBluetoothDevice},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}])});
//# sourceMappingURL=buttplug.min.js.map